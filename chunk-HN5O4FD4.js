import{a as ue,b as je,c as Ne}from"./chunk-5YL7W5KK.js";import{a as T}from"./chunk-OWTQV74W.js";import{$a as Le,A as x,Aa as z,B as S,C as I,D as R,G as f,Ga as U,H as ae,Ha as ee,K as oe,L as xe,N as c,Oa as N,Q as v,Qa as Fe,Ra as Se,Sa as b,V as Oe,Va as de,Za as W,_ as D,aa as $,ba as se,bb as j,ca as Te,da as k,ea as F,fa as y,g as h,ga as a,gb as Ee,ha as s,i as Pe,ia as C,j as we,ja as A,jb as me,ka as Q,la as Z,lb as X,m as Me,ma as M,mb as ge,na as Ie,oa as m,qa as d,qb as O,r as g,ra as ce,sa as le,sb as De,t as p,ta as pe,tb as $e,w,wa as L,ya as u,z as l,za as ke}from"./chunk-AM62OYZP.js";var Re=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["app-logo"]],decls:5,vars:0,consts:[["id","logo"],["routerLink","/",1,"text-lg","md:text-2xl","font-bold"],[1,"text-amber-500"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"a",1),u(2," Gluten "),a(3,"span",2),u(4," Free"),s()()())},dependencies:[ge],styles:["[_nghost-%COMP%]{display:block}"]})};var K=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["x-circle"]],decls:3,vars:0,consts:[["role","button","tabindex","0","aria-label","Cerrar",1,"x-circle-btn","cursor-pointer","inline-flex","items-center","justify-center","p-2","rounded-full","transition-colors","duration-200","hover:bg-base-200","text-base-content"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"]],template:function(t,i){t&1&&(A(0,"div",0),I(),A(1,"svg",1),Z(2,"path",2),Q()())},styles:["[_nghost-%COMP%]{display:inline-flex}"]})};var te=`${O.baseUrl}/categories`,Ze={id:"new",name:""},he=class n{http=l(j);toastService=l(T);categoriesCache=new Map;getAll(){return this.categoriesCache.size?h(Array.from(this.categoriesCache.values())):this.http.get(te).pipe(p(e=>e.forEach(t=>this.categoriesCache.set(t.id,t))))}getById(e){return e==="new"?h(Ze):this.categoriesCache.has(e)?h(this.categoriesCache.get(e)):this.http.get(`${te}/${e}`).pipe(p(t=>this.categoriesCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(te,e).pipe(p(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${te}/${e}`,t).pipe(p(i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${te}/${e}`).pipe(p(()=>{this.categoriesCache.delete(e),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.categoriesCache.set(e.id,e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=w({token:n,factory:n.\u0275fac,providedIn:"root"})};var ie=`${O.baseUrl}/tags`,We={id:"new",name:""},fe=class n{http=l(j);toastService=l(T);tagsCache=new Map;getAll(e){let t=e??"all";return this.tagsCache.has(t)?h(this.tagsCache.get(t)):this.http.get(ie,{params:e?{categoryId:e}:void 0,responseType:"json"}).pipe(p(i=>this.tagsCache.set(t,i)))}getById(e){return e==="new"?h(We):this.http.get(`${ie}/${e}`).pipe(p(t=>{this.tagsCache.clear(),this.tagsCache.set(t.id,[t])}))}create(e){return this.toastService.activateLoading(),this.http.post(ie,e).pipe(p(t=>{this.tagsCache.clear(),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${ie}/${e}`,t).pipe(p(i=>{this.tagsCache.clear(),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${ie}/${e}`).pipe(p(()=>{this.tagsCache.clear(),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=w({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ve=(n,e)=>e.id;function Ke(n,e){if(n&1){let t=M();a(0,"li")(1,"button",4),m("click",function(){let r=x(t).$implicit,o=d();return S(o.selectCategory(r.id))}),u(2),s()()}if(n&2){let t=e.$implicit,i=d();c(),L("bg-base-200",i.pendingCategory()===t.id)("font-semibold",i.pendingCategory()===t.id),c(),z(" ",t.name," ")}}function Ye(n,e){if(n&1){let t=M();a(0,"button",10),m("click",function(){let r=x(t).$implicit,o=d();return S(o.toggleTag(r.id))}),u(1),s()}if(n&2){let t=e.$implicit,i=d();y("ngClass",i.pendingTags().has(t.id)?"btn-outline border-base-200 bg-base-200 text-base-content font-semibold":"btn-outline border-base-200 text-base-content"),c(),z(" ",t.name," ")}}var be=class n{categoryService=l(he);tagService=l(fe);route=l(me);router=l(X);configurationService=l(ue);categories=f([]);tags=f([]);selectedCategory=f("all");pendingCategory=f("all");selectedTags=f(new Set);pendingTags=f(new Set);hasPendingChanges=N(()=>{if(this.selectedCategory()!==this.pendingCategory())return!0;let e=this.selectedTags(),t=this.pendingTags();if(e.size!==t.size)return!0;for(let i of t)if(!e.has(i))return!0;return!1});ngOnInit(){this.categoryService.getAll().subscribe(e=>this.categories.set(e)),this.route.queryParamMap.subscribe(e=>{let t=e.get("categoryId")??"all",i=e.get("tagIds")??"",r=i?i.split(",").filter(Boolean):[];this.selectedCategory.set(t),this.pendingCategory.set(t);let o=new Set(r);this.selectedTags.set(o),this.pendingTags.set(new Set(o)),this.loadTags(t==="all"?void 0:t)})}selectCategory(e){let t=this.pendingCategory()===e?"all":e;if(this.pendingCategory.set(t),this.pendingTags.set(new Set),t==="all"){this.selectedCategory.set("all"),this.selectedTags.set(new Set),this.updateQueryParams(!0),this.loadTags(void 0);return}this.loadTags(t==="all"?void 0:t)}toggleTag(e){let t=new Set(this.pendingTags());t.has(e)?t.delete(e):t.add(e),this.pendingTags.set(t)}resetTags(){!this.selectedTags().size&&!this.pendingTags().size||(this.selectedTags.set(new Set),this.pendingTags.set(new Set),this.updateQueryParams())}applyFilters(){this.selectedCategory.set(this.pendingCategory()),this.selectedTags.set(new Set(this.pendingTags())),this.updateQueryParams(!0)}loadTags(e){this.tagService.getAll(e).subscribe(t=>this.tags.set(t))}updateQueryParams(e=!1){let t=Array.from(this.selectedTags());this.router.navigate(["/products"],{queryParams:{categoryId:this.selectedCategory()==="all"?null:this.selectedCategory(),tagIds:t.length?t.join(","):null},queryParamsHandling:"merge"}).then(()=>{e&&(this.configurationService.toggleSidebarItemsStatus("closed"),this.configurationService.toggleSidebarPageStatus("closed"))})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["mobile-product-filters"]],decls:21,vars:6,consts:[[1,"mobile-filters","space-y-4","border-t","border-base-300","px-3","pt-3","pb-2"],[1,"flex","items-center","justify-between"],[1,"font-semibold","text-base-content"],[1,"flex","flex-col","gap-2"],["type","button",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content",3,"click"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"filter-tag","btn","btn-sm","rounded-md","min-h-9","px-4",3,"ngClass"],[1,"flex","gap-2"],["type","button",1,"btn","btn-sm","btn-outline","flex-1",3,"click","disabled"],["type","button",1,"btn","btn-sm","btn-primary","flex-1",3,"click","disabled"],["type","button",1,"filter-tag","btn","btn-sm","rounded-md","min-h-9","px-4",3,"click","ngClass"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1)(2,"h4",2),u(3,"Categorias"),s()(),a(4,"ul",3)(5,"li")(6,"button",4),m("click",function(){return i.selectCategory("all")}),u(7," Todos "),s()(),k(8,Ke,3,5,"li",null,Ve),s(),a(10,"div",1)(11,"h4",2),u(12,"Tags"),s()(),a(13,"div",5),k(14,Ye,2,2,"button",6,Ve),s(),a(16,"div",7)(17,"button",8),m("click",function(){return i.resetTags()}),u(18," Limpiar "),s(),a(19,"button",9),m("click",function(){return i.applyFilters()}),u(20," Aplicar "),s()()()),t&2&&(c(6),L("bg-base-200",i.pendingCategory()==="all")("font-semibold",i.pendingCategory()==="all"),c(2),F(i.categories()),c(6),F(i.tags()),c(3),y("disabled",!i.pendingTags().size&&!i.selectedTags().size),c(2),y("disabled",!i.hasPendingChanges()))},dependencies:[W,de],styles:["[_nghost-%COMP%]{display:block}"]})};function Je(n,e){if(n&1){let t=M();a(0,"button",7),m("click",function(){x(t);let r=d(3);return S(r.handleProductClick())}),a(1,"span"),u(2,"Productos"),s(),I(),a(3,"svg",8),C(4,"path",9),s()(),R(),a(5,"div",10)(6,"div",11),C(7,"mobile-product-filters",12),s()()}if(n&2){let t=d(3);c(3),L("rotate-90",t.showProductFilters()),c(2),L("open",t.showProductFilters())}}function et(n,e){if(n&1){let t=M();a(0,"a",13),m("click",function(){x(t);let r=d(2).$implicit,o=d();return S(o.handleMenuClick(r))}),u(1),s()}if(n&2){let t=d(2).$implicit;c(),z(" ",t.label," ")}}function tt(n,e){if(n&1&&D(0,Je,8,4)(1,et,2,1,"a",6),n&2){let t=d().$implicit;$(t.routerLink==="/products"?0:1)}}function it(n,e){if(n&1&&D(0,tt,2,1),n&2){let t=e.$implicit,i=d();$(!t.adminOnly||i.authService.isAdmin()?0:-1)}}var qe=class n{menuItems=b.required();configurationService=l(ue);router=l(X);authService=l($e);showProductFilters=f(!1);isOnProducts=f(!1);isMobile=f(!1);constructor(){this.isOnProducts.set(this.router.url.startsWith("/products")),this.isMobile.set(window.innerWidth<1024),this.router.events.pipe(Me(e=>e instanceof Ee)).subscribe(e=>{let t=e.urlAfterRedirects.startsWith("/products");this.isOnProducts.set(t),t||this.showProductFilters.set(!1)})}isOpen(){return this.configurationService.sidebarItemsStatus()==="open"}close(){this.configurationService.toggleSidebarItemsStatus("closed")}handleEscape(e){e.key==="Escape"&&this.isOpen()&&this.close()}onResize(){this.isMobile.set(window.innerWidth<1024)}toggleProductFilters(){this.showProductFilters.update(e=>!e)}handleProductClick(){if(this.isMobile()){this.toggleProductFilters();return}if(this.isOnProducts()){this.toggleProductFilters();return}this.showProductFilters.set(!0),this.configurationService.toggleSidebarItemsStatus("closed"),this.configurationService.toggleSidebarPageStatus("closed"),this.router.navigateByUrl("/products")}handleMenuClick(e){e.adminOnly&&!this.authService.isAdmin()||(this.configurationService.toggleSidebarItemsStatus("closed"),this.configurationService.toggleSidebarPageStatus("closed"),typeof e.routerLink=="string"?this.router.navigateByUrl(e.routerLink):this.router.navigate([e.routerLink]))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["sidebar-items"]],hostBindings:function(t,i){t&1&&m("keydown",function(o){return i.handleEscape(o)},xe)("resize",function(){return i.onResize()},xe)},inputs:{menuItems:[1,"menuItems"]},decls:10,vars:2,consts:[[1,"sidebar-shell","fixed","inset-0","bg-base-100","z-50","transform","transition-transform","duration-500","-translate-x-full","flex","flex-col"],[1,"flex","items-center","justify-between","px-4","h-14","border-b","border-base-300","shrink-0"],[1,"text-base","font-semibold"],[1,"p-2",3,"click"],[1,"sidebar-content","flex-1","overflow-y-auto","px-4","pb-6"],[1,"flex","flex-col","gap-2"],[1,"p-2","cursor-pointer","rounded-md","text-base-content","hover:bg-base-200","transition-colors","duration-200"],["type","button",1,"p-2","cursor-pointer","rounded-md","text-base-content","hover:bg-base-200","transition-colors","duration-200","flex","items-center","gap-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-3.5","h-3.5","text-slate-500","transition-transform","duration-300"],["stroke-linecap","round","stroke-linejoin","round","d","M9 5l7 7-7 7"],[1,"submenu-container"],[1,"submenu-inner"],[1,"block","lg:hidden","mt-2"],[1,"p-2","cursor-pointer","rounded-md","text-base-content","hover:bg-base-200","transition-colors","duration-200",3,"click"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),u(3,"Men\xFA"),s(),a(4,"button",3),m("click",function(){return i.configurationService.toggleSidebarItemsStatus("closed")}),C(5,"x-circle"),s()(),a(6,"div",4)(7,"nav",5),k(8,it,1,1,null,null,se),s()()()),t&2&&(L("translate-x-0",i.isOpen()),c(8),F(i.menuItems()))},dependencies:[K,be],styles:["[_nghost-%COMP%]{display:block}.sidebar-shell[_ngcontent-%COMP%]{height:100vh;height:100dvh;display:flex;flex-direction:column;overflow:hidden}.sidebar-content[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch;overscroll-behavior:contain;min-height:0}.submenu-container[_ngcontent-%COMP%]{overflow:hidden;max-height:0;opacity:0;transition:max-height .35s ease,opacity .25s ease}.submenu-container.open[_ngcontent-%COMP%]{max-height:1000px;opacity:1}.submenu-inner[_ngcontent-%COMP%]{margin-left:.5rem;padding-left:.25rem}"]})};function nt(n,e){if(n&1&&(a(0,"div",2),I(),a(1,"svg",4),C(2,"path",5),s(),R(),a(3,"span",6),u(4),s()()),n&2){let t=d();c(4),ke(t.error())}}function rt(n,e){n&1&&C(0,"loading",3)}function at(n,e){n&1&&C(0,"success",3)}var Ae=class n{toastService=l(T);loading=this.toastService.loading;success=this.toastService.success;error=this.toastService.error;positionClass="bottom-4 right-4";overFooterClass="bottom-24 right-6";footerVisible=f(!1);footerObserver=null;ngOnInit(){let e=document.querySelector("app-footer");e&&(this.footerObserver=new IntersectionObserver(t=>{let i=t.some(r=>r.isIntersecting);this.footerVisible.set(i)},{threshold:.1}),this.footerObserver.observe(e))}ngOnDestroy(){this.footerObserver?.disconnect()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["toast"]],inputs:{positionClass:"positionClass",overFooterClass:"overFooterClass"},decls:5,vars:2,consts:[[1,"relative"],[1,"fixed","flex","items-center","justify-center",3,"ngClass"],[1,"flex","items-start","gap-3","px-4","py-3","rounded-xl","shadow-lg","bg-error","text-error-content","max-w-sm","w-72"],[1,"w-16","h-16","flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-5","h-5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","d","M12 9v4m0 4h.01m9.49 0-9.5-16-9.5 16h19Z"],[1,"text-sm","leading-snug"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1),D(2,nt,5,1,"div",2)(3,rt,1,0,"loading",3)(4,at,1,0,"success",3),s()()),t&2&&(c(),y("ngClass",i.footerVisible()?i.overFooterClass:i.positionClass),c(),$(i.error()?2:i.loading()?3:i.success()?4:-1))},dependencies:[W,de,Ne,je],styles:["[_nghost-%COMP%]{display:block}"]})};var ne=`${O.baseUrl}/contacts`,ot={id:"new",title:"",phone:"",email:""},ze=class n{http=l(j);contactsCache=new Map;toastService=l(T);getAll(){return this.contactsCache.size?h(Array.from(this.contactsCache.values())):this.http.get(ne).pipe(p(e=>e.forEach(t=>this.contactsCache.set(t.id,t))))}getById(e){return e==="new"?h(ot):this.contactsCache.has(e)?h(this.contactsCache.get(e)):this.http.get(`${ne}/${e}`).pipe(p(t=>this.contactsCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(ne,e).pipe(p(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${ne}/${e}`,t).pipe(p(async i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${ne}/${e}`).pipe(p(async()=>{this.contactsCache.delete(e),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.contactsCache.set(e.id,e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=w({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ue=class n{activateRoute=l(me);router=l(X);currentPage=De(this.activateRoute.queryParamMap.pipe(we(e=>e.get("page")?+e.get("page"):1),we(e=>isNaN(e)?1:e)),{initialValue:1});setCurrentPage(e){this.router.navigate([],{queryParams:{page:e},queryParamsHandling:"merge"})}resetPage(){this.router.navigate([],{queryParams:{page:null},queryParamsHandling:"merge"})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=w({token:n,factory:n.\u0275fac,providedIn:"root"})};var Y=`${O.baseUrl}/products`,st={id:"new",title:"",price:0,description:"",slug:"",stock:0,isFeatured:!1,tags:[],deleteAt:null,images:[],imageIds:[],category:{id:"",name:""},user:{}},ve=class n{constructor(){}http=l(j);productsCache=new Map;productCache=new Map;toastService=l(T);getProducts(e={}){let t=O.cantProducts,{limit:i=t,offset:r=0,isFeatured:o=!1,categoryId:_,tagIds:V,query:H,sortBy:G,sortOrder:E}=e,_e=o?"isFeatured":`${i}-${r}-${_??"all"}-${(V??[]).join(",")}-${H??""}-${G??"none"}-${E??"none"}`;if(this.productsCache.has(_e))return h(this.productsCache.get(_e));let q={limit:i,offset:r};return o!==void 0&&(q.isFeatured=o),_&&(q.categoryId=_),V&&V.length&&(q.tagIds=V),H&&(q.query=H),G&&(q.sortBy=G),E&&(q.sortOrder=E),this.http.get(Y,{params:q,responseType:"json"}).pipe(p(Qe=>this.productsCache.set(_e,Qe)))}searchProducts(e={}){let{query:t="",limit:i=O.cantProducts,offset:r=0,categoryId:o,tagIds:_,isFeatured:V,sortBy:H,sortOrder:G}=e,E={query:t,limit:i,offset:r};return o&&(E.categoryId=o),_&&_.length&&(E.tagIds=_),V!==void 0&&(E.isFeatured=V),H&&(E.sortBy=H),G&&(E.sortOrder=G),this.http.get(`${Y}/search`,{params:E,responseType:"json"})}getProductByIdSlug(e){return e==="new"?h(st):this.productCache.has(e)?h(this.productCache.get(e)):this.http.get(`${Y}/${e}`,{responseType:"json"}).pipe(p(i=>this.productCache.set(e,i)))}createProduct(e){return this.toastService.activateLoading(),this.http.post(`${Y}`,e).pipe(p(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}updateProduct(e,t){return this.toastService.activateLoading(),this.http.patch(`${Y}/${e}`,t).pipe(p(i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}deleteProduct(e){return this.toastService.activateLoading(),this.http.delete(`${Y}/${e}`).pipe(p(()=>{this.productCache.delete(e),this.productsCache.clear(),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.productCache.get(e.id)?(this.productCache.set(e.id,e),this.productsCache.forEach(i=>{i.products=i.products.map(r=>r.id===e.id?e:r)})):(this.productCache.set(e.id,e),this.productsCache.clear())}static \u0275fac=function(t){return new(t||n)};static \u0275prov=w({token:n,factory:n.\u0275fac,providedIn:"root"})};var ct=["swiper"];function lt(n,e){if(n&1&&(A(0,"swiper-slide",2),Z(1,"img",4),Q()),n&2){let t=e.$implicit;c(),Ie("src",t,oe)}}function pt(n,e){if(n&1&&k(0,lt,2,1,"swiper-slide",2,se),n&2){let t=d();F(t.images())}}function dt(n,e){n&1&&(A(0,"swiper-slide",2),Z(1,"img",5),Q())}var Ce=class n{images=b.required();autoplay=b(!0);loop=b(!0);effect=b("fade");autoplayDelay=b(5e3);spaceBetween=10;slidesPerView=1;slideChange=new Oe;swiperRef;slideListenerAdded=!1;ngOnChanges(e){(e.images||e.autoplay||e.loop||e.effect)&&this.refreshSwiper()}ngAfterViewInit(){queueMicrotask(()=>this.setupSwiper())}setupSwiper(){let e=this.swiperRef?.nativeElement;if(!e)return;let{enableAutoplay:t}=this.applyConfig(e);e.initialize(),t&&e.swiper?.autoplay?.start(),this.addSlideListener(e)}goTo(e){let t=this.swiperRef?.nativeElement;t?.swiper&&((t.swiper.params?.loop?t.swiper.slideToLoop.bind(t.swiper):t.swiper.slideTo.bind(t.swiper))(e),this.slideChange.emit(e))}refreshSwiper(){let e=this.swiperRef?.nativeElement;if(!e)return;let{enableAutoplay:t}=this.applyConfig(e);e.swiper?(e.swiper.update(),t?e.swiper.autoplay?.start():e.swiper.autoplay?.stop()):(e.initialize(),t&&e.swiper?.autoplay?.start()),this.addSlideListener(e)}applyConfig(e){let t=this.images(),i=Array.isArray(t)&&t.length>1,r=this.autoplay()&&i,o=this.loop()&&i;return e.pagination={clickable:!0,dynamicBullets:!0,type:"bullets"},e.navigation=!0,e.autoplay=r?{delay:this.autoplayDelay()??5e3,disableOnInteraction:!1,pauseOnMouseEnter:!0,reverseDirection:!1}:!1,e.speed=800,e.effect=this.effect(),e.fadeEffect=this.effect()==="fade"?{crossFade:!0}:void 0,e.spaceBetween=this.spaceBetween,e.rewind=!o,e.loopAdditionalSlides=o?1:0,e.slidesPerView=this.slidesPerView,e.loop=o,{enableAutoplay:r}}addSlideListener(e){this.slideListenerAdded||(e.addEventListener("slidechange",()=>{let t=e.swiper?.realIndex??0;this.slideChange.emit(t)}),this.slideListenerAdded=!0)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["image-carrusel"]],viewQuery:function(t,i){if(t&1&&ce(ct,5),t&2){let r;le(r=pe())&&(i.swiperRef=r.first)}},inputs:{images:[1,"images"],autoplay:[1,"autoplay"],loop:[1,"loop"],effect:[1,"effect"],autoplayDelay:[1,"autoplayDelay"]},outputs:{slideChange:"slideChange"},features:[ae],decls:5,vars:1,consts:[["swiper",""],["navigation","true","pagination","true","pagination-clickable","true","rewind","true","speed","1200","effect","fade","fade-effect-cross-fade","true","dir","ltr",1,"w-full","h-full"],[1,"w-full","h-full","flex","justify-center","items-center"],["slot","pagination",1,"swiper-pagination"],["alt","Imagen",1,"w-full","h-full","object-contain","object-center",3,"src"],["src","assets/images/default-image.jpg","alt","Imagen por defecto",1,"w-full","h-full","object-contain","object-center","opacity-80"]],template:function(t,i){t&1&&(A(0,"swiper-container",1,0),D(2,pt,2,0)(3,dt,2,0,"swiper-slide",2),Z(4,"div",3),Q()),t&2&&(c(2),$(i.images().length?2:3))},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}swiper-container[_ngcontent-%COMP%]{height:100%;--swiper-theme-color: #ffffff;--swiper-navigation-color: #ffffff;--swiper-pagination-color: #ffffff;--swiper-pagination-bullet-inactive-color: #e5e7eb;--swiper-pagination-bullet-inactive-opacity: .6;--swiper-pagination-bullet-size: 10px;--swiper-pagination-bullet-horizontal-gap: 6px;--swiper-navigation-size: 28px;--swiper-navigation-sides-offset: 40px}swiper-slide[_ngcontent-%COMP%]{height:100%}swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;object-position:center center;display:block}swiper-container[_ngcontent-%COMP%]::part(button-prev), swiper-container[_ngcontent-%COMP%]::part(button-next), swiper-container[_ngcontent-%COMP%]::part(pagination){z-index:50;filter:drop-shadow(0 2px 4px rgba(0,0,0,.6))}swiper-container[_ngcontent-%COMP%]::part(button-prev), swiper-container[_ngcontent-%COMP%]::part(button-next){top:52%;transform:translateY(-50%)}swiper-container[_ngcontent-%COMP%]::part(pagination){bottom:24px;left:0;right:0;width:100%;display:flex;justify-content:center}swiper-container[_ngcontent-%COMP%]   [slot=pagination][_ngcontent-%COMP%]{position:absolute;left:0;right:0;bottom:24px;z-index:50;filter:drop-shadow(0 2px 4px rgba(0,0,0,.6));display:flex;justify-content:center}@media (max-width: 640px){swiper-container[_ngcontent-%COMP%]{--swiper-navigation-sides-offset: 28px;--swiper-navigation-size: 22px;--swiper-pagination-bullet-size: 5px;--swiper-pagination-bullet-horizontal-gap: 4px}swiper-container[_ngcontent-%COMP%]::part(pagination){bottom:18px}swiper-container[_ngcontent-%COMP%]   [slot=pagination][_ngcontent-%COMP%]{bottom:18px}}"]})};var mt=["carousel"],gt=(n,e)=>e.identifier??e.src;function ut(n,e){if(n&1){let t=M();a(0,"span",9),m("click",function(r){x(t);let o=d().$implicit,_=d(2);return S(_.onRemove(r,o.identifier??o.src))}),C(1,"x-circle"),s()}}function ht(n,e){if(n&1){let t=M();a(0,"button",6),m("click",function(){let r=x(t).$index,o=d(2);return S(o.goTo(r))}),C(1,"img",7),D(2,ut,2,0,"span",8),s()}if(n&2){let t=e.$implicit,i=e.$index,r=d(2);L("active",r.currentIndex()===i),c(),y("src",t.src,oe)("alt",t.alt||"Imagen "+(i+1)),c(),$(r.removable()?2:-1)}}function ft(n,e){if(n&1&&(a(0,"div",4),k(1,ht,3,5,"button",5,gt),s()),n&2){let t=d();c(),F(t.images())}}var Be=class n{images=b.required();removable=b(!1);autoplay=b(!0);loop=b(!0);effect=b("fade");remove=Se();slideChange=Se();carousel;currentIndex=f(0);imageUrls(){return this.images().map(e=>e?.src).filter(e=>!!e)}handleSlideChange(e){this.currentIndex.set(e),this.slideChange.emit(e)}goTo(e){this.carousel?.goTo(e),this.handleSlideChange(e)}onRemove(e,t){e.stopPropagation(),this.remove.emit(t)}ngOnChanges(e){e.images&&(this.currentIndex.set(0),queueMicrotask(()=>this.carousel?.goTo(0)))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["image-gallery"]],viewQuery:function(t,i){if(t&1&&ce(mt,5),t&2){let r;le(r=pe())&&(i.carousel=r.first)}},inputs:{images:[1,"images"],removable:[1,"removable"],autoplay:[1,"autoplay"],loop:[1,"loop"],effect:[1,"effect"]},outputs:{remove:"remove",slideChange:"slideChange"},features:[ae],decls:5,vars:5,consts:[["carousel",""],[1,"gallery"],[1,"gallery-main"],[3,"slideChange","images","autoplay","loop","effect"],[1,"gallery-thumbs"],["type","button",1,"thumb",3,"active"],["type","button",1,"thumb",3,"click"],[3,"src","alt"],[1,"remove-btn"],[1,"remove-btn",3,"click"]],template:function(t,i){if(t&1){let r=M();a(0,"div",1)(1,"div",2)(2,"image-carrusel",3,0),m("slideChange",function(_){return x(r),S(i.handleSlideChange(_))}),s()(),D(4,ft,3,0,"div",4),s()}t&2&&(c(2),y("images",i.imageUrls())("autoplay",i.autoplay())("loop",i.loop())("effect",i.effect()),c(2),$(i.images().length?4:-1))},dependencies:[W,Ce,K],styles:["[_nghost-%COMP%]{display:block}.gallery[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;align-items:center}.gallery-main[_ngcontent-%COMP%]{width:100%;max-width:1536px;aspect-ratio:3 / 2;max-height:1024px;margin-inline:auto;border-radius:clamp(.5rem,1vw,.75rem);overflow:hidden;background:hsl(var(--b2));border:1px solid hsl(var(--b3))}.gallery-main[_ngcontent-%COMP%]   image-carrusel[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.gallery-main[_ngcontent-%COMP%]   swiper-container[_ngcontent-%COMP%], .gallery-main[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]{width:100%;height:100%}.gallery-main[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain}.gallery-thumbs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:center;width:100%;max-width:1536px;margin-inline:auto;padding-bottom:.5rem}.thumb[_ngcontent-%COMP%]{position:relative;border:2px solid transparent;border-radius:.5rem;padding:.15rem;background:hsl(var(--b2));width:clamp(72px,18vw,96px);height:clamp(54px,13vw,72px);cursor:pointer;transition:border-color .2s ease,transform .2s ease}.thumb[_ngcontent-%COMP%]:hover{transform:translateY(-1px);border-color:hsl(var(--b3))}.thumb.active[_ngcontent-%COMP%]{border-color:hsl(var(--p));box-shadow:0 0 0 3px hsla(var(--p) / .2);box-shadow:0 0 0 3px color-mix(in srgb,hsl(var(--p)) 20%,transparent)}.thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:.35rem}.remove-btn[_ngcontent-%COMP%]{position:absolute;top:6px;right:6px;width:1.75rem;height:1.75rem;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;background:hsl(var(--b1));box-shadow:0 6px 14px hsla(var(--bc) / .12);box-shadow:0 6px 14px color-mix(in srgb,hsl(var(--bc)) 12%,transparent)}@supports not (aspect-ratio: 1 / 1){.gallery-main[_ngcontent-%COMP%]{position:relative;padding-top:66.666%;height:auto}.gallery-main[_ngcontent-%COMP%]   image-carrusel[_ngcontent-%COMP%]{position:absolute;inset:0}}"]})};function ln(){let n=l(ve),e=f(null),t=f(!0),i=f(null);async function r(o){t.set(!0),i.set(null);try{let _=o.query?await Pe(n.searchProducts(o)):await Pe(n.getProducts(o));e.set(_)}catch{i.set("Error al cargar los productos")}finally{t.set(!1)}}return{productResponse:e,loading:t,error:i,loadProducts:r}}var re=()=>[],bt=()=>({page:1}),ye=n=>({page:n});function vt(n,e){if(n&1){let t=M();a(0,"button",14),m("click",function(){let r=x(t).$implicit,o=d();return S(o.goToPage(r))}),u(1),s()}if(n&2){let t=e.$implicit,i=d();L("btn-primary",t===i.activePage()),y("routerLink",U(5,re))("queryParams",ee(6,ye,t)),c(),z(" ",t," ")}}function Ct(n,e){n&1&&(a(0,"button",8),u(1,"0"),s())}var He=class n{pages=b(0);currentPage=b(1);activePage=Fe(this.currentPage);totalPages=N(()=>Math.max(0,this.pages()??0));getPagesList=N(()=>{let e=this.totalPages();return e?Array.from({length:e},(t,i)=>i+1):[]});isFirstPage=N(()=>this.activePage()<=1);isLastPage=N(()=>this.activePage()>=this.totalPages()&&this.totalPages()>0);previousPage=N(()=>Math.max(1,this.activePage()-1));nextPage=N(()=>Math.min(this.totalPages(),this.activePage()+1));goToPage(e){if(!this.totalPages())return;let t=Math.min(Math.max(e,1),this.totalPages());this.activePage.set(t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["pagination"]],inputs:{pages:[1,"pages"],currentPage:[1,"currentPage"]},decls:18,vars:24,consts:[[1,"join","flex","justify-center","items-center"],["type","button","aria-label","Primera p\xE1gina","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-4"],["fill-rule","evenodd","d","M10.72 11.47a.75.75 0 0 0 0 1.06l7.5 7.5a.75.75 0 1 0 1.06-1.06L12.31 12l6.97-6.97a.75.75 0 0 0-1.06-1.06l-7.5 7.5Z","clip-rule","evenodd"],["fill-rule","evenodd","d","M4.72 11.47a.75.75 0 0 0 0 1.06l7.5 7.5a.75.75 0 1 0 1.06-1.06L6.31 12l6.97-6.97a.75.75 0 0 0-1.06-1.06l-7.5 7.5Z","clip-rule","evenodd"],["type","button","aria-label","P\xE1gina anterior","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["fill-rule","evenodd","d","M7.72 12.53a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 1 1 1.06 1.06L9.31 12l6.97 6.97a.75.75 0 1 1-1.06 1.06l-7.5-7.5Z","clip-rule","evenodd"],["type","button","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"btn-primary","routerLink","queryParams"],["type","button","disabled","",1,"join-item","btn"],["type","button","aria-label","P\xE1gina siguiente","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["fill-rule","evenodd","d","M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z","clip-rule","evenodd"],["type","button","aria-label","\xDAltima p\xE1gina","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["fill-rule","evenodd","d","M13.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L11.69 12 4.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z","clip-rule","evenodd"],["fill-rule","evenodd","d","M19.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06L17.69 12l-6.97-6.97a.75.75 0 0 1 1.06-1.06l7.5 7.5Z","clip-rule","evenodd"],["type","button","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","routerLink","queryParams"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"button",1),m("click",function(){return i.goToPage(1)}),I(),a(2,"svg",2),C(3,"path",3)(4,"path",4),s()(),R(),a(5,"button",5),m("click",function(){return i.goToPage(i.previousPage())}),I(),a(6,"svg",2),C(7,"path",6),s()(),k(8,vt,2,8,"button",7,Te,!1,Ct,2,0,"button",8),R(),a(11,"button",9),m("click",function(){return i.goToPage(i.nextPage())}),I(),a(12,"svg",2),C(13,"path",10),s()(),R(),a(14,"button",11),m("click",function(){return i.goToPage(i.totalPages())}),I(),a(15,"svg",2),C(16,"path",12)(17,"path",13),s()()()),t&2&&(c(),y("disabled",i.isFirstPage()||!i.totalPages())("routerLink",U(13,re))("queryParams",U(14,bt)),c(4),y("disabled",i.isFirstPage()||!i.totalPages())("routerLink",U(15,re))("queryParams",ee(16,ye,i.previousPage())),c(3),F(i.getPagesList()),c(3),y("disabled",i.isLastPage()||!i.totalPages())("routerLink",U(18,re))("queryParams",ee(19,ye,i.nextPage())),c(3),y("disabled",i.isLastPage()||!i.totalPages())("routerLink",U(21,re))("queryParams",ee(22,ye,i.totalPages()||1)))},dependencies:[ge],styles:["[_nghost-%COMP%]{display:block}"]})};var J=`${O.baseUrl}/recipes`,yt={id:"new",title:"",text:""},Ge=class n{http=l(j);recipesCache=new Map;toastService=l(T);getAll(){return this.recipesCache.size?h(Array.from(this.recipesCache.values())):this.http.get(J).pipe(p(e=>e.forEach(t=>this.recipesCache.set(t.id,t))))}getById(e){return e==="new"?h(yt):this.recipesCache.has(e)?h(this.recipesCache.get(e)):this.http.get(`${J}/${e}`).pipe(p(t=>this.recipesCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(J,e).pipe(p(async t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${J}/${e}`,t).pipe(p(i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${J}/${e}`).pipe(p(async()=>{this.recipesCache.delete(e),this.toastService.activateSuccess()}),g(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.recipesCache.set(e.id,e)}searchByIngredients(e,t){let i=(e??[]).map(o=>o.trim()).filter(o=>!!o),r=new Le({fromObject:{ingredients:i.join(","),limit:String(t?.limit??10),offset:String(t?.offset??0)}});return this.http.get(`${J}/search`,{params:r,responseType:"json"})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=w({token:n,factory:n.\u0275fac,providedIn:"root"})};export{Re as a,K as b,he as c,fe as d,qe as e,Ae as f,ze as g,Ue as h,ve as i,Ce as j,Be as k,ln as l,He as m,Ge as n};
