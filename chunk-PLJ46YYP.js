import{a as h}from"./chunk-K6ZCG6NC.js";import{b as fe}from"./chunk-MU5QS4NU.js";import{a as Q,b as T,c as m,d as L,e as P,g as A,j as R,k as B,n as O,p as j}from"./chunk-OM6ANGYZ.js";import{$ as S,A as M,Aa as Z,B as y,C as z,Ca as J,F as f,Ga as I,Ha as c,Ia as re,Ja as le,Ka as de,M as a,P as g,Va as V,Xa as ce,Z as _,Za as x,aa as ae,ca as N,da as D,ea as d,fa as i,ga as t,gb as me,ha as l,hb as K,ib as w,jb as ue,la as H,na as v,pa as C,pb as pe,xa as o,y as p,ya as b,z as U,za as $}from"./chunk-5MMUUPIE.js";var ge=()=>({exact:!0}),W=class r{authService=p(pe);static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-user"]],decls:34,vars:4,consts:[[1,"space-y-4"],[1,"text-3xl","font-bold","mb-2","mt-6"],[1,"grid","grid-cols-1","lg:grid-cols-[18%_1fr]","gap-4","lg:gap-6","items-start"],[1,"hidden","lg:block","rounded-xl","border","border-base-200","bg-base-100/60","p-3","shadow-sm","backdrop-blur-sm"],[1,"flex","flex-col","gap-2"],["routerLink","/user/profile","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block",3,"routerLinkActiveOptions"],["routerLink","/user/directions","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block"],["routerLink","/user/billing","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block"],["routerLink","/user/orders","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block"],[1,"flex","flex-col","gap-4"],[1,"lg:hidden","rounded-xl","border","border-base-200","bg-base-100/60","p-3","shadow-sm","backdrop-blur-sm"]],template:function(e,s){e&1&&(i(0,"div",0)(1,"h1",1),o(2,"Mi Cuenta"),t(),i(3,"div",2)(4,"aside",3)(5,"ul",4)(6,"li")(7,"a",5),o(8," Mi perfil "),t()(),i(9,"li")(10,"a",6),o(11," Mis direcciones "),t()(),i(12,"li")(13,"a",7),o(14," Mis datos de facturaci\xF3n "),t()(),i(15,"li")(16,"a",8),o(17," Mis pedidos "),t()()()(),i(18,"main",9)(19,"div",10)(20,"ul",4)(21,"li")(22,"a",5),o(23," Mi perfil "),t()(),i(24,"li")(25,"a",6),o(26," Mis direcciones "),t()(),i(27,"li")(28,"a",7),o(29," Mis datos de facturaci\xF3n "),t()(),i(30,"li")(31,"a",8),o(32," Mis pedidos "),t()()()(),l(33,"router-outlet"),t()()()),e&2&&(a(7),d("routerLinkActiveOptions",I(2,ge)),a(15),d("routerLinkActiveOptions",I(3,ge)))},dependencies:[w,ue,me],styles:["[_nghost-%COMP%]{display:block}"]})};var ve=()=>["/user/billing","new"],xe=r=>({edit:r}),he=(r,n)=>n.id;function Ce(r,n){r&1&&(i(0,"p"),o(1,"Cargando datos de facturaci\xF3n..."),t())}function ye(r,n){r&1&&(i(0,"p",6),o(1,"A\xFAn no agregaste datos de facturaci\xF3n."),t())}function _e(r,n){r&1&&(y(),i(0,"svg",14),l(1,"path",21),t())}function Se(r,n){r&1&&(y(),i(0,"svg",15),l(1,"path",22),t())}function we(r,n){if(r&1){let e=H();i(0,"article",7)(1,"div",8)(2,"h3",9),o(3),t()(),i(4,"p",10),o(5),t(),i(6,"p",10),o(7),t(),i(8,"p",11),o(9),t(),i(10,"div",12)(11,"button",13),v("click",function(){let u=U(e).$implicit,k=C(2);return M(k.toggleDefault(u))}),_(12,_e,2,0,":svg:svg",14)(13,Se,2,0,":svg:svg",15),t(),i(14,"a",16),y(),i(15,"svg",17),l(16,"path",18),t()(),z(),i(17,"button",19),v("click",function(){let u=U(e).$implicit,k=C(2);return M(k.remove(u))}),y(),i(18,"svg",17),l(19,"path",20),t()()()()}if(r&2){let e=n.$implicit;a(3),b(e.legalName),a(2),$("RUC: ",e.taxId),a(2),Z("",e.email," \xB7 ",e.phone),a(2),J("",e.addressLine1,", ",e.city,", ",e.state," - ",e.country),a(3),S(e.isDefault?12:13),a(2),d("routerLink",I(11,ve))("queryParams",c(12,xe,e.id))}}function Ee(r,n){if(r&1&&N(0,we,20,14,"article",7,he),r&2){let e=C();D(e.profiles())}}var X=class r{accountService=p(h);profiles=f([]);loading=f(!0);ngOnInit(){this.load()}load(){this.loading.set(!0),this.accountService.getBillingProfiles().subscribe({next:n=>this.profiles.set(n??[]),error:()=>this.loading.set(!1),complete:()=>this.loading.set(!1)})}toggleDefault(n){this.loading.set(!0);let e=!(n.isDefault??!1);this.accountService.updateBilling(n.id,{isDefault:e}).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}remove(n){this.loading.set(!0),this.accountService.deleteBilling(n.id).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-user-billings"]],decls:13,vars:1,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],["routerLink","/user/billing/new",1,"btn","btn-primary","btn-sm"],[1,"space-y-3"],[1,"text-base-content/70"],[1,"p-4","border","border-base-300","rounded-lg","bg-base-100","shadow-sm"],[1,"flex","flex-wrap","items-center","gap-2","justify-between"],[1,"font-semibold","text-lg"],[1,"text-sm","text-base-content/70","mt-1"],[1,"text-sm","text-base-content/80","mt-1"],[1,"flex","flex-wrap","items-center","gap-1","mt-3","justify-end"],["type","button","aria-label","Marcar como principal",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-5","text-warning"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-base-content"],["aria-label","Editar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5"],["stroke-linecap","round","stroke-linejoin","round","d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"],["type","button","aria-label","Eliminar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-error/10","text-error",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"],["fill-rule","evenodd","d","M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z","clip-rule","evenodd"],["stroke-linecap","round","stroke-linejoin","round","d","M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),o(4,"Datos de facturaci\xF3n"),t(),i(5,"p",3),o(6,"Gestiona tus perfiles de factura."),t()(),i(7,"a",4),o(8,"Agregar nuevo"),t()(),i(9,"div",5),_(10,Ce,2,0,"p")(11,ye,2,0,"p",6)(12,Ee,2,0),t()()),e&2&&(a(10),S(s.loading()?10:s.profiles().length===0?11:12))},dependencies:[x,w],styles:["[_nghost-%COMP%]{display:block}"]})};var ke=()=>["/user/directions","new"],Ne=r=>({edit:r}),De=(r,n)=>n.id;function Ie(r,n){r&1&&(i(0,"p"),o(1,"Cargando direcciones..."),t())}function Fe(r,n){r&1&&(i(0,"p",6),o(1,"A\xFAn no agregaste direcciones."),t())}function Ue(r,n){r&1&&(y(),i(0,"svg",15),l(1,"path",22),t())}function Me(r,n){r&1&&(y(),i(0,"svg",16),l(1,"path",23),t())}function Ve(r,n){if(r&1){let e=H();i(0,"article",7)(1,"div",8)(2,"div",9)(3,"h3",10),o(4),t(),i(5,"p",11),o(6),t(),i(7,"p",12),o(8),t()(),i(9,"div",13)(10,"button",14),v("click",function(){let u=U(e).$implicit,k=C(2);return M(k.toggleDefault(u))}),_(11,Ue,2,0,":svg:svg",15)(12,Me,2,0,":svg:svg",16),t(),i(13,"a",17),y(),i(14,"svg",18),l(15,"path",19),t()(),z(),i(16,"button",20),v("click",function(){let u=U(e).$implicit,k=C(2);return M(k.remove(u))}),y(),i(17,"svg",18),l(18,"path",21),t()()()()()}if(r&2){let e=n.$implicit;a(4),b(e.label),a(2),Z("",e.fullName," \xB7 ",e.phone),a(2),J("",e.street,", ",e.city,", ",e.state," - ",e.country),a(3),S(e.isDefault?11:12),a(2),d("routerLink",I(10,ke))("queryParams",c(11,Ne,e.id))}}function Te(r,n){if(r&1&&N(0,Ve,19,13,"article",7,De),r&2){let e=C();D(e.addresses())}}var Y=class r{accountService=p(h);addresses=f([]);loading=f(!0);ngOnInit(){this.load()}load(){this.loading.set(!0),this.accountService.getAddresses().subscribe({next:n=>this.addresses.set(n??[]),error:()=>this.loading.set(!1),complete:()=>this.loading.set(!1)})}toggleDefault(n){this.loading.set(!0);let e=!(n.isDefault??!1);this.accountService.updateAddress(n.id,{isDefault:e}).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}remove(n){this.loading.set(!0),this.accountService.deleteAddress(n.id).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-user-directions"]],decls:13,vars:1,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],["routerLink","/user/directions/new",1,"btn","btn-primary","btn-sm"],[1,"space-y-3"],[1,"text-base-content/70"],[1,"p-4","border","border-base-300","rounded-lg","bg-base-100","shadow-sm"],[1,"flex","items-start","justify-between","gap-3"],[1,"space-y-1"],[1,"font-semibold","text-lg","leading-tight"],[1,"text-sm","text-base-content/70","leading-snug"],[1,"text-sm","text-base-content/80","leading-snug"],[1,"flex","items-center","gap-1"],["type","button","aria-label","Marcar como principal",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-5","text-warning"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-base-content"],["aria-label","Editar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5"],["stroke-linecap","round","stroke-linejoin","round","d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"],["type","button","aria-label","Eliminar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-error/10","text-error",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"],["fill-rule","evenodd","d","M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z","clip-rule","evenodd"],["stroke-linecap","round","stroke-linejoin","round","d","M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),o(4,"Mis direcciones"),t(),i(5,"p",3),o(6,"Revisa tus datos de env\xEDo."),t()(),i(7,"a",4),o(8,"Agregar nuevo"),t()(),i(9,"div",5),_(10,Ie,2,0,"p")(11,Fe,2,0,"p",6)(12,Te,2,0),t()()),e&2&&(a(10),S(s.loading()?10:s.addresses().length===0?11:12))},dependencies:[x,w],styles:["[_nghost-%COMP%]{display:block}"]})};var F=r=>({"border-error focus:border-error":r}),ee=class r{fb=p(O);accountService=p(h);router=p(K);editingId=null;submitting=f(!1);form=this.fb.nonNullable.group({label:["",[m.required]],fullName:["",[m.required]],phone:["",[m.required]],street:["",[m.required]],city:["",[m.required]],state:["",[m.required]],country:["Paraguay",[m.required]],isDefault:[!1]});initialValue=this.form.getRawValue();ngOnInit(){let e=new URL(window.location.href).searchParams.get("edit");e&&(this.editingId=e,this.prefill(e))}prefill(n){this.submitting.set(!0),this.accountService.getAddresses().subscribe({next:e=>{let s=(e??[]).find(u=>u.id===n);s&&(this.form.patchValue(s),this.updateInitialValue())},complete:()=>this.submitting.set(!1),error:()=>this.submitting.set(!1)})}save(){if(this.form.invalid)return;this.submitting.set(!0);let n=this.form.getRawValue();(this.editingId?this.accountService.updateAddress(this.editingId,n):this.accountService.createAddress(n)).subscribe({next:()=>{this.updateInitialValue(),this.submitting.set(!1),this.router.navigate(["/user/directions"])},error:()=>this.submitting.set(!1)})}hasChanges(){return!this.isEqual(this.form.getRawValue(),this.initialValue)}updateInitialValue(){this.initialValue=this.form.getRawValue(),this.form.markAsPristine()}isEqual(n,e){let s=Object.keys(n);return s.length===Object.keys(e).length&&s.every(u=>n[u]===e[u])}isInvalid(n){let e=this.form.get(n);return!!e&&e.invalid&&(e.dirty||e.touched)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-user-directions-new"]],decls:43,vars:24,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","bg-base-200/60","rounded-lg","p-5",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"font-semibold"],["formControlName","label","placeholder","Casa / Oficina",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","phone",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","fullName",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","state",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","flex-col","gap-2"],["formControlName","street","placeholder","Calle y n\xFAmero",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","city",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","country",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","items-center","gap-2","pt-1"],["type","checkbox","formControlName","isDefault",1,"checkbox","checkbox-primary"],[1,"md:col-span-2","flex","justify-end"],["type","submit",1,"btn","btn-primary","min-w-36",3,"disabled"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),o(4),t(),i(5,"p",3),o(6,"Completa los datos de env\xEDo."),t()()(),i(7,"form",4),v("ngSubmit",function(){return s.save()}),i(8,"div",5)(9,"span",6),o(10,"Etiqueta"),t(),l(11,"input",7),t(),i(12,"div",5)(13,"span",6),o(14,"Tel\xE9fono"),t(),l(15,"input",8),t(),i(16,"div",5)(17,"span",6),o(18,"Nombre completo"),t(),l(19,"input",9),t(),i(20,"div",5)(21,"span",6),o(22,"Departamento"),t(),l(23,"input",10),t(),i(24,"div",11)(25,"span",6),o(26,"Calle y n\xFAmero"),t(),l(27,"input",12),t(),i(28,"div",5)(29,"span",6),o(30,"Ciudad"),t(),l(31,"input",13),t(),i(32,"div",5)(33,"span",6),o(34,"Pa\xEDs"),t(),l(35,"input",14),t(),i(36,"label",15),l(37,"input",16),i(38,"span",6),o(39,"Usar como direcci\xF3n principal"),t()(),i(40,"div",17)(41,"button",18),o(42," Guardar "),t()()()()),e&2&&(a(4),b(s.editingId?"Editar direcci\xF3n":"Nueva direcci\xF3n"),a(3),d("formGroup",s.form),a(4),d("ngClass",c(10,F,s.isInvalid("label"))),a(4),d("ngClass",c(12,F,s.isInvalid("phone"))),a(4),d("ngClass",c(14,F,s.isInvalid("fullName"))),a(4),d("ngClass",c(16,F,s.isInvalid("state"))),a(4),d("ngClass",c(18,F,s.isInvalid("street"))),a(4),d("ngClass",c(20,F,s.isInvalid("city"))),a(4),d("ngClass",c(22,F,s.isInvalid("country"))),a(6),d("disabled",s.form.invalid||!s.hasChanges()||s.submitting()))},dependencies:[x,V,j,A,T,Q,L,P,R,B],styles:["[_nghost-%COMP%]{display:block}"]})};var E=r=>({"border-error focus:border-error":r}),te=class r{fb=p(O);accountService=p(h);router=p(K);editingId=null;submitting=f(!1);form=this.fb.nonNullable.group({legalName:["",[m.required]],taxId:["",[m.required]],email:["",[m.required,m.email]],phone:["",[m.required]],addressLine1:["",[m.required]],city:["",[m.required]],state:["",[m.required]],country:["Paraguay",[m.required]],isDefault:[!1]});initialValue=this.form.getRawValue();ngOnInit(){let e=new URL(window.location.href).searchParams.get("edit");e&&(this.editingId=e,this.prefill(e))}prefill(n){this.submitting.set(!0),this.accountService.getBillingProfiles().subscribe({next:e=>{let s=(e??[]).find(u=>u.id===n);s&&(this.form.patchValue(s),this.updateInitialValue())},complete:()=>this.submitting.set(!1),error:()=>this.submitting.set(!1)})}save(){if(this.form.invalid)return;this.submitting.set(!0);let n=this.form.getRawValue();(this.editingId?this.accountService.updateBilling(this.editingId,n):this.accountService.createBilling(n)).subscribe({next:()=>{this.updateInitialValue(),this.submitting.set(!1),this.router.navigate(["/user/billing"])},error:()=>this.submitting.set(!1)})}hasChanges(){return!this.isEqual(this.form.getRawValue(),this.initialValue)}updateInitialValue(){this.initialValue=this.form.getRawValue(),this.form.markAsPristine()}isEqual(n,e){let s=Object.keys(n);return s.length===Object.keys(e).length&&s.every(u=>n[u]===e[u])}isInvalid(n){let e=this.form.get(n);return!!e&&e.invalid&&(e.dirty||e.touched)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-user-billings-new"]],decls:48,vars:27,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","bg-base-200/60","rounded-lg","p-5",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"font-semibold"],["formControlName","legalName",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["type","email","formControlName","email",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","taxId",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","phone",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","country",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","state",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","flex-col","gap-2"],["formControlName","addressLine1",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","city",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"hidden","md:block"],[1,"md:col-span-2","flex","items-center","gap-2","pt-1"],["type","checkbox","formControlName","isDefault",1,"checkbox","checkbox-primary"],[1,"md:col-span-2","flex","justify-end","pt-1"],["type","submit",1,"btn","btn-primary","min-w-32",3,"disabled"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),o(4),t(),i(5,"p",3),o(6,"Completa los datos de facturaci\xF3n."),t()()(),i(7,"form",4),v("ngSubmit",function(){return s.save()}),i(8,"div",5)(9,"span",6),o(10,"Raz\xF3n social"),t(),l(11,"input",7),t(),i(12,"div",5)(13,"span",6),o(14,"Email"),t(),l(15,"input",8),t(),i(16,"div",5)(17,"span",6),o(18,"RUC"),t(),l(19,"input",9),t(),i(20,"div",5)(21,"span",6),o(22,"Tel\xE9fono"),t(),l(23,"input",10),t(),i(24,"div",5)(25,"span",6),o(26,"Pa\xEDs"),t(),l(27,"input",11),t(),i(28,"div",5)(29,"span",6),o(30,"Departamento"),t(),l(31,"input",12),t(),i(32,"div",13)(33,"span",6),o(34,"Direcci\xF3n"),t(),l(35,"input",14),t(),i(36,"div",5)(37,"span",6),o(38,"Ciudad"),t(),l(39,"input",15),t(),l(40,"div",16),i(41,"label",17),l(42,"input",18),i(43,"span",6),o(44,"Usar como perfil principal"),t()(),i(45,"div",19)(46,"button",20),o(47," Guardar "),t()()()()),e&2&&(a(4),b(s.editingId?"Editar facturaci\xF3n":"Nuevo perfil de facturaci\xF3n"),a(3),d("formGroup",s.form),a(4),d("ngClass",c(11,E,s.isInvalid("legalName"))),a(4),d("ngClass",c(13,E,s.isInvalid("email"))),a(4),d("ngClass",c(15,E,s.isInvalid("taxId"))),a(4),d("ngClass",c(17,E,s.isInvalid("phone"))),a(4),d("ngClass",c(19,E,s.isInvalid("country"))),a(4),d("ngClass",c(21,E,s.isInvalid("state"))),a(4),d("ngClass",c(23,E,s.isInvalid("addressLine1"))),a(4),d("ngClass",c(25,E,s.isInvalid("city"))),a(7),d("disabled",s.form.invalid||!s.hasChanges()||s.submitting()))},dependencies:[x,V,j,A,T,Q,L,P,R,B],styles:["[_nghost-%COMP%]{display:block}"]})};var se=r=>({"border-error focus:border-error":r}),ie=class r{fb=p(O);accountService=p(h);submitting=f(!1);form=this.fb.nonNullable.group({fullName:["",[m.required,m.minLength(2)]],email:["",[m.required,m.email]],phone:["",[m.required]]});initialValue=this.form.getRawValue();ngOnInit(){this.fetchProfile()}fetchProfile(){this.submitting.set(!0),this.accountService.getProfile().subscribe({next:n=>{this.form.patchValue({fullName:n.fullName??"",email:n.email??"",phone:n.phone??""}),this.updateInitialValue()},error:()=>this.submitting.set(!1),complete:()=>this.submitting.set(!1)})}save(){this.form.invalid||(this.submitting.set(!0),this.accountService.updateProfile(this.form.getRawValue()).subscribe({next:()=>{this.updateInitialValue(),this.submitting.set(!1)},error:()=>this.submitting.set(!1)}))}hasChanges(){return!this.isEqual(this.form.getRawValue(),this.initialValue)}updateInitialValue(){this.initialValue=this.form.getRawValue(),this.form.markAsPristine()}isEqual(n,e){let s=Object.keys(n);return s.length===Object.keys(e).length&&s.every(u=>n[u]===e[u])}isInvalid(n){let e=this.form.get(n);return!!e&&e.invalid&&(e.dirty||e.touched)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-user-profile"]],decls:22,vars:11,consts:[[1,"space-y-4"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","bg-base-200/60","rounded-lg","p-5","max-w-3xl",3,"ngSubmit","formGroup"],[1,"md:col-span-2","flex","flex-col","gap-2"],[1,"font-semibold"],["type","text","formControlName","fullName","placeholder","Tu nombre",1,"input","input-bordered","w-full","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"flex","flex-col","gap-2"],["type","email","formControlName","email","placeholder","tucorreo@mail.com",1,"input","input-bordered","w-full","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["type","text","formControlName","phone","placeholder","+595...",1,"input","input-bordered","w-full","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","justify-end","pt-1"],["type","submit",1,"btn","btn-primary","min-w-32",3,"disabled"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div")(2,"h2",1),o(3,"Mi perfil"),t(),i(4,"p",2),o(5,"Actualiza tus datos personales."),t()(),i(6,"form",3),v("ngSubmit",function(){return s.save()}),i(7,"div",4)(8,"span",5),o(9,"Nombre completo"),t(),l(10,"input",6),t(),i(11,"div",7)(12,"span",5),o(13,"Email"),t(),l(14,"input",8),t(),i(15,"div",7)(16,"span",5),o(17,"Tel\xE9fono"),t(),l(18,"input",9),t(),i(19,"div",10)(20,"button",11),o(21," Guardar "),t()()()()),e&2&&(a(6),d("formGroup",s.form),a(4),d("ngClass",c(5,se,s.isInvalid("fullName"))),a(4),d("ngClass",c(7,se,s.isInvalid("email"))),a(4),d("ngClass",c(9,se,s.isInvalid("phone"))),a(2),d("disabled",s.form.invalid||!s.hasChanges()||s.submitting()))},dependencies:[x,V,j,A,T,L,P,R,B],styles:["[_nghost-%COMP%]{display:block}"]})};var Le=(r,n)=>n.id;function Pe(r,n){r&1&&(i(0,"p"),o(1,"Cargando pedidos..."),t())}function Ae(r,n){r&1&&(i(0,"div",3)(1,"p"),o(2,"A\xFAn no tienes pedidos."),t(),i(3,"a",5),o(4,"Ver productos"),t()())}function Re(r,n){if(r&1&&(i(0,"li",13)(1,"span",14),o(2),t(),i(3,"span",15),o(4),t()()),r&2){let e=n.$implicit;a(2),b(e.name||"Producto"),a(2),$("x",e.quantity||1)}}function Be(r,n){if(r&1&&(i(0,"ul",12),N(1,Re,5,2,"li",13,ae),t()),r&2){let e=C().$implicit;a(),D(e.items)}}function Oe(r,n){if(r&1&&(i(0,"article",6)(1,"div",7)(2,"div")(3,"p",2),o(4),t(),i(5,"h3",8),o(6),t()(),i(7,"div",9)(8,"p",10),o(9),re(10,"guaranies"),t(),i(11,"p",11),o(12),re(13,"date"),t()()(),_(14,Be,3,0,"ul",12),t()),r&2){let e=n.$implicit;a(4),$("#",e.number||e.id),a(2),b(e.status||"Pendiente"),a(3),b(e.total?le(10,5,e.total):"\u2014"),a(3),b(de(13,7,e.createdAt,"short")),a(2),S(e.items!=null&&e.items.length?14:-1)}}function je(r,n){if(r&1&&(i(0,"div",4),N(1,Oe,15,10,"article",6,Le),t()),r&2){let e=C();a(),D(e.orders())}}var ne=class r{accountService=p(h);orders=f([]);loading=f(!0);ngOnInit(){this.loadOrders()}loadOrders(){this.loading.set(!0),this.accountService.getOrders(20,0).subscribe({next:n=>this.orders.set(n??[]),error:()=>this.orders.set([]),complete:()=>this.loading.set(!1)})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-user-recipes"]],decls:9,vars:1,consts:[[1,"space-y-4"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"text-base-content/70","space-y-3"],[1,"space-y-3"],["routerLink","/products",1,"btn","btn-primary","btn-sm"],[1,"p-4","border","border-base-300","rounded-lg","bg-base-100","shadow-sm"],[1,"flex","flex-wrap","items-center","justify-between","gap-2"],[1,"font-semibold","text-lg"],[1,"text-right"],[1,"font-semibold"],[1,"text-xs","text-base-content/70"],[1,"mt-3","space-y-2","text-sm","text-base-content/80"],[1,"flex","items-center","justify-between","gap-2"],[1,"truncate"],[1,"shrink-0","text-base-content/70"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div")(2,"h2",1),o(3,"Mis pedidos"),t(),i(4,"p",2),o(5,"Revisa tu historial de compras."),t()(),_(6,Pe,2,0,"p")(7,Ae,5,0,"div",3)(8,je,3,0,"div",4),t()),e&2&&(a(6),S(s.loading()?6:s.orders().length===0?7:8))},dependencies:[x,w,ce,fe],styles:["[_nghost-%COMP%]{display:block}"]})};var qe=[{path:"",component:W,children:[{path:"profile",component:ie},{path:"directions/new",component:ee},{path:"directions",component:Y},{path:"billing/new",component:te},{path:"billing",component:X},{path:"orders",component:ne},{path:"**",redirectTo:"profile"}]}],Ht=qe;export{Ht as default,qe as userRoutes};
