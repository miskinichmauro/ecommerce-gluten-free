import{$ as c,Aa as z,C as d,Ea as g,F as O,Fa as J,M as k,N as E,O as $,P as D,Q as l,R as f,T as x,U as N,V as I,W as L,X as R,Y as _,_ as T,ba as U,da as q,e as p,ea as S,f as j,g as v,i as s,ka as V,l as u,ma as A,na as M,o as a,p as w,q as F,ta as H,u as m,xa as B,z as C,za as Q}from"./chunk-ZQORN3D4.js";var K=class r{activateRoute=a(B);router=a(Q);currentPage=J(this.activateRoute.queryParamMap.pipe(v(e=>e.get("page")?+e.get("page"):1),v(e=>isNaN(e)?1:e)),{initialValue:1});setPage(e){this.router.navigate([],{queryParams:{page:e},queryParamsHandling:"merge"})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})};var h=`${g.baseUrl}/products`,ee={id:"new",title:"",price:0,unitOfMeasure:"",description:"",slug:"",stock:0,tags:[""],deleteAt:null,imagesName:[""],user:{}},b=class r{constructor(){}http=a(H);productsCache=new Map;productCache=new Map;getProducts(e={}){let{limit:t=12,offset:o=0,isFeatured:n=!1}=e,i=n?"isFeatured":`${t}-${o}`;return this.productsCache.has(i)?p(this.productsCache.get(i)):this.http.get(h,{params:{limit:t,offset:o,isFeatured:n},responseType:"json"}).pipe(s(Z=>this.productsCache.set(i,Z)))}getProductByIdSlug(e){return e==="new"?p(ee):this.productCache.has(e)?p(this.productCache.get(e)):this.http.get(`${h}/${e}`,{responseType:"json"}).pipe(s(o=>this.productCache.set(e,o)))}updateProduct(e,t){return this.http.patch(`${h}/${e}`,t).pipe(s(n=>this.insertOrUpdateProductCache(n)))}createProduct(e){return this.http.post(`${h}`,e).pipe(s(o=>this.insertOrUpdateProductCache(o)))}insertOrUpdateProductCache(e){this.productCache.get(e.id)?(this.productCache.set(e.id,e),this.productsCache.forEach(o=>{o.products=o.products.map(n=>n.id===e.id?e:n)})):(this.productCache.set(e.id,e),this.productCache.clear(),this.productsCache.clear())}static \u0275fac=function(t){return new(t||r)};static \u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})};function _e(){let r=a(b),e=m(null),t=m(!0),o=m(null);async function n(i){t.set(!0),o.set(null);try{let y=await j(r.getProducts(i));e.set(y)}catch{o.set("Error al cargar los productos")}finally{t.set(!1)}}return{productResponse:e,loading:t,error:o,loadProducts:n}}var re=()=>[],oe=r=>({page:r});function ne(r,e){if(r&1){let t=L();l(0,"button",3),R("click",function(){let n=w(t).$implicit,i=_();return F(i.activePage.set(n))}),c(1),f()}if(r&2){let t=e.$implicit,o=_();T("btn-primary",t===o.activePage()),D("routerLink",q(5,re))("queryParams",S(6,oe,t)),C(),U(" ",t," ")}}function ie(r,e){r&1&&(l(0,"button",2),c(1,"0"),f())}var X=class r{pages=M(0);currentPage=M(1);activePage=A(this.currentPage);getPagesList=V(()=>Array.from({length:this.pages()},(e,t)=>t+1));static \u0275fac=function(t){return new(t||r)};static \u0275cmp=d({type:r,selectors:[["pagination"]],inputs:{pages:[1,"pages"],currentPage:[1,"currentPage"]},decls:4,vars:1,consts:[[1,"join","flex","justify-center","items-center"],[1,"join-item","btn",3,"btn-primary","routerLink","queryParams"],[1,"join-item","btn"],[1,"join-item","btn",3,"click","routerLink","queryParams"]],template:function(t,o){t&1&&(l(0,"div",0),E(1,ne,2,8,"button",1,k,!1,ie,2,0,"button",2),f()),t&2&&(C(),$(o.getPagesList()))},dependencies:[z],styles:["[_nghost-%COMP%]{display:block}"]})};var G=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=d({type:r,selectors:[["loading"]],decls:4,vars:0,consts:[[1,"flex","flex-col","justify-center","items-center","min-h-[50vh]","gap-4"],[1,"loading","loading-spinner","loading-lg"]],template:function(t,o){t&1&&(x(0,"div",0),I(1,"span",1),x(2,"p"),c(3," Cargando... "),N()())},styles:["[_nghost-%COMP%]{display:block}"]})};var W=g.baseUrl,Y=class r{transform(e){if(typeof e=="string")return`${W}/files/product/${e}`;let t=e[0];return t?`${W}/files/product/${t}`:"https://www.foodnavigator.com/resizer/v2/3MET5T7L4JO25FVOXQDQ67EHOE.jpg?auth=d16d65b4d7f1ff6620ee4d54a2abb29750e275e5721fcd954f2aecd5a78ab6f7&smart=true"}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=O({name:"productImage",type:r,pure:!0})};export{Y as a,K as b,b as c,_e as d,X as e,G as f};
