import{$ as d,Aa as K,C as h,Ea as p,F,Fa as X,M as k,N as E,O as _,P as D,Q as g,R as C,T as w,U as N,V as L,W as T,X as q,Y as $,_ as S,ba as V,da as A,e as o,ea as H,f as I,g as R,i as n,ka as B,l as c,ma as z,na as j,o as s,p as M,q as U,ta as u,u as f,xa as Q,z as x,za as J}from"./chunk-ZQORN3D4.js";var G=class r{activateRoute=s(Q);router=s(J);currentPage=X(this.activateRoute.queryParamMap.pipe(R(e=>e.get("page")?+e.get("page"):1),R(e=>isNaN(e)?1:e)),{initialValue:1});setPage(e){this.router.navigate([],{queryParams:{page:e},queryParamsHandling:"merge"})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})};var b=`${p.baseUrl}/products`,ne={id:"new",title:"",price:0,unitOfMeasure:"",description:"",slug:"",stock:0,tags:[""],deleteAt:null,imagesName:[""],user:{}},P=class r{constructor(){}http=s(u);productsCache=new Map;productCache=new Map;getProducts(e={}){let{limit:t=12,offset:i=0,isFeatured:a=!1}=e,m=a?"isFeatured":`${t}-${i}`;return this.productsCache.has(m)?o(this.productsCache.get(m)):this.http.get(b,{params:{limit:t,offset:i,isFeatured:a},responseType:"json"}).pipe(n(ie=>this.productsCache.set(m,ie)))}getProductByIdSlug(e){return e==="new"?o(ne):this.productCache.has(e)?o(this.productCache.get(e)):this.http.get(`${b}/${e}`,{responseType:"json"}).pipe(n(i=>this.productCache.set(e,i)))}createProduct(e){return this.http.post(`${b}`,e).pipe(n(i=>this.insertOrUpdateCache(i)))}updateProduct(e,t){return this.http.patch(`${b}/${e}`,t).pipe(n(a=>this.insertOrUpdateCache(a)))}insertOrUpdateCache(e){this.productCache.get(e.id)?(this.productCache.set(e.id,e),this.productsCache.forEach(i=>{i.products=i.products.map(a=>a.id===e.id?e:a)})):(this.productCache.clear(),this.productsCache.clear())}static \u0275fac=function(t){return new(t||r)};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})};function Me(){let r=s(P),e=f(null),t=f(!0),i=f(null);async function a(m){t.set(!0),i.set(null);try{let O=await I(r.getProducts(m));e.set(O)}catch{i.set("Error al cargar los productos")}finally{t.set(!1)}}return{productResponse:e,loading:t,error:i,loadProducts:a}}var ae=()=>[],se=r=>({page:r});function ce(r,e){if(r&1){let t=T();g(0,"button",3),q("click",function(){let a=M(t).$implicit,m=$();return U(m.activePage.set(a))}),d(1),C()}if(r&2){let t=e.$implicit,i=$();S("btn-primary",t===i.activePage()),D("routerLink",A(5,ae))("queryParams",H(6,se,t)),x(),V(" ",t," ")}}function pe(r,e){r&1&&(g(0,"button",2),d(1,"0"),C())}var W=class r{pages=j(0);currentPage=j(1);activePage=z(this.currentPage);getPagesList=B(()=>Array.from({length:this.pages()},(e,t)=>t+1));static \u0275fac=function(t){return new(t||r)};static \u0275cmp=h({type:r,selectors:[["pagination"]],inputs:{pages:[1,"pages"],currentPage:[1,"currentPage"]},decls:4,vars:1,consts:[[1,"join","flex","justify-center","items-center"],[1,"join-item","btn",3,"btn-primary","routerLink","queryParams"],[1,"join-item","btn"],[1,"join-item","btn",3,"click","routerLink","queryParams"]],template:function(t,i){t&1&&(g(0,"div",0),E(1,ce,2,8,"button",1,k,!1,pe,2,0,"button",2),C()),t&2&&(x(),_(i.getPagesList()))},dependencies:[K],styles:["[_nghost-%COMP%]{display:block}"]})};var Y=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=h({type:r,selectors:[["loading"]],decls:4,vars:0,consts:[[1,"flex","flex-col","justify-center","items-center","min-h-[50vh]","gap-4"],[1,"loading","loading-spinner","loading-lg"]],template:function(t,i){t&1&&(w(0,"div",0),L(1,"span",1),w(2,"p"),d(3," Cargando... "),N()())},styles:["[_nghost-%COMP%]{display:block}"]})};var v=`${p.baseUrl}/recipes`,me={id:"new",title:"",text:""},Z=class r{http=s(u);recipesCache=new Map;getRecipes(){return this.recipesCache.size?o(Array.from(this.recipesCache.values())):this.http.get(v).pipe(n(e=>e.forEach(t=>this.recipesCache.set(t.id,t))))}getRecipeById(e){return e==="new"?o(me):this.recipesCache.has(e)?o(this.recipesCache.get(e)):this.http.get(`${v}/${e}`).pipe(n(t=>this.recipesCache.set(e,t)))}createRecipe(e){return this.http.post(v,e).pipe(n(t=>this.insertOrUpdateCache(t)))}updateRecipe(e,t){return this.http.patch(`${v}/${e}`,t).pipe(n(i=>this.insertOrUpdateCache(i)))}insertOrUpdateCache(e){let t=this.recipesCache.get(e.id);console.log(t),t?this.recipesCache.set(e.id,e):this.recipesCache.clear()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})};var y=`${p.baseUrl}/contacts`,ue={id:"new",title:"",phone:"",email:""},ee=class r{http=s(u);contactsCache=new Map;getContacts(){return this.contactsCache.size?o(Array.from(this.contactsCache.values())):this.http.get(y).pipe(n(e=>e.forEach(t=>this.contactsCache.set(t.id,t))))}getContactById(e){return e==="new"?o(ue):this.contactsCache.has(e)?o(this.contactsCache.get(e)):this.http.get(`${y}/${e}`).pipe(n(t=>this.contactsCache.set(e,t)))}createContact(e){return this.http.post(y,e).pipe(n(t=>this.insertOrUpdateCache(t)))}updateContact(e,t){return this.http.patch(`${y}/${e}`,t).pipe(n(i=>this.insertOrUpdateCache(i)))}insertOrUpdateCache(e){this.contactsCache.get(e.id)?this.contactsCache.set(e.id,e):this.contactsCache.clear()}static \u0275fac=function(t){return new(t||r)};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})};var te=p.baseUrl,re=class r{transform(e){if(typeof e=="string")return`${te}/files/product/${e}`;let t=e[0];return t?`${te}/files/product/${t}`:"https://www.foodnavigator.com/resizer/v2/3MET5T7L4JO25FVOXQDQ67EHOE.jpg?auth=d16d65b4d7f1ff6620ee4d54a2abb29750e275e5721fcd954f2aecd5a78ab6f7&smart=true"}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=F({name:"productImage",type:r,pure:!0})};export{re as a,G as b,P as c,Me as d,W as e,Y as f,Z as g,ee as h};
