<section class="recipes-layout space-y-5 mt-6">
  <div class="card bg-base-100 shadow-md hover:shadow-lg transition-shadow duration-300 rounded-2xl">
    <div class="card-body flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
      <div>
        <h1 class="text-3xl font-bold mb-1">Recetas</h1>
        <p class="text-sm text-base-content/60">Explora y filtra para encontrar lo que quieras cocinar hoy.</p>
      </div>
      <div class="text-sm text-base-content/70 flex items-center gap-2">
        <span>Total de recetas</span>
        <span class="font-semibold text-base-content">{{ total() }}</span>
      </div>
    </div>
  </div>

  @if (searchTerms().length || visibleMatchedIngredients().length) {
    <div class="mt-4 space-y-4 border border-base-200 bg-base-100/50 rounded-2xl p-4 shadow-sm">
      @if (searchTerms().length) {
        <div>
          <p class="text-xs font-semibold uppercase tracking-wide text-base-content/60 mb-2">Texto buscado</p>
          <div class="flex flex-wrap gap-2">
            @for (term of searchTerms(); track term) {
              <button type="button" class="chip-pill" (click)="removeSearchTerm(term)">
                <span class="truncate">{{ term }}</span>
                <span class="inline-flex items-center justify-center shrink-0">
                  <x-circle />
                </span>
              </button>
            }
          </div>
        </div>
      }

      @if (visibleMatchedIngredients().length) {
        <div>
          <div class="flex items-center justify-between gap-4">
            <p class="text-xs font-semibold uppercase tracking-wide text-base-content/60 mb-2">Ingredientes</p>
            <button
              type="button"
              class="text-xs cursor-pointer text-primary font-semibold underline hover:text-primary-focus"
              (click)="resetFilters()"
            >
              Limpiar
            </button>
          </div>
          <div class="flex flex-wrap gap-2">
            @for (ingredient of visibleMatchedIngredients(); track ingredient) {
              <button type="button" class="chip-pill" (click)="removeMatchedIngredient(ingredient)">
                <span class="truncate">{{ ingredient }}</span>
                <span class="inline-flex items-center justify-center shrink-0">
                  <x-circle />
                </span>
              </button>
            }
          </div>
        </div>
      }
    </div>
  }

  @if (loading()) {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 mt-6">
      @for (placeholder of [1, 2, 3]; track placeholder) {
        <recipe-skeleton />
      }
    </div>
  }

  @if (error()) {
    <p class="text-red-500">{{ error() }}</p>
  }

  @if (!loading() && !error() && recipes()?.length) {
    <div class="grid grid-cols-1 mt-6 gap-4 sm:gap-5 md:gap-6">
      @for (recipe of recipes(); track $index) {
        <recipe-card [recipe]="recipe" />
      }
    </div>
  }

  @if (!loading() && readyToShowEmpty() && !error() && (!recipes()?.length || recipes()?.length === 0)) {
    <p>No se encontraron recetas</p>
  }
</section>
