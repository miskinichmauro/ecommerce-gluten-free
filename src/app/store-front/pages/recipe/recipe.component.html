<h1 class="text-3xl font-bold mb-2 mt-6">Recetas</h1>

<section class="recipes-layout">
  <div class="inline-flex items-center gap-3 text-base-content">
    <span class="inline-flex items-center gap-2">
      Total de recetas
      <span class="font-bold">{{ total() }}</span>
    </span>
  </div>

  @if (searchTextRaw() || queryIngredients().length) {
    <div class="mt-4 space-y-4 border border-base-200 bg-base-100/50 rounded-2xl p-4 shadow-sm">
      @if (searchTextRaw()) {
        <div>
          <p class="text-xs font-semibold uppercase tracking-wide text-base-content/60 mb-2">Texto buscado</p>
          <div class="flex flex-wrap gap-2">
            <button type="button" class="chip-pill" (click)="clearSearchTextOnly()">
              <span class="truncate">{{ searchTextRaw() }}</span>
              <span class="inline-flex items-center justify-center shrink-0">
                <x-circle />
              </span>
            </button>
          </div>
        </div>
      }
      @if (queryIngredients().length) {
        <div>
          <div class="flex items-center justify-between gap-4">
            <p class="text-xs font-semibold uppercase tracking-wide text-base-content/60 mb-2">Ingredientes</p>
            <button
              type="button"
              class="text-xs cursor-pointer text-primary font-semibold underline hover:text-primary-focus"
              (click)="clearIngredients()"
            >
              Limpiar
            </button>
          </div>
          <div class="flex flex-wrap gap-2">
            @for (ing of queryIngredients(); track ing) {
              <button type="button" class="chip-pill" (click)="removeIngredient(ing)">
                <span class="truncate">{{ ing }}</span>
                <span class="inline-flex items-center justify-center shrink-0">
                  <x-circle />
                </span>
              </button>
            }
          </div>
        </div>
      }
    </div>
  }

  @if (loading()) {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 mt-6">
      @for (placeholder of [1, 2, 3]; track placeholder) {
        <recipe-skeleton />
      }
    </div>
  }

  @if (error()) {
    <p class="text-red-500">{{ error() }}</p>
  }

  @if (!loading() && !error() && recipes()?.length) {
    <div class="grid grid-cols-1 mt-6 gap-4 sm:gap-5 md:gap-6">
      @for (recipe of recipes(); track $index) {
        <recipe-card [recipe]="recipe" />
      }
    </div>
  }

  @if (!loading() && readyToShowEmpty() && !error() && (!recipes()?.length || recipes()?.length === 0)) {
    <p>No se encontraron recetas</p>
  }
</section>
