<div class="navbar bg-base-100 shadow-sm sticky top-0 z-40">
  <div class="navbar-start mx-3">
    <app-logo />
  </div>

  <div class="navbar-center w-full max-w-2xl px-3">
    <div class="relative w-full hidden sm:block" #suggestContainer>
      <form class="w-full" (submit)="onSubmit($event)">
        <label class="input w-full">
          <input
            type="text"
            [formControl]="searchControl"
            placeholder="Buscar productos..."
            class="grow"
            aria-label="Buscar productos"
            (keydown.escape)="closeSuggestions()"
            (keydown)="onKeyDown($event)"
          />
        </label>
      </form>

      @if (suggestions.length > 0) {
        <ul
          class="absolute top-[105%] w-full bg-base-100 shadow-lg rounded-lg border border-base-300 z-9999 p-2 flex flex-col gap-1"
        >
          @for (item of suggestions; track $index; let i = $index) {
            <li
              (click)="selectSuggestion(item)"
              class="cursor-pointer p-2 rounded-md flex justify-between"
              [class.bg-primary/20]="i === activeIndex"
              [class.text-primary]="i === activeIndex"
            >
              <span>{{ item.title }}</span>
              <span class="opacity-70">{{ item.price | guaranies }}</span>
            </li>
          }

          <li
            class="text-center text-sm text-primary cursor-pointer hover:bg-base-200 p-2 rounded-md"
            (click)="performSearch(searchControl.value!)"
          >
            Ver todos los resultados â†’
          </li>
        </ul>
      }
    </div>
  </div>

  <div class="navbar-end gap-2 mx-3">
    <label class="sm:hidden p-2 rounded-full" aria-label="Buscar" role="button" aria-controls="mobile-search-toggle-end" for="mobile-search-toggle-end" (click)="openMobileSearch()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
        <path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd" />
      </svg>
    </label>
    <div class="sm:hidden">
      <input id="mobile-search-toggle-end" #mobileSearchToggle type="checkbox" class="peer hidden" (change)="onMobileToggleEnd($event)" />
      <label for="mobile-search-toggle-end" class="fixed inset-0 bg-black/40 z-40 opacity-0 pointer-events-none peer-checked:opacity-100 peer-checked:pointer-events-auto">

      </label>
      <div class="fixed top-0 inset-x-0 z-50 bg-base-100 shadow-md -translate-y-full transition-transform duration-200 peer-checked:translate-y-0">
        <div class="p-2">
          <form (submit)="onSubmit($event)">
            <label class="input w-full">
              <input #mobileSearchInput type="text" [formControl]="searchControl" placeholder="Buscar..." class="w-full" aria-label="Buscar" />
            </label>
          </form>
        </div>
      </div>
    </div>
    <nav-user-options />
  </div>
</div>


