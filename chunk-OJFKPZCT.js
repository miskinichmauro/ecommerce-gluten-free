import{a as G,b as Z,c as q}from"./chunk-I7QOAKR5.js";import{b as T,c as u,d as M,e as F,g as R,j as L,k as D,n as k,p as A}from"./chunk-KIYFELFV.js";import{$ as m,A as f,B as w,Ba as y,C as h,D as x,E as H,H as g,O as s,R as _,W as j,_a as z,ba as d,ga as b,ha as r,ia as a,ja as c,ka as S,la as V,ma as B,mb as N,na as E,pa as C,qa as O,ra as p,ub as P,za as l}from"./chunk-6H3SXBKT.js";function W(i,t){i&1&&(x(),S(0,"svg",1),B(1,"path",2)(2,"path",3),V())}function X(i,t){i&1&&(x(),S(0,"svg",1),B(1,"path",4)(2,"path",5)(3,"path",6),V())}var v=class i{visible=!1;toggleVisibility=new j;onToggle(){this.toggleVisibility.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=_({type:i,selectors:[["password-toggle"]],inputs:{visible:"visible"},outputs:{toggleVisibility:"toggleVisibility"},decls:3,vars:1,consts:[["type","button","aria-label","Mostrar u ocultar contrasena",1,"absolute","inset-y-0","right-3","flex","items-center","text-slate-500","hover:text-slate-700","transition-colors","cursor-pointer","z-10",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"w-5","h-5"],["d","M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"],["fill-rule","evenodd","d","M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z","clip-rule","evenodd"],["d","M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z"],["d","M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z"],["d","M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z"]],template:function(e,o){e&1&&(S(0,"button",0),O("click",function(){return o.onToggle()}),m(1,W,3,0,":svg:svg",1)(2,X,4,0,":svg:svg",1),V()),e&2&&(s(),d(o.visible?1:2))},dependencies:[z],styles:["[_nghost-%COMP%]{display:contents}"]})};function $(i,t){i&1&&c(0,"loading")}function ee(i,t){i&1&&c(0,"success")}function te(i,t){if(i&1&&(r(0,"div",3),l(1),a()),i&2){let e=p(2);s(),y(" ",e.hasError()," ")}}function ie(i,t){if(i&1){let e=E();r(0,"form",1),C("ngSubmit",function(){w(e);let n=p();return h(n.onSubmit())}),r(1,"fieldset",2),m(2,te,2,1,"div",3),r(3,"div",4)(4,"label",5),l(5,"Email"),a(),c(6,"input",6),r(7,"label",7),l(8,"Password"),a(),r(9,"div",8),c(10,"input",9),r(11,"password-toggle",10),C("toggleVisibility",function(){w(e);let n=p();return h(n.togglePasswordVisibility())}),a()(),r(12,"div",11)(13,"button",12),C("click",function(){w(e);let n=p();return h(n.openRegister())}),l(14," Registrarme "),a()(),r(15,"button",13),l(16," Login "),a()()()()}if(i&2){let e=p();b("formGroup",e.loginForm),s(2),d(e.hasError()?2:-1),s(8),b("type",e.passwordVisible()?"text":"password"),s(),b("visible",e.passwordVisible())}}var K=class i{authService=f(P);configurationService=f(G);fb=f(k);router=f(N);loading=g(!1);hasError=g(null);success=g(!1);passwordVisible=g(!1);loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(6)]]});openRegister(){this.configurationService.openSidebar("register")}togglePasswordVisibility(){this.passwordVisible.update(t=>!t)}onSubmit(){if(this.loginForm.invalid){this.hasError.set("Completa los campos requeridos"),setTimeout(()=>this.hasError.set(null),2e3);return}let{email:t="",password:e=""}=this.loginForm.value;this.loading.set(!0),this.authService.login(t,e).subscribe({next:async o=>{if(o){await this.isSuccess();return}this.loading.set(!1),this.setErrorMessage("No se pudo iniciar sesion")},error:o=>{this.loading.set(!1);let n=o?.error?.expose?o.error?.message:"Las credenciales no son validas";this.setErrorMessage(n)}})}async isSuccess(){this.loading.set(!1),this.success.set(!0),await new Promise(t=>setTimeout(t,800)),this.configurationService.toggleSidebarPageStatus("closed"),this.configurationService.toggleSidebarItemsStatus("closed")}setErrorMessage(t){this.hasError.set(t),setTimeout(()=>this.hasError.set(null),4e3)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=_({type:i,selectors:[["login"]],decls:3,vars:3,consts:[[1,"gap-2",3,"formGroup"],[1,"gap-2",3,"ngSubmit","formGroup"],[1,"fieldset","bg-base-200","border-base-300","rounded-box","w-full","p-6"],[1,"text-error","text-sm","mb-3"],[1,"flex","flex-col","gap-4"],["for","email",1,"label"],["type","email","placeholder","Email","formControlName","email",1,"input","w-full"],["for","password",1,"label"],[1,"relative"],["placeholder","Password","formControlName","password",1,"input","w-full","pr-12",3,"type"],[3,"toggleVisibility","visible"],[1,"w-full","flex","justify-end"],["type","button",1,"text-primary","hover:underline","cursor-pointer",3,"click"],[1,"btn","btn-neutral","w-full"]],template:function(e,o){e&1&&(m(0,$,1,0,"loading"),m(1,ee,1,0,"success"),m(2,ie,17,4,"form",0)),e&2&&(d(o.loading()?0:-1),s(),d(o.success()?1:-1),s(),d(!o.loading()&&!o.success()?2:-1))},dependencies:[A,R,T,M,F,L,D,Z,q,v],styles:["[_nghost-%COMP%]{display:block}"]})};function oe(i,t){i&1&&c(0,"loading")}function ne(i,t){i&1&&c(0,"success")}function re(i,t){i&1&&(r(0,"div",1),l(1," La contrase\xF1a debe tener al menos una letra may\xFAscula, una min\xFAscula y un n\xFAmero. "),a())}function se(i,t){i&1&&(r(0,"div",1),l(1," Las contrase\xF1as no coinciden "),a())}function ae(i,t){if(i&1){let e=E();r(0,"form",2),C("ngSubmit",function(){w(e);let n=p();return h(n.onSubmit())}),r(1,"fieldset",3)(2,"button",4),C("click",function(){w(e);let n=p();return h(n.goBack())}),x(),r(3,"svg",5),c(4,"path",6),a()(),H(),r(5,"div",7)(6,"label",8),l(7,"Nombre completo"),a(),c(8,"input",9),r(9,"label",10),l(10,"Email"),a(),c(11,"input",11),r(12,"label",12),l(13,"Password"),a(),r(14,"div",13),c(15,"input",14),r(16,"password-toggle",15),C("toggleVisibility",function(){w(e);let n=p();return h(n.togglePasswordVisibility())}),a()(),m(17,re,2,0,"div",1),r(18,"label",16),l(19,"Confirmar password"),a(),r(20,"div",13),c(21,"input",17),r(22,"password-toggle",15),C("toggleVisibility",function(){w(e);let n=p();return h(n.toggleConfirmPasswordVisibility())}),a()(),r(23,"button",18),l(24,"Login"),a(),m(25,se,2,0,"div",1),a()()()}if(i&2){let e,o,n=p();b("formGroup",n.registerForm),s(15),b("type",n.passwordVisible()?"text":"password"),s(),b("visible",n.passwordVisible()),s(),d((e=n.registerForm.get("password"))!=null&&e.hasError("weakPassword")&&((e=n.registerForm.get("password"))!=null&&e.touched)?17:-1),s(4),b("type",n.confirmPasswordVisible()?"text":"password"),s(),b("visible",n.confirmPasswordVisible()),s(3),d(n.registerForm.hasError("passwordMismatch")&&((o=n.registerForm.get("confirmPassword"))!=null&&o.touched)?25:-1)}}function le(i,t){if(i&1&&(r(0,"div",1),l(1),a()),i&2){let e=p();s(),y(" ",e.hasError()," ")}}var Q=class i{fb=f(k);hasError=g(null);loading=g(!1);success=g(!1);router=f(N);authService=f(P);configurationService=f(G);passwordVisible=g(!1);confirmPasswordVisible=g(!1);passwordsMatchValidator=t=>{let e=t.get("password")?.value,o=t.get("confirmPassword")?.value;return e===o?null:{passwordMismatch:!0}};passwordStrengthValidator=t=>{let e=t.value;if(!e)return null;let o=/[A-Z]/.test(e),n=/[a-z]/.test(e),I=/[0-9]/.test(e);return o&&n&&I?null:{weakPassword:!0}};registerForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(6),this.passwordStrengthValidator]],confirmPassword:["",[u.required]],fullName:["",[u.required,u.minLength(1)]]},{validators:this.passwordsMatchValidator});onSubmit(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched(),this.hasError.set("Completa los campos requeridos"),setTimeout(()=>this.hasError.set(null),2e3);return}let{email:t="",password:e="",fullName:o=""}=this.registerForm.value;this.loading.set(!0),this.authService.register(t,e,o).subscribe({next:async n=>{if(n){await this.showSuccess(),this.router.navigateByUrl("/");return}this.loading.set(!1),this.setError("No se pudo crear la cuenta")},error:n=>{this.loading.set(!1);let I=n?.error?.expose?n.error?.message:"No se pudo crear la cuenta";this.setError(I)}})}async showSuccess(){this.loading.set(!1),this.success.set(!0),await new Promise(t=>setTimeout(t,800)),this.configurationService.toggleSidebarPageStatus("closed"),this.configurationService.toggleSidebarItemsStatus("closed")}setError(t){this.hasError.set(t),setTimeout(()=>this.hasError.set(null),4e3)}togglePasswordVisibility(){this.passwordVisible.update(t=>!t)}toggleConfirmPasswordVisibility(){this.confirmPasswordVisible.update(t=>!t)}goBack(){this.configurationService.sidebarPageStatus()==="open"?this.configurationService.openSidebar("auth"):this.router.navigate(["/auth/login"])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=_({type:i,selectors:[["app-register"]],decls:4,vars:4,consts:[[1,"gap-2",3,"formGroup"],[1,"text-error","text-sm","mt-1"],[1,"gap-2",3,"ngSubmit","formGroup"],[1,"fieldset","bg-base-200","border-base-300","rounded-box","w-full","p-6","relative"],["type","button",1,"inline-flex","items-center","justify-center","p-2","rounded-full","transition-colors","duration-200","hover:bg-base-300","text-slate-700","absolute","top-4","left-6","bg-base-200","cursor-pointer","shadow",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"h-4","w-4"],["fill-rule","evenodd","d","M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z","clip-rule","evenodd"],[1,"flex","flex-col","gap-4","mt-10"],["for","fullName",1,"label"],["type","fullName","placeholder","Nombre completo","formControlName","fullName",1,"input","w-full"],["for","email",1,"label"],["type","email","placeholder","Email","formControlName","email",1,"input","w-full"],["for","password",1,"label"],[1,"relative"],["placeholder","Password","formControlName","password",1,"input","w-full","pr-12",3,"type"],[3,"toggleVisibility","visible"],["for","confirmPassword",1,"label"],["placeholder","Repite tu password","formControlName","confirmPassword",1,"input","w-full","pr-12",3,"type"],[1,"btn","btn-neutral","w-full"]],template:function(e,o){e&1&&(m(0,oe,1,0,"loading"),m(1,ne,1,0,"success"),m(2,ae,26,7,"form",0),m(3,le,2,1,"div",1)),e&2&&(d(o.loading()?0:-1),s(),d(o.success()?1:-1),s(),d(!o.loading()&&!o.success()&&!o.hasError()?2:-1),s(),d(o.hasError()?3:-1))},dependencies:[A,R,T,M,F,L,D,Z,q,v],styles:["[_nghost-%COMP%]{display:block}"]})};export{K as a,Q as b};
