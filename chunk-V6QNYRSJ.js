import{a as It,c as Ft,d as Mt,e as he,f as we,g as Ve,h as De,i as Nt,j as Rt,k as Lt,l as At,m as Ee}from"./chunk-5LGFMTZU.js";import{a as Tt,b as ie,c as P,d as ne,e as oe,g as re,h as Pt,j as ae,k as se,n as le,o as ce,p as pe,q as N,r as kt}from"./chunk-ZFQKFX5O.js";import{$ as U,$a as de,Aa as Ie,Ba as ht,C as g,Ca as _t,Fa as Y,G as ke,Ga as $,H as Ct,I as L,Ia as S,J as a,Ja as xt,M as u,Ma as St,Na as wt,Pa as fe,R as j,Ua as ee,Va as Dt,W as h,Wa as M,Xa as w,Y as v,Ya as Et,a as Q,aa as O,ab as te,b as vt,ba as p,bb as Ae,ca as o,da as r,ea as c,fa as _e,g as B,ga as xe,h as C,i as H,ia as I,j as bt,ka as f,la as ft,ma as b,n as z,na as W,oa as J,p as R,pa as X,qa as Le,ra as yt,s as ue,sa as F,ta as l,ua as y,v as d,va as k,w as E,x as T,y as Z,ya as q,z as ge,za as V}from"./chunk-HVAOKWIU.js";var Vt=async()=>{let i=d(Ae);return await C(i.checkStatus()),i.isAdmin()};var Ut=[{label:"Inicio",routerLink:"/",adminOnly:!0},{label:"Dashboard",routerLink:"/admin/dashboard",adminOnly:!0},{label:"Productos",routerLink:"/admin/products",adminOnly:!0},{label:"Categor\xEDas",routerLink:"/admin/categories",adminOnly:!0},{label:"Tags",routerLink:"/admin/tags",adminOnly:!0},{label:"Recetas",routerLink:"/admin/recipes",adminOnly:!0},{label:"Contacto",routerLink:"/admin/contacts",adminOnly:!0},{label:"Usuarios",routerLink:"/admin/users",adminOnly:!0}];function Qt(i,e){i&1&&c(0,"loading",1)}function Zt(i,e){i&1&&c(0,"success",1)}var Ue=class i{toastService=d(he);loading=this.toastService.loading;success=this.toastService.success;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["toast"]],decls:3,vars:2,consts:[[1,"relative"],[1,"fixed","bottom-4","right-4"]],template:function(t,n){t&1&&(o(0,"div",0),h(1,Qt,1,0,"loading",1),h(2,Zt,1,0,"success",1),r()),t&2&&(a(),v(n.loading()?1:-1),a(),v(n.success()?2:-1))},dependencies:[kt,N],styles:["[_nghost-%COMP%]{display:block}"]})};function Wt(i,e){if(i&1){let t=I();o(0,"div",2),c(1,"sidebar-items",4),o(2,"div",5)(3,"button",6),f("click",function(){E(t);let s=b();return T(s.configurationService.toggleSidebarItemsStatus("open"))}),Z(),o(4,"svg",7),c(5,"path",8),r()(),ge(),c(6,"app-logo"),r(),o(7,"div",9),c(8,"router-outlet"),r()()}if(i&2){let t=b();a(),p("menuItems",t.menuItems)}}function Jt(i,e){if(i&1){let t=I();o(0,"div",3)(1,"div",10)(2,"div",11)(3,"div",12),c(4,"app-logo"),o(5,"p",13),l(6,"Panel administrativo"),r()(),o(7,"div",14)(8,"p",15),l(9,"Bienvenido"),r(),o(10,"a",16)(11,"span",17),l(12),r()()(),o(13,"div",18)(14,"a",19)(15,"div"),Z(),o(16,"svg",20),c(17,"path",21),r()(),ge(),o(18,"div",22)(19,"span",23),l(20,"Dashboard"),r(),o(21,"span",24),l(22,"Data Overview"),r()()(),o(23,"a",25)(24,"div"),Z(),o(25,"svg",26),c(26,"path",27),r()(),ge(),o(27,"div",22)(28,"span",28),l(29,"Productos"),r(),o(30,"span",29),l(31,"Listado de productos"),r()()(),o(32,"a",30)(33,"div"),Z(),o(34,"svg",26),c(35,"path",31)(36,"path",32),r()(),ge(),o(37,"div",22)(38,"span",28),l(39,"Categor\xEDas"),r(),o(40,"span",29),l(41,"Listado de categor\xEDas"),r()()(),o(42,"a",33)(43,"div"),Z(),o(44,"svg",26),c(45,"path",34)(46,"path",35),r()(),ge(),o(47,"div",22)(48,"span",28),l(49,"Tags"),r(),o(50,"span",29),l(51,"Listado de tags"),r()()(),o(52,"a",36)(53,"div"),Z(),o(54,"svg",37),c(55,"path",38),r()(),ge(),o(56,"div",22)(57,"span",28),l(58,"Recetas"),r(),o(59,"span",29),l(60,"Listado de recetas"),r()()(),o(61,"a",39)(62,"div"),Z(),o(63,"svg",37),c(64,"path",40),r()(),ge(),o(65,"div",22)(66,"span",28),l(67,"Contactos"),r(),o(68,"span",29),l(69,"Listado de contactos"),r()()(),o(70,"div")(71,"div")(72,"a",41),f("click",function(){E(t);let s=b();return T(s.toggleUserMenu())}),o(73,"div",42)(74,"div",43),Z(),o(75,"svg",44),c(76,"path",45),r(),ge(),o(77,"div",22)(78,"span",28),l(79,"Usuarios"),r(),o(80,"span",29),l(81,"Opciones"),r()()(),Z(),o(82,"svg",46),c(83,"path",47),r()()(),ge(),o(84,"div",48,0)(86,"a",49),l(87,"Usuarios"),r(),o(88,"a",50),l(89,"Roles"),r()()()()()()(),o(90,"div",51),c(91,"router-outlet"),r()()}if(i&2){let t,n=Le(85),s=b();a(12),k(" ",(t=s.user())==null?null:t.fullName," "),a(70),F("rotate-90",s.userMenuOpen),a(2),yt("max-height",s.userMenuOpen?n.scrollHeight+"px":"0")}}var Oe=class i{authService=d(Ae);configurationService=d(pe);user=Y(()=>this.authService.user());menuItems=Ut;isMobile=!1;userMenuOpen=!1;ngOnInit(){this.onResize()}onResize(){this.isMobile=window.innerWidth<1024}toggleUserMenu(){this.userMenuOpen=!this.userMenuOpen}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["app-admin-dashboard-layout"]],hostBindings:function(t,n){t&1&&f("resize",function(){return n.onResize()},Ct)},decls:4,vars:1,consts:[["userMenuContent",""],["data-theme","coffee",1,"min-h-screen","bg-gray-950","text-slate-100"],[1,"flex","flex-col","gap-4","min-h-screen","bg-gray-900/90","p-4","text-slate-100"],[1,"bg-slate-800","overflow-y-scroll","overflow-x-hidden","w-full","h-screen","antialiased","text-slate-300","selection:bg-blue-600","selection:text-white"],[3,"menuItems"],[1,"flex","items-center","justify-between","bg-gray-800/70","rounded-xl","px-4","py-2","shadow"],[1,"btn","btn-ghost","text-slate-100","lg:hidden",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h8m-8 6h16"],[1,"flex-1","px-5","py-4","bg-gray-800/70","rounded-2xl","shadow-inner"],[1,"flex","flex-col","relative","w-full","max-w-full"],["id","menu",1,"bg-gray-900","min-h-screen","z-10","text-slate-300","w-64","fixed","left-0","h-screen","overflow-y-scroll"],[1,"my-5","px-5"],[1,"text-slate-500","text-sm"],["id","profile",1,"px-6","py-4"],[1,"text-slate-500"],["routerLink","/admin/products",1,"inline-flex","space-x-2","items-center"],[1,"text-sm","md:text-base","font-bold"],["id","nav",1,"w-full","px-6"],["routerLink","/admin/products",1,"w-full","px-2","inline-flex","space-x-2","items-center","border-b","border-slate-700","py-3","hover:bg-white/5","transition","ease-linear","duration-150"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-6","h-6","text-white"],["stroke-linecap","round","stroke-linejoin","round","d","M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"],[1,"flex","flex-col"],[1,"text-lg","font-bold","leading-5","text-white"],[1,"text-sm","text-white/50","hidden","md:block"],["routerLink","/admin/products","routerLinkActive","bg-blue-800",1,"w-full","px-2","inline-flex","space-x-2","items-center","border-b","border-slate-700","py-3","hover:bg-white/5","transition","ease-linear","duration-150"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","d","M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"],[1,"text-lg","text-slate-300","font-bold","leading-5"],[1,"text-sm","text-slate-500","hidden","md:block"],["routerLink","/admin/categories","routerLinkActive","bg-blue-800",1,"w-full","px-2","inline-flex","space-x-2","items-center","border-b","border-slate-700","py-3","hover:bg-white/5","transition","ease-linear","duration-150"],["stroke-linecap","round","stroke-linejoin","round","d","M6.633 10.5c.806 0 1.533.446 2.031 1.08a9.041 9.041 0 0 1 2.861-.48c.986 0 1.957.168 2.862.48.498-.634 1.225-1.08 2.03-1.08h.009c1.657 0 3 1.567 3 3.5 0 1.934-1.343 3.5-3 3.5-.806 0-1.533-.446-2.031-1.08a9.041 9.041 0 0 1-2.861.48 9.04 9.04 0 0 1-2.862-.48c-.498.634-1.225 1.08-2.03 1.08h-.01c-1.656 0-3-1.566-3-3.5 0-1.933 1.344-3.5 3-3.5Z"],["stroke-linecap","round","stroke-linejoin","round","d","M3 5a1.5 1.5 0 0 1 1.5-1.5h15A1.5 1.5 0 0 1 21 5v1.5H3V5Z"],["routerLink","/admin/tags","routerLinkActive","bg-blue-800",1,"w-full","px-2","inline-flex","space-x-2","items-center","border-b","border-slate-700","py-3","hover:bg-white/5","transition","ease-linear","duration-150"],["stroke-linecap","round","stroke-linejoin","round","d","M9.813 15.904 9 18.75l-.813-2.846a1 1 0 0 0-.641-.64L4.5 14.25l2.846-.813a1 1 0 0 0 .641-.641L9 10.5l1.013 2.296a1 1 0 0 0 .641.64l2.846.813-2.846.704a1 1 0 0 0-.641.64Z"],["stroke-linecap","round","stroke-linejoin","round","d","M16.5 18.75V5.25m-12 0h15"],["routerLink","/admin/recipes","routerLinkActive","bg-blue-800",1,"w-full","px-2","inline-flex","space-x-2","items-center","border-b","border-slate-700","py-3","hover:bg-white/5","transition","ease-linear","duration-150"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-6"],["stroke-linecap","round","stroke-linejoin","round","d","M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"],["routerLink","/admin/contacts","routerLinkActive","bg-blue-800",1,"w-full","px-2","inline-flex","space-x-2","items-center","border-b","border-slate-700","py-3","hover:bg-white/5","transition","ease-linear","duration-150"],["stroke-linecap","round","stroke-linejoin","round","d","M15.75 3.75 18 6m0 0 2.25 2.25M18 6l2.25-2.25M18 6l-2.25 2.25m1.5 13.5c-8.284 0-15-6.716-15-15V4.5A2.25 2.25 0 0 1 4.5 2.25h1.372c.516 0 .966.351 1.091.852l1.106 4.423c.11.44-.054.902-.417 1.173l-1.293.97a1.062 1.062 0 0 0-.38 1.21 12.035 12.035 0 0 0 7.143 7.143c.441.162.928-.004 1.21-.38l.97-1.293a1.125 1.125 0 0 1 1.173-.417l4.423 1.106c.5.125.852.575.852 1.091V19.5a2.25 2.25 0 0 1-2.25 2.25h-2.25Z"],[1,"w-full","px-2","flex","flex-col","justify-between","border-b","border-slate-700","py-3","hover:bg-white/5","transition","ease-linear","duration-150","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between","w-full"],[1,"flex","items-center","space-x-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"w-6","h-6"],["fill-rule","evenodd","d","M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z","clip-rule","evenodd"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4","text-slate-400","transition-transform","duration-300"],["stroke-linecap","round","stroke-linejoin","round","d","M9 5l7 7-7 7"],[1,"overflow-hidden","transition-all","duration-500","ease-in-out"],["routerLink","/admin/users",1,"block","py-2","pl-10","hover:bg-white/5","text-slate-300"],["routerLink","/admin/roles",1,"block","py-2","pl-10","hover:bg-white/5","text-slate-300"],[1,"flex-1","ml-64","pt-5","px-5"]],template:function(t,n){t&1&&(o(0,"div",1),h(1,Wt,9,1,"div",2)(2,Jt,92,5,"div",3),c(3,"toast"),r()),t&2&&(a(),v(n.isMobile?1:2))},dependencies:[Dt,w,Et,It,Mt,Ue],styles:["[_nghost-%COMP%]{display:block}"]})};async function Xt(){return new Promise(i=>{setTimeout(()=>{i(!0)},2500)})}var Te=class i{static namePattern="([a-zA-Z]+) ([a-zA-Z]+)";static emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$";static notOnlySpacesPattern="^[a-zA-Z0-9]+$";static slugPattern="^[a-z0-9_]+(?:-[a-z0-9_]+)*$";static getTextError(e){for(let t of Object.keys(e))switch(t){case"required":return"Este campo es requerido";case"minlength":return`M\xEDnimo de ${e.minlength.requiredLength} caracteres.`;case"min":return`Valor m\xEDnimo de ${e.min.min}`;case"email":return"El valor ingresado no es un correo electr\xF3nico";case"emailTaken":return"El correo electr\xF3nico ya est\xE1 siendo usado por otro usuario";case"noStrider":return"No se puede usar el username de strider en la app";case"pattern":return e.pattern.requiredPattern===i.emailPattern?"El valor ingresado no luce como un correo electr\xF3nico":"Error de patr\xF3n contra expresi\xF3n regular";default:return`Error de validaci\xF3n no controlado ${t}`}return null}static isValidField(e,t){return!!e.controls[t].errors&&e.controls[t].touched}static getFieldError(e,t){if(!e.controls[t])return null;let n=e.controls[t].errors??{};return i.getTextError(n)}static isValidFieldInArray(e,t){return e.controls[t].errors&&e.controls[t].touched}static getFieldErrorInArray(e,t){if(e.controls.length===0)return null;let n=e.controls[t].errors??{};return i.getTextError(n)}static isFieldOneEqualFieldTwo(e,t){return n=>{let s=n.get(e)?.value,m=n.get(t)?.value;return s===m?null:{passwordsNotEqual:!0}}}static async checkingServerResponse(e){return await Xt(),e.value==="hola@mundo.com"?{emailTaken:!0}:null}static notStrider(e){return e.value==="strider"?{noStrider:!0}:null}};var G=class i{control=S.required();get errorMessage(){let e=this.control().errors||{};return this.control().touched&&Object.keys(e).length>0?Te.getTextError(e):null}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["form-error-label"]],inputs:{control:[1,"control"]},decls:2,vars:1,consts:[[1,"text-red-500","text-xs"]],template:function(t,n){t&1&&(_e(0,"span",0),l(1),xe()),t&2&&(a(),y(n.errorMessage))},styles:["[_nghost-%COMP%]{display:block}"]})};var je=class i{contact=S.required();router=d(M);contactService=d(we);configurationService=d(pe);fb=d(le);contactForm=this.fb.group({title:["",P.required],phone:["",P.required],email:["",[P.required,P.email]]});ngOnInit(){this.contactForm.reset(this.contact())}async onSubmit(){this.contactForm.markAllAsTouched();let e=this.contactForm.value,t=Q({},e);this.contact().id==="new"?await C(this.contactService.create(t)):await C(this.contactService.update(this.contact().id,t)),this.router.navigate(["/admin/contacts"])}controlPresionado=!1;handleKeyboardEvent(e){e.key==="Control"?this.controlPresionado=!0:e.key==="Enter"&&this.controlPresionado&&this.onSubmit()}handleKeyboardUp(e){e.key==="Control"&&(this.controlPresionado=!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["contact-details"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)("keyup",function(m){return n.handleKeyboardUp(m)},L)},inputs:{contact:[1,"contact"]},decls:17,vars:11,consts:[[1,"text-2xl","font-bold"],[1,"divider"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"text-xl","font-bold","h-12"],["type","text","placeholder","Nombre","formControlName","title",1,"input","input-bordered","w-full"],[3,"control"],["type","text","placeholder","Tel\xE9fono","formControlName","phone",1,"input","input-bordered","w-full"],["type","email","placeholder","Email","formControlName","email",1,"input","input-bordered","w-full"],[1,"flex","justify-end","h-12"],["type","submit",1,"btn","btn-secondary"]],template:function(t,n){if(t&1&&(o(0,"h1",0),l(1),r(),c(2,"div",1),o(3,"form",2),f("ngSubmit",function(){return n.onSubmit()}),o(4,"div",3)(5,"h2",4),l(6,"Datos generales"),r(),c(7,"input",5)(8,"form-error-label",6)(9,"input",7)(10,"form-error-label",6)(11,"input",8)(12,"form-error-label",6),r(),o(13,"div",3)(14,"div",9)(15,"button",10),l(16,"Guardar"),r()()()()),t&2){let s,m,_;a(),y(n.contact().title||"Crear nuevo contacto"),a(2),p("formGroup",n.contactForm),a(4),F("border-red-500",((s=n.contactForm.get("title"))==null?null:s.errors)??!1),a(),p("control",n.contactForm.get("title")),a(),F("border-red-500",((m=n.contactForm.get("phone"))==null?null:m.errors)??!1),a(),p("control",n.contactForm.get("phone")),a(),F("border-red-500",((_=n.contactForm.get("email"))==null?null:_.errors)??!1),a(),p("control",n.contactForm.get("email"))}},dependencies:[ce,re,ie,ne,oe,ae,se,G],styles:["[_nghost-%COMP%]{display:block}"]})};function Yt(i,e){i&1&&(o(0,"div",0),c(1,"loading"),r())}function ei(i,e){if(i&1&&c(0,"contact-details",1),i&2){let t=b();p("contact",t.contact())}}var $e=class i{activateRoute=d(ee);router=d(M);contactService=d(we);contactId=te(this.activateRoute.params.pipe(H(e=>e.id)));contact=g(null);loading=g(!0);error=g(null);constructor(){$(()=>{let e=this.contactId();this.loadContact(e)})}async loadContact(e){this.loading.set(!0),this.error.set(null);try{let t=await C(this.contactService.getById(e));this.contact.set(t)}catch{this.error.set("Error al cargar el contacto"),this.router.navigate(["/admin/contacts"])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["contact-admin"]],decls:2,vars:2,consts:[[1,"min-h-[50vh]","gap-4"],[3,"contact"]],template:function(t,n){if(t&1&&(h(0,Yt,2,0,"div",0),h(1,ei,1,1,"contact-details",1)),t&2){let s;v(n.loading()?0:-1),a(),v((s=n.contact())!=null&&s.id?1:-1)}},dependencies:[N,je],styles:["[_nghost-%COMP%]{display:block}"]})};function ti(i,e){if(i&1){let t=I();_e(0,"div",0)(1,"div",1)(2,"h2",2),l(3),xe(),_e(4,"p",3),l(5),xe(),_e(6,"div",4)(7,"button",5),ft("click",function(){E(t);let s=b();return T(s.close(!0))}),l(8," Si "),xe(),_e(9,"button",6),ft("click",function(){E(t);let s=b();return T(s.close(!1))}),l(10," No "),xe()()()()}if(i&2){let t=b();a(3),y(t.title()),a(2),y(t.message())}}var A=class i{visible=g(!1);message=g("");title=g("Confirmar");resolver;open(e,t="Confirmar"){return this.message.set(e),this.title.set(t),this.visible.set(!0),new Promise(n=>{this.resolver=n})}close(e){this.visible.set(!1),this.resolver&&(this.resolver(e),this.resolver=void 0)}handleKeyboardEvent(e){if(this.visible())switch(e.key){case"Enter":case" ":e.preventDefault(),this.close(!0);break;case"Escape":e.preventDefault(),this.close(!1);break}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["confirm-dialog"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)},decls:1,vars:1,consts:[[1,"fixed","inset-0","flex","items-center","justify-center","z-50"],[1,"bg-base-100","border","border-slate-700","rounded-xl","shadow-xl","p-6","w-[320px]","text-center","backdrop-blur-sm"],[1,"text-lg","font-bold","mb-3","text-slate-200"],[1,"mb-6","text-slate-400"],[1,"flex","justify-center","gap-4"],[1,"btn","btn-sm","bg-red-500","hover:bg-red-600","text-white","font-semibold","cursor-pointer",3,"click"],[1,"btn","btn-sm","bg-slate-700","hover:bg-slate-600","text-slate-100","font-semibold","cursor-pointer",3,"click"]],template:function(t,n){t&1&&h(0,ti,11,2,"div",0),t&2&&v(n.visible()?0:-1)},dependencies:[wt],styles:["[_nghost-%COMP%]{display:block}"]})};function ii(i,e){if(i&1){let t=I();o(0,"a",6),f("click",function(){E(t);let s=b();return T(s.onEditClick())}),Z(),o(1,"svg",4),c(2,"path",7),r()()}if(i&2){let t=b();p("routerLink",t.editLink())}}function ni(i,e){if(i&1){let t=I();o(0,"button",8),f("click",function(){E(t);let s=b();return T(s.onEditClick())}),Z(),o(1,"svg",4),c(2,"path",7),r()()}}var K=class i{editLink=S(null);delete=new j;edit=new j;onDeleteClick(){this.delete.emit()}onEditClick(){this.edit.emit()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["table-action-buttons"]],inputs:{editLink:[1,"editLink"]},outputs:{delete:"delete",edit:"edit"},decls:6,vars:1,consts:[[1,"action-buttons"],["aria-label","Editar",1,"action-btn","action-btn-edit",3,"routerLink"],["type","button","aria-label","Editar",1,"action-btn","action-btn-edit"],["type","button","aria-label","Eliminar",1,"action-btn","action-btn-danger",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-5"],["fill-rule","evenodd","d","M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452Zm-.355 5.945a.75.75 0 1 0-1.5.058l.347 9a.75.75 0 1 0 1.499-.058l-.346-9Zm5.48.058a.75.75 0 1 0-1.498-.058l-.347 9a.75.75 0 0 0 1.5.058l.345-9Z","clip-rule","evenodd"],["aria-label","Editar",1,"action-btn","action-btn-edit",3,"click","routerLink"],["d","M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"],["type","button","aria-label","Editar",1,"action-btn","action-btn-edit",3,"click"]],template:function(t,n){t&1&&(o(0,"div",0),h(1,ii,3,1,"a",1)(2,ni,3,0,"button",2),o(3,"button",3),f("click",function(){return n.onDeleteClick()}),Z(),o(4,"svg",4),c(5,"path",5),r()()()),t&2&&(a(),v(n.editLink()?1:2))},dependencies:[w],styles:["[_nghost-%COMP%]{display:inline-block}.action-buttons[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:.35rem}.action-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:42px;height:42px;border-radius:9999px;background-color:transparent;cursor:pointer;transition:background-color .2s ease,color .2s ease}.action-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.action-btn[_ngcontent-%COMP%]:hover{background-color:#e5e7eb99}.action-btn-edit[_ngcontent-%COMP%]{color:#c57f2f}.action-btn-danger[_ngcontent-%COMP%]{color:#ef4444}"]})};var Ot=i=>["/admin/contacts",i],oi=(i,e)=>e.id;function ri(i,e){if(i&1){let t=I();o(0,"tr")(1,"th"),l(2),r(),o(3,"td")(4,"a",3),l(5),r()(),o(6,"td"),l(7),r(),o(8,"td"),l(9),r(),o(10,"th",4)(11,"table-action-buttons",5),f("delete",function(){let s=E(t).$implicit,m=b(2);return T(m.onDelete(s.id))}),r()()()}if(i&2){let t=e.$implicit,n=e.$index;a(2),y(n+1),a(2),p("routerLink",V(6,Ot,t.id)),a(),k(" ",t.title," "),a(2),y(t.phone),a(2),y(t.email),a(2),p("editLink",V(8,Ot,t.id))}}function ai(i,e){if(i&1&&U(0,ri,12,10,"tr",null,oi),i&2){let t=b();O(t.contacts())}}function si(i,e){i&1&&(o(0,"tr")(1,"td",6),l(2," No hay contactos. "),r()())}var Be=class i{contacts=S.required();delete=new j;confirmDialog;async onDelete(e){await this.confirmDialog.open("\xBFEst\xE1s seguro que deseas eliminar este contacto?")&&this.delete.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["contacts-table"]],viewQuery:function(t,n){if(t&1&&W(A,5),t&2){let s;J(s=X())&&(n.confirmDialog=s.first)}},inputs:{contacts:[1,"contacts"]},outputs:{delete:"delete"},decls:16,vars:1,consts:[[1,"overflow-y-auto","max-h-[75vh]","overflow-x-auto","border","border-slate-700","rounded-xl"],[1,"table","table-zebra","w-full"],[1,"sticky","top-0","bg-slate-900","z-10"],[1,"font-bold","hover:text-primary","transition-colors","duration-300",3,"routerLink"],[1,"flex","justify-end","items-center"],[3,"delete","editLink"],["colspan","5",1,"text-center","py-6","text-sm","opacity-70"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),c(4,"th"),o(5,"th"),l(6,"Nombre"),r(),o(7,"th"),l(8,"Tel\xE9fono"),r(),o(9,"th"),l(10,"Email"),r(),c(11,"th"),r()(),o(12,"tbody"),h(13,ai,2,0)(14,si,3,0,"tr"),r()()(),c(15,"confirm-dialog")),t&2&&(a(13),v(n.contacts().length?13:14))},dependencies:[w,A,K],styles:["[_nghost-%COMP%]{display:block}"]})};var li=()=>[];function ci(i,e){i&1&&(o(0,"div",6),c(1,"loading"),r())}var He=class i{contactService=d(we);contacts=g(null);total=Y(()=>this.contacts()?.length??0);loading=g(!0);error=g(null);ngOnInit(){this.getContacts()}async getContacts(){this.loading.set(!0),this.error.set(null);try{let e=await C(this.contactService.getAll());this.contacts.set(e)}catch{this.error.set("Error al cargar los contactos")}finally{this.loading.set(!1)}}async delete(e){try{await C(this.contactService.delete(e)),this.contacts.set(this.contacts()?.filter(t=>t.id!==e))}catch(t){console.error("Error al eliminar",t),this.error.set("No se pudo eliminar el contacto.")}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["contacts-admin"]],decls:12,vars:4,consts:[[1,"text-2xl","font-bold"],[1,"text-lg"],[1,"text-primary"],[1,"flex","gap-2","items-center","h-20"],[1,"flex","flex-1"],["routerLink","/admin/contacts/new",1,"btn","btn-primary"],[1,"min-h-[50vh]","gap-4"],[3,"delete","contacts"]],template:function(t,n){t&1&&(o(0,"h1",0),l(1,"Listado de contactos"),r(),o(2,"h3",1),l(3," Total de contactos: "),o(4,"span",2),l(5),r()(),o(6,"div",3),c(7,"div",4),o(8,"button",5),l(9," Cargar contacto "),r()(),h(10,ci,2,0,"div",6),o(11,"contacts-table",7),f("delete",function(m){return n.delete(m)}),r()),t&2&&(a(5),y(n.total()),a(5),v(n.loading()?10:-1),a(),p("contacts",n.contacts()??q(3,li)))},dependencies:[w,Be,N],styles:["[_nghost-%COMP%]{display:block}"]})};function jt(){let i=d(De),e=g(null),t=g(!0),n=g(null);async function s(m){t.set(!0),n.set(null);try{let _=await C(i.getProductByIdSlug(m));e.set(_)}catch{n.set("Error al carga el producto")}finally{t.set(!1)}}return{product:e,loading:t,error:n,loadProducts:s}}var Fe=`${de.baseUrl}/categories`,mi={id:"new",name:""},ve=class i{http=d(fe);toastService=d(he);categoriesCache=new Map;getAll(){return this.categoriesCache.size?B(Array.from(this.categoriesCache.values())):this.http.get(Fe).pipe(R(e=>e.forEach(t=>this.categoriesCache.set(t.id,t))))}getById(e){return e==="new"?B(mi):this.categoriesCache.has(e)?B(this.categoriesCache.get(e)):this.http.get(`${Fe}/${e}`).pipe(R(t=>this.categoriesCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(Fe,e).pipe(R(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${Fe}/${e}`,t).pipe(R(n=>{this.insertOrUpdateCache(n),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${Fe}/${e}`).pipe(R(()=>{this.categoriesCache.delete(e),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.categoriesCache.set(e.id,e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})};var Me=`${de.baseUrl}/tags`,di={id:"new",name:""},be=class i{http=d(fe);toastService=d(he);tagsCache=new Map;getAll(){return this.tagsCache.size?B(Array.from(this.tagsCache.values())):this.http.get(Me).pipe(R(e=>e.forEach(t=>this.tagsCache.set(t.id,t))))}getById(e){return e==="new"?B(di):this.tagsCache.has(e)?B(this.tagsCache.get(e)):this.http.get(`${Me}/${e}`).pipe(R(t=>this.tagsCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(Me,e).pipe(R(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${Me}/${e}`,t).pipe(R(n=>{this.insertOrUpdateCache(n),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${Me}/${e}`).pipe(R(()=>{this.tagsCache.delete(e),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.tagsCache.set(e.id,e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})};var ze=class i{http=d(fe);baseUrl=de.baseUrl;uploadProductImage(e){let t=new FormData;return t.append("file",e),this.http.post(`${this.baseUrl}/files/products/upload`,t).pipe(H(n=>this.extractFileName(n)))}extractFileName(e){if(!e)return"";if(typeof e=="string")return this.normalizeFileName(e);if(Array.isArray(e)){let t=e[0];return t?typeof t=="string"?this.normalizeFileName(t):this.normalizeFileName(t.id||t.fileName||t.filename||t.name||""):""}if(e.files?.length){let t=e.files[0];return this.normalizeFileName(t?.id||t?.fileName||t?.filename||t?.name||t?.url||"")}return this.normalizeFileName(e.id||e.fileName||e.filename||e.name||e.secureUrl||e.url||e.path||"")}normalizeFileName(e){return e?/^https?:\/\//.test(e)&&e.split("/").at(-1)||e:""}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})};var $t=(i,e)=>e.id,pi=(i,e)=>e.identifier;function ui(i,e){i&1&&(o(0,"span",19),l(1,"Cargando categor\xEDas..."),r())}function gi(i,e){if(i&1){let t=I();o(0,"button",34),f("click",function(){let s=E(t).$implicit,m=b(2);return T(m.selectCategory(s))}),l(1),r()}if(i&2){let t=e.$implicit,n=b(2);F("btn-primary",n.isCategorySelected(t)),a(),k(" ",t.name," ")}}function fi(i,e){if(i&1&&U(0,gi,2,3,"button",33,$t),i&2){let t=b();O(t.categories())}}function hi(i,e){i&1&&(o(0,"p",20),l(1,"Selecciona una categor\xEDa."),r())}function vi(i,e){i&1&&(o(0,"span",19),l(1,"Cargando tags..."),r())}function bi(i,e){i&1&&(o(0,"span",19),l(1,"No hay tags disponibles."),r())}function Ci(i,e){if(i&1){let t=I();o(0,"button",36),f("click",function(){let s=E(t).$implicit,m=b(2);return T(m.onTagsClicked(s.name))}),l(1),r()}if(i&2){let t=e.$implicit,n=b(2);F("btn-secondary",n.isTagSelected(t.name)),a(),k(" ",t.name," ")}}function yi(i,e){if(i&1&&U(0,Ci,2,3,"button",35,$t),i&2){let t=b();O(t.tagsList())}}function _i(i,e){if(i&1&&c(0,"img",29),i&2){let t=b();p("src",t.previewImage,ke)}}function xi(i,e){i&1&&(o(0,"span",19),l(1,"La vista previa aparecer\xE1 aqu\xED"),r())}function Si(i,e){if(i&1){let t=I();o(0,"div",38),f("click",function(){let s=E(t).$implicit,m=b(2);return T(m.setPreviewImage(s.src))}),c(1,"img",39),o(2,"button",40),f("click",function(s){let m=E(t).$implicit,_=b(2);return s.stopPropagation(),T(m.type==="existing"?_.removeImage(m.identifier):_.removePendingImage(m.identifier))}),c(3,"x-circle"),r()()}if(i&2){let t=e.$implicit,n=b(2);F("border-primary",n.previewImage===t.src)("border-transparent",n.previewImage!==t.src),a(),p("src",t.src,ke)}}function wi(i,e){if(i&1&&(o(0,"div",30),U(1,Si,4,5,"div",37,pi),r()),i&2){let t=b();a(),O(t.imageSources())}}function Di(i,e){i&1&&(o(0,"p",31),l(1,"Subiendo im\xE1genes..."),r())}function Ei(i,e){if(i&1&&(o(0,"p",32),l(1),r()),i&2){let t=b();a(),y(t.imageUploadError)}}var qe=class i{product=S.required();router=d(M);productsService=d(De);configurationService=d(pe);categoryService=d(ve);filesService=d(ze);tagService=d(be);cdr=d(xt);defaultCategory={id:"default-sin-gluten",name:"Sin Gluten"};fb=d(le);productForm=this.fb.group({title:["",P.required],slug:["",[P.required,P.pattern(Te.slugPattern)]],description:["",P.required],price:[1,[P.required,P.min(1)]],stock:[1,[P.required,P.min(1)]],isFeatured:[!1],categoryId:["",P.required],tags:this.fb.nonNullable.control([]),imageIds:this.fb.nonNullable.control([])});categories=g([]);tagsList=g([]);loadingCategories=g(!1);loadingTags=g(!1);selectedCategoryId=g(null);uploadingImages=g(!1);imageUploadError=null;previewImage=null;pendingImages=[];imageSourceList=[];uploadedPreviewMap=new Map;ngOnInit(){this.initializeFormFromProduct(),this.loadCategories(),this.loadTags()}ngOnDestroy(){this.cleanupObjectUrls()}initializeFormFromProduct(){let e=this.product(),t=this.mapProductImageIds(e),n=this.extractTagNames(e?.tags),s=e?.category?.id??"";this.productForm.reset({title:e?.title??"",slug:e?.slug??"",description:e?.description??"",price:e?.price??1,stock:e?.stock??1,isFeatured:e?.isFeatured??!1,categoryId:s,tags:n,imageIds:t}),this.selectedCategoryId.set(s||null),this.refreshImageSources()}loadCategories(){this.loadingCategories.set(!0),this.categoryService.getAll().subscribe({next:e=>{this.categories.set(e.length?e:[this.defaultCategory]),this.loadingCategories.set(!1),this.cdr.detectChanges()},error:()=>{this.categories.set([this.defaultCategory]),this.loadingCategories.set(!1),this.cdr.detectChanges()},complete:()=>{this.loadingCategories.set(!1)}})}loadTags(){this.loadingTags.set(!0),this.tagService.getAll().subscribe({next:e=>{this.tagsList.set(e),this.loadingTags.set(!1),this.cdr.detectChanges()},error:()=>{this.tagsList.set([]),this.loadingTags.set(!1),this.cdr.detectChanges()}})}mapProductImageIds(e){return e?Array.isArray(e.imageIds)&&e.imageIds.length?e.imageIds.filter(n=>!!n):(Array.isArray(e.images)?e.images:[]).map(n=>this.resolveImageIdentifier(n)).filter(n=>!!n):[]}resolveImageIdentifier(e){if(!e)return null;if(typeof e=="string")return this.normalizeImageIdentifier(e);if(typeof e=="object"){let t=e.id||e.name||e.fileName||e.filename||e.path||e.secureUrl||e.url;return typeof t=="string"?this.normalizeImageIdentifier(t):null}return null}normalizeImageIdentifier(e){if(!e)return"";let n=e.split("?")[0].replace(/\\/g,"/"),s=n.startsWith("assets/");return/^https?:\/\//.test(n)||!s&&n.includes("/")?n.split("/").pop()??n:n}extractTagNames(e){return e?e.map(t=>typeof t=="string"?t:t?.name??"").filter(t=>!!t):[]}get imageIdsControl(){return this.productForm.get("imageIds")}currentImageIds(){return this.imageIdsControl?.value??[]}onFilesSelected(e){let t=e.target,n=t.files;!n||n.length===0||(this.imageUploadError=null,Array.from(n).forEach(s=>{let m=URL.createObjectURL(s);this.pendingImages.push({file:s,preview:m})}),t.value="",this.refreshImageSources())}removeImage(e){let t=this.currentImageIds().filter(s=>s!==e);this.imageIdsControl?.setValue(t),this.imageIdsControl?.markAsDirty();let n=this.uploadedPreviewMap.get(e);n&&(URL.revokeObjectURL(n),this.uploadedPreviewMap.delete(e)),this.refreshImageSources()}removePendingImage(e){let t=this.pendingImages.findIndex(n=>n.preview===e);t>=0&&(URL.revokeObjectURL(this.pendingImages[t].preview),this.pendingImages.splice(t,1),this.refreshImageSources())}updatePreviewImage(){if(!this.imageSourceList.length){this.previewImage=null;return}this.previewImage&&this.imageSourceList.some(e=>e.src===this.previewImage)||(this.previewImage=this.imageSourceList[0]?.src??null)}refreshImageSources(){let e=this.currentImageIds().map(n=>({src:this.uploadedPreviewMap.get(n)??this.mapExistingImageToUrl(n),type:"existing",identifier:n})),t=this.pendingImages.map(n=>({src:n.preview,type:"local",identifier:n.preview}));this.imageSourceList=[...t,...e],this.updatePreviewImage()}mapExistingImageToUrl(e){return e?/^https?:\/\//.test(e)||e.startsWith("assets/")?e:`${de.baseUrl}/files/product/${e}`:"assets/images/default-image.jpg"}setPreviewImage(e){this.previewImage=e}selectCategory(e){this.selectedCategoryId.set(e.id),this.productForm.get("categoryId")?.setValue(e.id)}isCategorySelected(e){return this.selectedCategoryId()===e.id}imageSources(){return this.imageSourceList}isTagSelected(e){return(this.productForm.get("tags")?.value??[]).some(n=>n.toLowerCase()===e.toLowerCase())}onTagsClicked(e){let t=e.toLowerCase(),n=[...this.productForm.get("tags")?.value??[]];n.includes(t)?n.splice(n.indexOf(t),1):n.push(t),this.productForm.get("tags")?.setValue(n)}async uploadPendingImages(){if(!this.pendingImages.length)return[];this.uploadingImages.set(!0);try{let e=[...this.pendingImages],t=e.map(_=>this.filesService.uploadProductImage(_.file)),s=(await C(bt(t))).map((_,me)=>({name:(_??"").toString().trim(),preview:e[me]?.preview})).filter(_=>!!_.name);s.length||(this.imageUploadError="No se pudo subir la imagen seleccionada.");let m=new Set(s.map(({preview:_})=>_));return this.pendingImages=this.pendingImages.filter(_=>!m.has(_.preview)),s.forEach(({name:_,preview:me})=>{me&&this.uploadedPreviewMap.set(_,me)}),s.map(({name:_})=>_)}catch{return this.imageUploadError="Error al subir la imagen. Intenta nuevamente.",[]}finally{this.uploadingImages.set(!1)}}async onSubmit(){this.productForm.markAllAsTouched(),this.imageUploadError=null;let e=await this.uploadPendingImages();if(e.length){let me=[...this.currentImageIds(),...e];this.imageIdsControl?.setValue(me),this.imageIdsControl?.markAsDirty()}if(this.refreshImageSources(),!this.currentImageIds().length){this.imageUploadError="Primero sube al menos una imagen del producto.";return}let t=this.productForm.value,n=(t.imageIds??[]).filter(me=>!!me),s=this.extractTagNames(t.tags),m=t.slug&&t.slug.length?t.slug:this.generateSlug(t.title??""),_=vt(Q({},t),{slug:m,imageIds:n,categoryId:t.categoryId,isFeatured:!!t.isFeatured});delete _.tags,this.product().id==="new"?await C(this.productsService.createProduct(_)):await C(this.productsService.updateProduct(this.product().id,_)),this.router.navigate(["/admin/products"])}controlPresionado=!1;handleKeyboardEvent(e){e.key==="Control"?this.controlPresionado=!0:e.key==="Enter"&&this.controlPresionado&&this.onSubmit()}handleKeyboardUp(e){e.key==="Control"&&(this.controlPresionado=!1)}generateSlug(e){return e.toLowerCase().trim().replace(/[\s_]+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-")}cleanupObjectUrls(){this.pendingImages.forEach(e=>URL.revokeObjectURL(e.preview)),this.pendingImages=[],this.uploadedPreviewMap.forEach(e=>URL.revokeObjectURL(e)),this.uploadedPreviewMap.clear()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["product-details"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)("keyup",function(m){return n.handleKeyboardUp(m)},L)},inputs:{product:[1,"product"]},decls:62,vars:22,consts:[[1,"text-2xl","font-bold"],[1,"divider"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"text-xl","font-bold","h-12"],["for","title"],["type","text","placeholder","T\xEDtulo","formControlName","title",1,"input","input-bordered","w-full"],[3,"control"],["for","description"],["placeholder","Descripci\xF3n","rows","6","formControlName","description",1,"textarea","textarea-bordered","w-full"],[1,"text-lg","font-bold"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-2"],["for","price"],["type","number","placeholder","Precio","formControlName","price",1,"input","input-bordered","w-full"],["for","stock"],["type","number","placeholder","Stock","formControlName","stock",1,"input","input-bordered","w-full"],[1,"flex","flex-col","gap-1"],[1,"-mx-2","px-2"],[1,"flex","gap-2","overflow-x-auto","pb-2","snap-x","snap-mandatory"],[1,"text-sm","opacity-70"],[1,"text-error","text-sm","mt-1"],[1,"flex","cursor-pointer","justify-end","gap-2"],["type","checkbox","formControlName","isFeatured",1,"checkbox","checkbox-primary"],[1,"label-text"],[1,"flex","justify-end","h-12"],["type","submit",1,"btn","btn-secondary"],["for","images"],["type","file","id","images","multiple","","accept","image/*",1,"file-input","file-input-bordered","w-full",3,"change","disabled"],[1,"w-full","h-97","bg-base-200","border","border-dashed","border-base-300","rounded-lg","flex","items-center","justify-center","overflow-hidden"],["alt","Previsualizaci\xF3n",1,"w-full","h-full","object-cover","object-center",3,"src"],[1,"flex","gap-2","overflow-x-auto","pb-2"],[1,"text-sm","text-primary"],[1,"text-sm","text-error"],["type","button",1,"btn","btn-sm","whitespace-nowrap","snap-start",3,"btn-primary"],["type","button",1,"btn","btn-sm","whitespace-nowrap","snap-start",3,"click"],["type","button",1,"btn","btn-xs","sm:btn-sm","whitespace-nowrap","snap-start",3,"btn-secondary"],["type","button",1,"btn","btn-xs","sm:btn-sm","whitespace-nowrap","snap-start",3,"click"],[1,"relative","min-w-[110px]","h-24","rounded-md","border-2","overflow-hidden","cursor-pointer","bg-base-200",3,"border-primary","border-transparent"],[1,"relative","min-w-[110px]","h-24","rounded-md","border-2","overflow-hidden","cursor-pointer","bg-base-200",3,"click"],["alt","Miniatura",1,"w-full","h-full","object-cover","rounded-md",3,"src"],["type","button",1,"absolute","top-1","right-1","bg-base-100","rounded-full","w-6","h-6","flex","items-center","justify-center","shadow",3,"click"]],template:function(t,n){if(t&1&&(o(0,"h1",0),l(1),r(),c(2,"div",1),o(3,"form",2),f("ngSubmit",function(){return n.onSubmit()}),o(4,"div",3)(5,"h2",4),l(6,"Datos generales"),r(),o(7,"label",5),l(8,"Titulo"),r(),c(9,"input",6)(10,"form-error-label",7),o(11,"label",8),l(12,"Descripci\xF3n"),r(),c(13,"textarea",9)(14,"form-error-label",7),o(15,"h2",10),l(16,"Datos de venta"),r(),o(17,"div",11)(18,"div")(19,"label",12),l(20,"Precio"),r(),c(21,"input",13)(22,"form-error-label",7),r(),o(23,"div")(24,"label",14),l(25,"Stock"),r(),c(26,"input",15)(27,"form-error-label",7),r()(),o(28,"div",16)(29,"h2",10),l(30,"Categor\xEDas"),r(),o(31,"div",17)(32,"div",18),h(33,ui,2,0,"span",19)(34,fi,2,0),r(),h(35,hi,2,0,"p",20),r()(),o(36,"div",16)(37,"h2",10),l(38,"Tags"),r(),o(39,"div",17)(40,"div",18),h(41,vi,2,0,"span",19)(42,bi,2,0,"span",19)(43,yi,2,0),r()()(),o(44,"label",21),c(45,"input",22),o(46,"span",23),l(47,"Destacar producto"),r()()(),o(48,"div",3)(49,"div",24)(50,"button",25),l(51," Guardar "),r()(),o(52,"div",3)(53,"label",26),l(54,"Im\xE1genes del producto"),r(),o(55,"input",27),f("change",function(m){return n.onFilesSelected(m)}),r(),o(56,"div",28),h(57,_i,1,1,"img",29)(58,xi,2,0,"span",19),r(),h(59,wi,3,0,"div",30),h(60,Di,2,0,"p",31),h(61,Ei,2,1,"p",32),r()()()),t&2){let s,m,_,me,Se;a(),y(n.product().title||"Crear nuevo producto"),a(2),p("formGroup",n.productForm),a(6),F("border-red-500",((s=n.productForm.get("title"))==null?null:s.errors)??!1),a(),p("control",n.productForm.get("title")),a(3),F("border-red-500",((m=n.productForm.get("description"))==null?null:m.errors)??!1),a(),p("control",n.productForm.get("description")),a(7),F("border-red-500",((_=n.productForm.get("price"))==null?null:_.errors)??!1),a(),p("control",n.productForm.get("price")),a(4),F("border-red-500",((me=n.productForm.get("stock"))==null?null:me.errors)??!1),a(),p("control",n.productForm.get("stock")),a(6),v(n.loadingCategories()?33:34),a(2),v((Se=n.productForm.get("categoryId"))!=null&&Se.invalid&&((Se=n.productForm.get("categoryId"))!=null&&Se.touched)?35:-1),a(6),v(n.loadingTags()?41:n.tagsList().length?43:42),a(14),p("disabled",n.uploadingImages()),a(2),v(n.previewImage?57:58),a(2),v(n.imageSources().length?59:-1),a(),v(n.uploadingImages()?60:-1),a(),v(n.imageUploadError?61:-1)}},dependencies:[ce,re,ie,Pt,Tt,ne,oe,ae,se,G,Ft],styles:["[_nghost-%COMP%]{display:block}"]})};function Ti(i,e){i&1&&(o(0,"div",0),c(1,"loading"),r())}function Pi(i,e){if(i&1&&c(0,"product-details",1),i&2){let t=b();p("product",t.product())}}var Ge=class i{activateRoute=d(ee);router=d(M);productId=te(this.activateRoute.params.pipe(H(e=>e.id)));paginationService=d(Ve);product;loading;error;loadProducts;constructor(){let{product:e,loading:t,error:n,loadProducts:s}=jt();this.product=e,this.loading=t,this.error=n,this.loadProducts=s,$(()=>{let m=this.productId();this.loadProducts(m)}),$(()=>{this.error()&&this.router.navigate(["/admin/products"])})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["app-product-admin"]],decls:2,vars:2,consts:[[1,"min-h-[50vh]","gap-4"],[3,"product"]],template:function(t,n){if(t&1&&(h(0,Ti,2,0,"div",0),h(1,Pi,1,1,"product-details",1)),t&2){let s;v(n.loading()?0:-1),a(),v((s=n.product())!=null&&s.id?1:-1)}},dependencies:[N,qe],styles:["[_nghost-%COMP%]{display:block}"]})};var ki=()=>[],Bt=i=>["/admin/products",i],Ii=(i,e)=>e.id;function Fi(i,e){if(i&1){let t=I();o(0,"tr")(1,"th")(2,"label"),l(3),r()(),o(4,"td")(5,"div",3)(6,"div",4)(7,"div",5),c(8,"img",6),Ie(9,"productImage"),r()(),o(10,"div")(11,"a",7),l(12),r(),o(13,"div",8),l(14),r()()()(),o(15,"td"),l(16),Ie(17,"guaranies"),r(),o(18,"td"),l(19),r(),o(20,"th",9)(21,"table-action-buttons",10),f("delete",function(){let s=E(t).$implicit,m=b(2);return T(m.onDelete(s.id))}),r()()()}if(i&2){let t=e.$implicit,n=e.$index,s=b(2);a(3),k(" ",(s.currentPage()-1)*s.countPage()+(n+1)," "),a(5),p("src",ht(9,9,t.images??q(13,ki)),ke)("alt",t.title),a(3),p("routerLink",V(14,Bt,t.id)),a(),k(" ",t.title," "),a(2),k(" ",t.description," "),a(2),y(ht(17,11,t.price)),a(3),y(t.stock),a(2),p("editLink",V(16,Bt,t.id))}}function Mi(i,e){if(i&1&&U(0,Fi,22,18,"tr",null,Ii),i&2){let t=b();O(t.products())}}function Ni(i,e){i&1&&(o(0,"tr")(1,"td",11),l(2," No hay productos. "),r()())}var Ke=class i{products=S.required();currentPage=S.required();countPage=S.required();delete=new j;confirmDialog;async onDelete(e){await this.confirmDialog.open("\xBFEst\xE1s seguro que deseas eliminar este producto?")&&this.delete.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["products-table"]],viewQuery:function(t,n){if(t&1&&W(A,5),t&2){let s;J(s=X())&&(n.confirmDialog=s.first)}},inputs:{products:[1,"products"],currentPage:[1,"currentPage"],countPage:[1,"countPage"]},outputs:{delete:"delete"},decls:16,vars:1,consts:[[1,"overflow-y-auto","max-h-[75vh]","overflow-x-auto","border","border-slate-700","rounded-xl"],[1,"table","table-zebra","w-full"],[1,"sticky","top-0","bg-slate-900","z-10"],[1,"flex","items-center","gap-3"],[1,"avatar"],[1,"mask","mask-squircle","h-12","w-12"],[3,"src","alt"],[1,"font-bold","hover:text-primary","transition-colors","duration-300",3,"routerLink"],[1,"text-sm","opacity-50"],[1,"flex","justify-end","items-center"],[3,"delete","editLink"],["colspan","5",1,"text-center","py-6","text-sm","opacity-70"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),c(4,"th"),o(5,"th"),l(6,"T\xEDtulo"),r(),o(7,"th"),l(8,"Precio"),r(),o(9,"th"),l(10,"Stock"),r(),c(11,"th"),r()(),o(12,"tbody"),h(13,Mi,2,0)(14,Ni,3,0,"tr"),r()()(),c(15,"confirm-dialog")),t&2&&(a(13),v(n.products().length?13:14))},dependencies:[w,A,K,Nt,Rt],styles:["[_nghost-%COMP%]{display:block}"]})};var Ri=()=>[],Qe=class i{paginationService=d(Ve);productService=d(De);productResponse;loading;error;loadProducts;productPerPage=g(10);constructor(){let{productResponse:e,loading:t,error:n,loadProducts:s}=Lt();this.productResponse=e,this.loading=t,this.error=n,this.loadProducts=s,$(()=>{let m=this.paginationService.currentPage(),_=this.productPerPage(),me=(m-1)*_,Se=_;this.loadProducts({offset:me,limit:Se})})}updateProductsPerPage(e){this.productPerPage.set(e),this.paginationService.setCurrentPage(1)}onDeleteProduct(e){this.productService.deleteProduct(e).subscribe({next:()=>{let t=this.productResponse(),s=t&&t.products.length<=1&&this.paginationService.currentPage()>1?this.paginationService.currentPage()-1:this.paginationService.currentPage();this.paginationService.setCurrentPage(s);let m=this.productPerPage(),_=(s-1)*m;this.loadProducts({offset:_,limit:m})},error:()=>{}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["products-admin"]],decls:22,vars:7,consts:[["selectPerPage",""],[1,"text-2xl","font-bold"],[1,"text-lg"],[1,"text-primary"],[1,"flex","gap-2","items-center","h-20"],[1,"select","select-bordered","w-32",3,"change"],["value","10"],["value","20"],["value","50"],["value","100"],[3,"pages","currentPage"],[1,"flex","flex-1"],["routerLink","/admin/products/new",1,"btn","btn-primary"],[3,"delete","products","currentPage","countPage"]],template:function(t,n){if(t&1){let s=I();o(0,"h1",1),l(1,"Listado de productos"),r(),o(2,"h3",2),l(3," Total de productos "),o(4,"span",3),l(5),r()(),o(6,"div",4)(7,"select",5,0),f("change",function(){E(s);let _=Le(8);return T(n.updateProductsPerPage(+_.value))}),o(9,"option",6),l(10,"10"),r(),o(11,"option",7),l(12,"20"),r(),o(13,"option",8),l(14,"50"),r(),o(15,"option",9),l(16,"100"),r()(),c(17,"pagination",10)(18,"div",11),o(19,"button",12),l(20," Cargar producto "),r()(),o(21,"products-table",13),f("delete",function(_){return E(s),T(n.onDeleteProduct(_))}),r()}if(t&2){let s,m,_;a(5),y((s=n.productResponse())==null?null:s.count),a(12),p("pages",((m=n.productResponse())==null?null:m.pages)??0)("currentPage",n.paginationService.currentPage()),a(4),p("products",((_=n.productResponse())==null?null:_.products)??q(6,Ri))("currentPage",n.paginationService.currentPage())("countPage",n.productPerPage())}},dependencies:[Ke,At,w],styles:["[_nghost-%COMP%]{display:block}"]})};var Ze=class i{recipe=S.required();router=d(M);recipeService=d(Ee);configurationService=d(pe);fb=d(le);recipeForm=this.fb.group({title:["",P.required],text:["",P.required]});ngOnInit(){this.recipeForm.reset(this.recipe())}async onSubmit(){this.recipeForm.markAllAsTouched();let e=this.recipeForm.value,t=Q({},e);this.recipe().id==="new"?await C(this.recipeService.create(t)):await C(this.recipeService.update(this.recipe().id,t)),this.router.navigate(["/admin/recipes"])}controlPresionado=!1;handleKeyboardEvent(e){e.key==="Control"?this.controlPresionado=!0:e.key==="Enter"&&this.controlPresionado&&this.onSubmit()}handleKeyboardUp(e){e.key==="Control"&&(this.controlPresionado=!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["recipe-details"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)("keyup",function(m){return n.handleKeyboardUp(m)},L)},inputs:{recipe:[1,"recipe"]},decls:16,vars:8,consts:[[1,"flex","justify-between","items-center","mb-2"],[1,"text-2xl","font-bold"],[1,"divider"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"text-xl","font-bold","h-12"],["type","text","placeholder","T\xEDtulo","formControlName","title",1,"input","input-bordered","w-full"],[3,"control"],["placeholder","Detalles","rows","20","formControlName","text",1,"textarea","textarea-bordered","w-full"],[1,"flex","justify-end","h-12"],["type","submit",1,"btn","btn-secondary"]],template:function(t,n){if(t&1&&(o(0,"div",0)(1,"h1",1),l(2),r()(),c(3,"div",2),o(4,"form",3),f("ngSubmit",function(){return n.onSubmit()}),o(5,"div",4)(6,"h2",5),l(7,"Datos generales"),r(),c(8,"input",6)(9,"form-error-label",7)(10,"textarea",8)(11,"form-error-label",7),r(),o(12,"div",4)(13,"div",9)(14,"button",10),l(15,"Guardar"),r()()()()),t&2){let s,m;a(2),k(" ",n.recipe().title||"Crear nueva receta"," "),a(2),p("formGroup",n.recipeForm),a(4),F("border-red-500",((s=n.recipeForm.get("title"))==null?null:s.errors)??!1),a(),p("control",n.recipeForm.get("title")),a(),F("border-red-500",((m=n.recipeForm.get("text"))==null?null:m.errors)??!1),a(),p("control",n.recipeForm.get("text"))}},dependencies:[ce,re,ie,ne,oe,ae,se,G],styles:["[_nghost-%COMP%]{display:block}"]})};function Li(i,e){i&1&&(o(0,"div",0),c(1,"loading"),r())}function Ai(i,e){if(i&1&&c(0,"recipe-details",1),i&2){let t=b();p("recipe",t.recipe())}}var We=class i{activateRoute=d(ee);router=d(M);recipeService=d(Ee);recipeId=te(this.activateRoute.params.pipe(H(e=>e.id)));recipe=g(null);loading=g(!0);error=g(null);constructor(){$(()=>{let e=this.recipeId();this.loadRecipe(e)})}async loadRecipe(e){this.loading.set(!0),this.error.set(null);try{let t=await C(this.recipeService.getById(e));this.recipe.set(t)}catch{this.error.set("Error al cargar la receta"),this.router.navigate(["/admin/recipes"])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["recipe-admin"]],decls:2,vars:2,consts:[[1,"min-h-[50vh]","gap-4"],[3,"recipe"]],template:function(t,n){if(t&1&&(h(0,Li,2,0,"div",0),h(1,Ai,1,1,"recipe-details",1)),t&2){let s;v(n.loading()?0:-1),a(),v((s=n.recipe())!=null&&s.id?1:-1)}},dependencies:[N,Ze],styles:["[_nghost-%COMP%]{display:block}"]})};var Ht=i=>["/admin/recipes",i],Vi=(i,e)=>e.id;function Ui(i,e){if(i&1){let t=I();o(0,"tr")(1,"th")(2,"label"),l(3),r()(),o(4,"td")(5,"a",3),l(6),r()(),o(7,"td")(8,"div",4),l(9),Ie(10,"slice"),r()(),o(11,"th",5)(12,"table-action-buttons",6),f("delete",function(){let s=E(t).$implicit,m=b(2);return T(m.onDelete(s.id))}),r()()()}if(i&2){let t=e.$implicit,n=e.$index;a(3),k(" ",n+1," "),a(2),p("routerLink",V(9,Ht,t.id)),a(),k(" ",t.title," "),a(3),k(" ",_t(10,5,t.text,0,50),"... "),a(3),p("editLink",V(11,Ht,t.id))}}function Oi(i,e){if(i&1&&U(0,Ui,13,13,"tr",null,Vi),i&2){let t=b();O(t.recipes())}}function ji(i,e){i&1&&(o(0,"tr")(1,"td",7),l(2," No hay recetas disponibles. "),r()())}var Je=class i{recipes=S.required();delete=new j;confirmDialog;async onDelete(e){await this.confirmDialog.open("\xBFEst\xE1s seguro que deseas eliminar esta receta?")&&this.delete.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["recipes-table"]],viewQuery:function(t,n){if(t&1&&W(A,5),t&2){let s;J(s=X())&&(n.confirmDialog=s.first)}},inputs:{recipes:[1,"recipes"]},outputs:{delete:"delete"},decls:14,vars:1,consts:[[1,"overflow-y-auto","max-h-[75vh]","overflow-x-auto","border","border-slate-700","rounded-xl"],[1,"table","table-zebra","w-full"],[1,"sticky","top-0","bg-slate-900","z-10"],[1,"font-bold","hover:text-primary","transition-colors","duration-300",3,"routerLink"],[1,"text-sm","opacity-70"],[1,"flex","justify-end","items-center"],[3,"delete","editLink"],["colspan","4",1,"text-center","py-6","text-sm","opacity-70"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),c(4,"th"),o(5,"th"),l(6,"T\xEDtulo"),r(),o(7,"th"),l(8,"Texto"),r(),c(9,"th"),r()(),o(10,"tbody"),h(11,Oi,2,0)(12,ji,3,0,"tr"),r()()(),c(13,"confirm-dialog")),t&2&&(a(11),v(n.recipes().length?11:12))},dependencies:[w,A,K,St],styles:["[_nghost-%COMP%]{display:block}"]})};var $i=()=>[];function Bi(i,e){i&1&&(o(0,"div",6),c(1,"loading"),r())}var Xe=class i{recipeService=d(Ee);recipes=g(null);total=Y(()=>this.recipes()?.length??0);loading=g(!0);error=g(null);ngOnInit(){this.getRecipes()}async getRecipes(){this.loading.set(!0),this.error.set(null);try{let e=await C(this.recipeService.getAll());this.recipes.set(e)}catch{this.error.set("Error al cargar las recetas")}finally{this.loading.set(!1)}}async delete(e){try{await C(this.recipeService.delete(e)),this.recipes.set(this.recipes()?.filter(t=>t.id!==e))}catch(t){console.error("Error al eliminar",t),this.error.set("No se pudo eliminar la receta.")}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["recipes-admin"]],decls:12,vars:4,consts:[[1,"text-2xl","font-bold"],[1,"text-lg"],[1,"text-primary"],[1,"flex","gap-2","items-center","h-20"],[1,"flex","flex-1"],["routerLink","/admin/recipes/new",1,"btn","btn-primary"],[1,"min-h-[50vh]","gap-4"],[3,"delete","recipes"]],template:function(t,n){t&1&&(o(0,"h1",0),l(1,"Listado de recetas"),r(),o(2,"h3",1),l(3," Total de recetas: "),o(4,"span",2),l(5),r()(),o(6,"div",3),c(7,"div",4),o(8,"button",5),l(9," Cargar receta "),r()(),h(10,Bi,2,0,"div",6),o(11,"recipes-table",7),f("delete",function(m){return n.delete(m)}),r()),t&2&&(a(5),y(n.total()),a(5),v(n.loading()?10:-1),a(),p("recipes",n.recipes()??q(3,$i)))},dependencies:[w,Je,N],styles:["[_nghost-%COMP%]{display:block}"]})};var Ne=`${de.baseUrl}/users`,Hi={id:"new",email:"",fullName:"",roles:[],deletedAt:null},Ce=class i{http=d(fe);usersCache=new Map;toastService=d(he);getAll(){return this.usersCache.size?B(Array.from(this.usersCache.values())):this.http.get(Ne).pipe(R(e=>e.forEach(t=>this.usersCache.set(t.id,t))))}getById(e){return e==="new"?B(Hi):this.usersCache.has(e)?B(this.usersCache.get(e)):this.http.get(`${Ne}/${e}`).pipe(R(t=>this.usersCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(Ne,e).pipe(R(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${Ne}/${e}`,t).pipe(R(n=>{this.insertOrUpdateCache(n),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${Ne}/${e}`).pipe(R(async()=>{this.usersCache.delete(e),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.usersCache.set(e.id,e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})};var Ye=class i{user=S.required();router=d(M);userService=d(Ce);configurationService=d(pe);fb=d(le);userForm=this.fb.group({fullName:["",P.required],email:["",[P.required,P.email]],roles:[[""],P.required]});ngOnInit(){this.userForm.reset(this.user())}async onSubmit(){this.userForm.markAllAsTouched();let e=this.userForm.value,t=Q({},e);this.user().id==="new"?await C(this.userService.create(t)):await C(this.userService.update(this.user().id,t)),this.router.navigate(["/admin/users"])}controlPresionado=!1;handleKeyboardEvent(e){e.key==="Control"?this.controlPresionado=!0:e.key==="Enter"&&this.controlPresionado&&this.onSubmit()}handleKeyboardUp(e){e.key==="Control"&&(this.controlPresionado=!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["user-details"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)("keyup",function(m){return n.handleKeyboardUp(m)},L)},inputs:{user:[1,"user"]},decls:17,vars:11,consts:[[1,"text-2xl","font-bold"],[1,"divider"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"text-xl","font-bold","h-12"],["type","text","placeholder","Nombre completo","formControlName","fullName",1,"input","input-bordered","w-full"],[3,"control"],["type","email","placeholder","Correo electr\xF3nico","formControlName","email",1,"input","input-bordered","w-full"],["type","text","placeholder","Roles","formControlName","roles",1,"input","input-bordered","w-full"],[1,"flex","justify-end","h-12"],["type","submit",1,"btn","btn-secondary"]],template:function(t,n){if(t&1&&(o(0,"h1",0),l(1),r(),c(2,"div",1),o(3,"form",2),f("ngSubmit",function(){return n.onSubmit()}),o(4,"div",3)(5,"h2",4),l(6,"Datos generales"),r(),c(7,"input",5)(8,"form-error-label",6)(9,"input",7)(10,"form-error-label",6)(11,"input",8)(12,"form-error-label",6),r(),o(13,"div",3)(14,"div",9)(15,"button",10),l(16,"Guardar"),r()()()()),t&2){let s,m,_;a(),y(n.user().fullName||"Crear nuevo usuario"),a(2),p("formGroup",n.userForm),a(4),F("border-red-500",((s=n.userForm.get("fullName"))==null?null:s.errors)??!1),a(),p("control",n.userForm.get("fullName")),a(),F("border-red-500",((m=n.userForm.get("email"))==null?null:m.errors)??!1),a(),p("control",n.userForm.get("email")),a(),F("border-red-500",((_=n.userForm.get("roles"))==null?null:_.errors)??!1),a(),p("control",n.userForm.get("roles"))}},dependencies:[ce,re,ie,ne,oe,ae,se,G],styles:["[_nghost-%COMP%]{display:block}"]})};function zi(i,e){i&1&&(o(0,"div",0),c(1,"loading"),r())}function qi(i,e){if(i&1&&c(0,"user-details",1),i&2){let t=b();p("user",t.user())}}var et=class i{activateRoute=d(ee);router=d(M);userService=d(Ce);userId=te(this.activateRoute.params.pipe(H(e=>e.id)));user=g(null);loading=g(!0);error=g(null);constructor(){$(()=>{let e=this.userId();this.loadUser(e)})}async loadUser(e){this.loading.set(!0),this.error.set(null);try{let t=await C(this.userService.getById(e));this.user.set(t)}catch{this.error.set("Error al cargar el usuario"),this.router.navigate(["/admin/users"])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["user-admin"]],decls:2,vars:2,consts:[[1,"min-h-[50vh]","gap-4"],[3,"user"]],template:function(t,n){if(t&1&&(h(0,zi,2,0,"div",0),h(1,qi,1,1,"user-details",1)),t&2){let s;v(n.loading()?0:-1),a(),v((s=n.user())!=null&&s.id?1:-1)}},dependencies:[N,Ye],styles:["[_nghost-%COMP%]{display:block}"]})};var zt=i=>["/admin/users",i],Gi=(i,e)=>e.id;function Ki(i,e){if(i&1){let t=I();o(0,"tr")(1,"th"),l(2),r(),o(3,"td")(4,"a",3),l(5),r()(),o(6,"td"),l(7),r(),o(8,"td"),l(9),r(),o(10,"th",4)(11,"table-action-buttons",5),f("delete",function(){let s=E(t).$implicit,m=b(2);return T(m.onDelete(s.id))}),r()()()}if(i&2){let t=e.$implicit,n=e.$index,s=b(2);a(2),y(n+1),a(2),p("routerLink",V(6,zt,t.id)),a(),k(" ",t.fullName," "),a(2),y(t.email),a(2),y(s.getUserRolesPlain(t)),a(2),p("editLink",V(8,zt,t.id))}}function Qi(i,e){if(i&1&&U(0,Ki,12,10,"tr",null,Gi),i&2){let t=b();O(t.users())}}function Zi(i,e){i&1&&(o(0,"tr")(1,"td",6),l(2," No hay usuarios. "),r()())}var tt=class i{users=S.required();delete=new j;confirmDialog;async onDelete(e){await this.confirmDialog.open("\xBFEst\xE1s seguro que deseas eliminar este usuario?")&&this.delete.emit(e)}getUserRolesPlain(e){return e.roles.join(", ")}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["users-table"]],viewQuery:function(t,n){if(t&1&&W(A,5),t&2){let s;J(s=X())&&(n.confirmDialog=s.first)}},inputs:{users:[1,"users"]},outputs:{delete:"delete"},decls:16,vars:1,consts:[[1,"overflow-y-auto","max-h-[75vh]","overflow-x-auto","border","border-slate-700","rounded-xl"],[1,"table","table-zebra","w-full"],[1,"sticky","top-0","bg-slate-900","z-10"],[1,"font-bold","hover:text-primary","transition-colors","duration-300",3,"routerLink"],[1,"flex","justify-end","items-center"],[3,"delete","editLink"],["colspan","5",1,"text-center","py-6","text-sm","opacity-70"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),c(4,"th"),o(5,"th"),l(6,"Nombre completo"),r(),o(7,"th"),l(8,"Email"),r(),o(9,"th"),l(10,"Rol"),r(),c(11,"th"),r()(),o(12,"tbody"),h(13,Qi,2,0)(14,Zi,3,0,"tr"),r()()(),c(15,"confirm-dialog")),t&2&&(a(13),v(n.users().length?13:14))},dependencies:[w,A,K],styles:["[_nghost-%COMP%]{display:block}"]})};var Wi=()=>[];function Ji(i,e){i&1&&(o(0,"div",6),c(1,"loading"),r())}var it=class i{userService=d(Ce);users=g(null);total=Y(()=>this.users()?.length??0);loading=g(!0);error=g(null);ngOnInit(){this.getUsers()}async getUsers(){this.loading.set(!0),this.error.set(null);try{let e=await C(this.userService.getAll());this.users.set(e)}catch{this.error.set("Error al cargar los usuarios")}finally{this.loading.set(!1)}}async delete(e){try{await C(this.userService.delete(e)),this.users.set(this.users()?.filter(t=>t.id!==e))}catch(t){console.error("Error al eliminar",t),this.error.set("No se pudo eliminar el usuario.")}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["app-users-admin"]],decls:12,vars:4,consts:[[1,"text-2xl","font-bold"],[1,"text-lg"],[1,"text-primary"],[1,"flex","gap-2","items-center","h-20"],[1,"flex","flex-1"],["routerLink","/admin/contacts/new",1,"btn","btn-primary"],[1,"min-h-[50vh]","gap-4"],[3,"delete","users"]],template:function(t,n){t&1&&(o(0,"h1",0),l(1,"Listado de usuarios"),r(),o(2,"h3",1),l(3," Total de usuarios: "),o(4,"span",2),l(5),r()(),o(6,"div",3),c(7,"div",4),o(8,"button",5),l(9," Cargar usuario "),r()(),h(10,Ji,2,0,"div",6),o(11,"users-table",7),f("delete",function(m){return n.delete(m)}),r()),t&2&&(a(5),y(n.total()),a(5),v(n.loading()?10:-1),a(),p("users",n.users()??q(3,Wi)))},dependencies:[w,N,tt],styles:["[_nghost-%COMP%]{display:block}"]})};var Re=`${de.baseUrl}/roles`,Xi={id:"new",name:"",description:""},ye=class i{http=d(fe);toastService=d(he);rolesCache=new Map;getAll(){return this.rolesCache.size?B(Array.from(this.rolesCache.values())):this.http.get(Re).pipe(R(e=>e.forEach(t=>this.rolesCache.set(t.id,t))))}getById(e){return e==="new"?B(Xi):this.rolesCache.has(e)?B(this.rolesCache.get(e)):this.http.get(`${Re}/${e}`).pipe(R(t=>this.rolesCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(Re,e).pipe(R(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${Re}/${e}`,t).pipe(R(n=>{this.insertOrUpdateCache(n),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${Re}/${e}`).pipe(R(async()=>{this.rolesCache.delete(e),this.toastService.activateSuccess()}),z(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.rolesCache.set(e.id,e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ue({token:i,factory:i.\u0275fac,providedIn:"root"})};var qt=i=>["/admin/roles",i],Yi=(i,e)=>e.id;function en(i,e){if(i&1){let t=I();o(0,"tr")(1,"th"),l(2),r(),o(3,"td")(4,"a",3),l(5),r()(),o(6,"td"),l(7),r(),o(8,"th",4)(9,"table-action-buttons",5),f("delete",function(){let s=E(t).$implicit,m=b(2);return T(m.onDelete(s.id))}),r()()()}if(i&2){let t=e.$implicit,n=e.$index;a(2),y(n+1),a(2),p("routerLink",V(5,qt,t.id)),a(),k(" ",t.name," "),a(2),y(t.description),a(2),p("editLink",V(7,qt,t.id))}}function tn(i,e){if(i&1&&U(0,en,10,9,"tr",null,Yi),i&2){let t=b();O(t.roles())}}function nn(i,e){i&1&&(o(0,"tr")(1,"td",6),l(2," No hay roles disponibles. "),r()())}var nt=class i{roles=S.required();delete=new j;confirmDialog;async onDelete(e){await this.confirmDialog.open("\xBFEst\xE1s seguro que deseas eliminar este rol?")&&this.delete.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["roles-table"]],viewQuery:function(t,n){if(t&1&&W(A,5),t&2){let s;J(s=X())&&(n.confirmDialog=s.first)}},inputs:{roles:[1,"roles"]},outputs:{delete:"delete"},decls:14,vars:1,consts:[[1,"overflow-y-auto","max-h-[75vh]","overflow-x-auto","border","border-slate-700","rounded-xl"],[1,"table","table-zebra","w-full"],[1,"sticky","top-0","bg-slate-900","z-10"],[1,"font-bold","hover:text-primary","transition-colors","duration-300",3,"routerLink"],[1,"flex","justify-end","items-center"],[3,"delete","editLink"],["colspan","4",1,"text-center","py-6","text-sm","opacity-70"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),c(4,"th"),o(5,"th"),l(6,"Nombre"),r(),o(7,"th"),l(8,"Descripci\xF3n"),r(),c(9,"th"),r()(),o(10,"tbody"),h(11,tn,2,0)(12,nn,3,0,"tr"),r()()(),c(13,"confirm-dialog")),t&2&&(a(11),v(n.roles().length?11:12))},dependencies:[w,A,K],styles:["[_nghost-%COMP%]{display:block}"]})};var on=()=>[];function rn(i,e){i&1&&(o(0,"div",6),c(1,"loading"),r())}var ot=class i{rolService=d(ye);roles=g(null);total=Y(()=>this.roles()?.length??0);loading=g(!0);error=g(null);ngOnInit(){this.getRoles()}async getRoles(){this.loading.set(!0),this.error.set(null);try{let e=await C(this.rolService.getAll());this.roles.set(e)}catch{this.error.set("Error al cargar los roles")}finally{this.loading.set(!1)}}async delete(e){try{await C(this.rolService.delete(e)),this.roles.set(this.roles()?.filter(t=>t.id!==e))}catch(t){console.error("Error al eliminar",t),this.error.set("No se pudo eliminar el rol.")}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["roles-admin"]],decls:12,vars:4,consts:[[1,"text-2xl","font-bold"],[1,"text-lg"],[1,"text-primary"],[1,"flex","gap-2","items-center","h-20"],[1,"flex","flex-1"],["routerLink","/admin/roles/new",1,"btn","btn-primary"],[1,"min-h-[50vh]","gap-4"],[3,"delete","roles"]],template:function(t,n){t&1&&(o(0,"h1",0),l(1,"Listado de roles"),r(),o(2,"h3",1),l(3," Total de roles: "),o(4,"span",2),l(5),r()(),o(6,"div",3),c(7,"div",4),o(8,"button",5),l(9," Cargar rol "),r()(),h(10,rn,2,0,"div",6),o(11,"roles-table",7),f("delete",function(m){return n.delete(m)}),r()),t&2&&(a(5),y(n.total()),a(5),v(n.loading()?10:-1),a(),p("roles",n.roles()??q(3,on)))},dependencies:[w,N,nt],styles:["[_nghost-%COMP%]{display:block}"]})};var rt=class i{role=S.required();router=d(M);roleService=d(ye);configurationService=d(pe);fb=d(le);roleForm=this.fb.group({name:["",P.required],description:["",P.required]});ngOnInit(){this.roleForm.reset(this.role())}async onSubmit(){this.roleForm.markAllAsTouched();let e=this.roleForm.value,t=Q({},e);this.role().id==="new"?await C(this.roleService.create(t)):await C(this.roleService.update(this.role().id,t)),this.router.navigate(["/admin/roles"])}controlPresionado=!1;handleKeyboardEvent(e){e.key==="Control"?this.controlPresionado=!0:e.key==="Enter"&&this.controlPresionado&&this.onSubmit()}handleKeyboardUp(e){e.key==="Control"&&(this.controlPresionado=!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["role-details"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)("keyup",function(m){return n.handleKeyboardUp(m)},L)},inputs:{role:[1,"role"]},decls:15,vars:8,consts:[[1,"text-2xl","font-bold"],[1,"divider"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"text-xl","font-bold","h-12"],["type","text","placeholder","Nombre","formControlName","name",1,"input","input-bordered","w-full"],[3,"control"],["type","text","placeholder","Descripci\xF3n","formControlName","description",1,"input","input-bordered","w-full"],[1,"flex","justify-end","h-12"],["type","submit",1,"btn","btn-secondary"]],template:function(t,n){if(t&1&&(o(0,"h1",0),l(1),r(),c(2,"div",1),o(3,"form",2),f("ngSubmit",function(){return n.onSubmit()}),o(4,"div",3)(5,"h2",4),l(6,"Datos generales"),r(),c(7,"input",5)(8,"form-error-label",6)(9,"input",7)(10,"form-error-label",6),r(),o(11,"div",3)(12,"div",8)(13,"button",9),l(14,"Guardar"),r()()()()),t&2){let s,m;a(),y(n.role().name||"Crear nuevo rol"),a(2),p("formGroup",n.roleForm),a(4),F("border-red-500",((s=n.roleForm.get("name"))==null?null:s.errors)??!1),a(),p("control",n.roleForm.get("name")),a(),F("border-red-500",((m=n.roleForm.get("description"))==null?null:m.errors)??!1),a(),p("control",n.roleForm.get("description"))}},dependencies:[ce,re,ie,ne,oe,ae,se,G],styles:["[_nghost-%COMP%]{display:block}"]})};function an(i,e){i&1&&(o(0,"div",0),c(1,"loading"),r())}function sn(i,e){if(i&1&&c(0,"role-details",1),i&2){let t=b();p("role",t.role())}}var at=class i{activateRoute=d(ee);router=d(M);roleService=d(ye);roleId=te(this.activateRoute.params.pipe(H(e=>e.id)));role=g(null);loading=g(!0);error=g(null);constructor(){$(()=>{let e=this.roleId();this.loadRol(e)})}async loadRol(e){this.loading.set(!0),this.error.set(null);try{let t=await C(this.roleService.getById(e));this.role.set(t)}catch{this.error.set("Error al cargar el rol"),this.router.navigate(["/admin/roles"])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["role-admin"]],decls:2,vars:2,consts:[[1,"min-h-[50vh]","gap-4"],[3,"role"]],template:function(t,n){if(t&1&&(h(0,an,2,0,"div",0),h(1,sn,1,1,"role-details",1)),t&2){let s;v(n.loading()?0:-1),a(),v((s=n.role())!=null&&s.id?1:-1)}},dependencies:[N,rt],styles:["[_nghost-%COMP%]{display:block}"]})};var Gt=i=>["/admin/categories",i],ln=(i,e)=>e.id;function cn(i,e){if(i&1){let t=I();o(0,"tr")(1,"th"),l(2),r(),o(3,"td")(4,"a",3),l(5),r()(),o(6,"th",4)(7,"table-action-buttons",5),f("delete",function(){let s=E(t).$implicit,m=b(2);return T(m.onDelete(s.id))}),r()()()}if(i&2){let t=e.$implicit,n=e.$index;a(2),y(n+1),a(2),p("routerLink",V(4,Gt,t.id)),a(),k(" ",t.name," "),a(2),p("editLink",V(6,Gt,t.id))}}function mn(i,e){if(i&1&&U(0,cn,8,8,"tr",null,ln),i&2){let t=b();O(t.categories())}}function dn(i,e){i&1&&(o(0,"tr")(1,"td",6),l(2," No hay categor\xEDas disponibles. "),r()())}var st=class i{categories=S.required();delete=new j;confirmDialog;async onDelete(e){await this.confirmDialog.open("\xBFEst\xE1s seguro que deseas eliminar esta categor\xEDa?")&&this.delete.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["categories-table"]],viewQuery:function(t,n){if(t&1&&W(A,5),t&2){let s;J(s=X())&&(n.confirmDialog=s.first)}},inputs:{categories:[1,"categories"]},outputs:{delete:"delete"},decls:12,vars:1,consts:[[1,"overflow-y-auto","max-h-[75vh]","overflow-x-auto","border","border-slate-700","rounded-xl"],[1,"table","table-zebra","w-full"],[1,"sticky","top-0","bg-slate-900","z-10"],[1,"font-bold","hover:text-primary","transition-colors","duration-300",3,"routerLink"],[1,"flex","justify-end","items-center"],[3,"delete","editLink"],["colspan","3",1,"text-center","py-6","text-sm","opacity-70"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),c(4,"th"),o(5,"th"),l(6,"Nombre"),r(),c(7,"th"),r()(),o(8,"tbody"),h(9,mn,2,0)(10,dn,3,0,"tr"),r()()(),c(11,"confirm-dialog")),t&2&&(a(9),v(n.categories().length?9:10))},dependencies:[w,A,K],encapsulation:2})};var pn=()=>[];function un(i,e){i&1&&(o(0,"div",6),c(1,"loading"),r())}var lt=class i{categoryService=d(ve);categories=g(null);total=Y(()=>this.categories()?.length??0);loading=g(!0);error=g(null);ngOnInit(){this.getCategories()}async getCategories(){this.loading.set(!0),this.error.set(null);try{let e=await C(this.categoryService.getAll());this.categories.set(e)}catch{this.error.set("Error al cargar las categor\xEDas")}finally{this.loading.set(!1)}}async delete(e){try{await C(this.categoryService.delete(e)),this.categories.set(this.categories()?.filter(t=>t.id!==e)??null)}catch(t){console.error("Error al eliminar categor\xEDa",t),this.error.set("No se pudo eliminar la categor\xEDa.")}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["categories-admin"]],decls:12,vars:4,consts:[[1,"text-2xl","font-bold"],[1,"text-lg"],[1,"text-primary"],[1,"flex","gap-2","items-center","h-20"],[1,"flex","flex-1"],["routerLink","/admin/categories/new",1,"btn","btn-primary"],[1,"min-h-[50vh]","gap-4"],[3,"delete","categories"]],template:function(t,n){t&1&&(o(0,"h1",0),l(1,"Listado de categor\xEDas"),r(),o(2,"h3",1),l(3," Total de categor\xEDas: "),o(4,"span",2),l(5),r()(),o(6,"div",3),c(7,"div",4),o(8,"button",5),l(9," Cargar categor\xEDa "),r()(),h(10,un,2,0,"div",6),o(11,"categories-table",7),f("delete",function(m){return n.delete(m)}),r()),t&2&&(a(5),y(n.total()),a(5),v(n.loading()?10:-1),a(),p("categories",n.categories()??q(3,pn)))},dependencies:[w,N,st],encapsulation:2})};var ct=class i{category=S.required();router=d(M);categoryService=d(ve);fb=d(le);categoryForm=this.fb.group({name:["",P.required]});ngOnInit(){this.categoryForm.reset(this.category())}async onSubmit(){if(this.categoryForm.markAllAsTouched(),this.categoryForm.invalid)return;let e=Q({},this.categoryForm.value);this.category().id==="new"?await C(this.categoryService.create(e)):await C(this.categoryService.update(this.category().id,e)),this.router.navigate(["/admin/categories"])}controlPresionado=!1;handleKeyboardEvent(e){e.key==="Control"?this.controlPresionado=!0:e.key==="Enter"&&this.controlPresionado&&this.onSubmit()}handleKeyboardUp(e){e.key==="Control"&&(this.controlPresionado=!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["category-details"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)("keyup",function(m){return n.handleKeyboardUp(m)},L)},inputs:{category:[1,"category"]},decls:14,vars:5,consts:[[1,"flex","justify-between","items-center","mb-2"],[1,"text-2xl","font-bold"],[1,"divider"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"text-xl","font-bold","h-12"],["type","text","placeholder","Nombre","formControlName","name",1,"input","input-bordered","w-full"],[3,"control"],[1,"flex","justify-end","h-12"],["type","submit",1,"btn","btn-secondary"]],template:function(t,n){if(t&1&&(o(0,"div",0)(1,"h1",1),l(2),r()(),c(3,"div",2),o(4,"form",3),f("ngSubmit",function(){return n.onSubmit()}),o(5,"div",4)(6,"h2",5),l(7,"Datos generales"),r(),c(8,"input",6)(9,"form-error-label",7),r(),o(10,"div",4)(11,"div",8)(12,"button",9),l(13,"Guardar"),r()()()()),t&2){let s;a(2),k(" ",n.category().name||"Crear nueva categor\xEDa"," "),a(2),p("formGroup",n.categoryForm),a(4),F("border-red-500",((s=n.categoryForm.get("name"))==null?null:s.errors)??!1),a(),p("control",n.categoryForm.get("name"))}},dependencies:[ce,re,ie,ne,oe,ae,se,G],encapsulation:2})};function gn(i,e){i&1&&(o(0,"div",0),c(1,"loading"),r())}function fn(i,e){if(i&1&&c(0,"category-details",1),i&2){let t=b();p("category",t.category())}}var mt=class i{activateRoute=d(ee);router=d(M);categoryService=d(ve);categoryId=te(this.activateRoute.params.pipe(H(e=>e.id)));category=g(null);loading=g(!0);error=g(null);constructor(){$(()=>{let e=this.categoryId();e&&this.loadCategory(e)})}async loadCategory(e){this.loading.set(!0),this.error.set(null);try{let t=await C(this.categoryService.getById(e));this.category.set(t)}catch{this.error.set("Error al cargar la categor\xEDa"),this.router.navigate(["/admin/categories"])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["category-admin"]],decls:2,vars:2,consts:[[1,"min-h-[50vh]","gap-4"],[3,"category"]],template:function(t,n){if(t&1&&(h(0,gn,2,0,"div",0),h(1,fn,1,1,"category-details",1)),t&2){let s;v(n.loading()?0:-1),a(),v((s=n.category())!=null&&s.id?1:-1)}},dependencies:[N,ct],encapsulation:2})};var Kt=i=>["/admin/tags",i],hn=(i,e)=>e.id;function vn(i,e){if(i&1){let t=I();o(0,"tr")(1,"th"),l(2),r(),o(3,"td")(4,"a",3),l(5),r()(),o(6,"th",4)(7,"table-action-buttons",5),f("delete",function(){let s=E(t).$implicit,m=b(2);return T(m.onDelete(s.id))}),r()()()}if(i&2){let t=e.$implicit,n=e.$index;a(2),y(n+1),a(2),p("routerLink",V(4,Kt,t.id)),a(),k(" ",t.name," "),a(2),p("editLink",V(6,Kt,t.id))}}function bn(i,e){if(i&1&&U(0,vn,8,8,"tr",null,hn),i&2){let t=b();O(t.tags())}}function Cn(i,e){i&1&&(o(0,"tr")(1,"td",6),l(2," No hay tags disponibles. "),r()())}var dt=class i{tags=S.required();delete=new j;confirmDialog;async onDelete(e){await this.confirmDialog.open("\xBFEst\xE1s seguro que deseas eliminar este tag?")&&this.delete.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["tags-table"]],viewQuery:function(t,n){if(t&1&&W(A,5),t&2){let s;J(s=X())&&(n.confirmDialog=s.first)}},inputs:{tags:[1,"tags"]},outputs:{delete:"delete"},decls:12,vars:1,consts:[[1,"overflow-y-auto","max-h-[75vh]","overflow-x-auto","border","border-slate-700","rounded-xl"],[1,"table","table-zebra","w-full"],[1,"sticky","top-0","bg-slate-900","z-10"],[1,"font-bold","hover:text-primary","transition-colors","duration-300",3,"routerLink"],[1,"flex","justify-end","items-center"],[3,"delete","editLink"],["colspan","3",1,"text-center","py-6","text-sm","opacity-70"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"table",1)(2,"thead",2)(3,"tr"),c(4,"th"),o(5,"th"),l(6,"Nombre"),r(),c(7,"th"),r()(),o(8,"tbody"),h(9,bn,2,0)(10,Cn,3,0,"tr"),r()()(),c(11,"confirm-dialog")),t&2&&(a(9),v(n.tags().length?9:10))},dependencies:[w,A,K],encapsulation:2})};var yn=()=>[];function _n(i,e){i&1&&(o(0,"div",6),c(1,"loading"),r())}var pt=class i{tagService=d(be);tags=g(null);total=Y(()=>this.tags()?.length??0);loading=g(!0);error=g(null);ngOnInit(){this.getTags()}async getTags(){this.loading.set(!0),this.error.set(null);try{let e=await C(this.tagService.getAll());this.tags.set(e)}catch{this.error.set("Error al cargar los tags")}finally{this.loading.set(!1)}}async delete(e){try{await C(this.tagService.delete(e)),this.tags.set(this.tags()?.filter(t=>t.id!==e)??null)}catch(t){console.error("Error al eliminar tag",t),this.error.set("No se pudo eliminar el tag.")}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["tags-admin"]],decls:12,vars:4,consts:[[1,"text-2xl","font-bold"],[1,"text-lg"],[1,"text-primary"],[1,"flex","gap-2","items-center","h-20"],[1,"flex","flex-1"],["routerLink","/admin/tags/new",1,"btn","btn-primary"],[1,"min-h-[50vh]","gap-4"],[3,"delete","tags"]],template:function(t,n){t&1&&(o(0,"h1",0),l(1,"Listado de tags"),r(),o(2,"h3",1),l(3," Total de tags: "),o(4,"span",2),l(5),r()(),o(6,"div",3),c(7,"div",4),o(8,"button",5),l(9," Cargar tag "),r()(),h(10,_n,2,0,"div",6),o(11,"tags-table",7),f("delete",function(m){return n.delete(m)}),r()),t&2&&(a(5),y(n.total()),a(5),v(n.loading()?10:-1),a(),p("tags",n.tags()??q(3,yn)))},dependencies:[w,N,dt],encapsulation:2})};var ut=class i{tag=S.required();router=d(M);tagService=d(be);fb=d(le);tagForm=this.fb.group({name:["",P.required]});ngOnInit(){this.tagForm.reset(this.tag())}async onSubmit(){if(this.tagForm.markAllAsTouched(),this.tagForm.invalid)return;let e=Q({},this.tagForm.value);this.tag().id==="new"?await C(this.tagService.create(e)):await C(this.tagService.update(this.tag().id,e)),this.router.navigate(["/admin/tags"])}controlPresionado=!1;handleKeyboardEvent(e){e.key==="Control"?this.controlPresionado=!0:e.key==="Enter"&&this.controlPresionado&&this.onSubmit()}handleKeyboardUp(e){e.key==="Control"&&(this.controlPresionado=!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["tag-details"]],hostBindings:function(t,n){t&1&&f("keydown",function(m){return n.handleKeyboardEvent(m)},L)("keyup",function(m){return n.handleKeyboardUp(m)},L)},inputs:{tag:[1,"tag"]},decls:14,vars:5,consts:[[1,"flex","justify-between","items-center","mb-2"],[1,"text-2xl","font-bold"],[1,"divider"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"text-xl","font-bold","h-12"],["type","text","placeholder","Nombre","formControlName","name",1,"input","input-bordered","w-full"],[3,"control"],[1,"flex","justify-end","h-12"],["type","submit",1,"btn","btn-secondary"]],template:function(t,n){if(t&1&&(o(0,"div",0)(1,"h1",1),l(2),r()(),c(3,"div",2),o(4,"form",3),f("ngSubmit",function(){return n.onSubmit()}),o(5,"div",4)(6,"h2",5),l(7,"Datos generales"),r(),c(8,"input",6)(9,"form-error-label",7),r(),o(10,"div",4)(11,"div",8)(12,"button",9),l(13,"Guardar"),r()()()()),t&2){let s;a(2),k(" ",n.tag().name||"Crear nuevo tag"," "),a(2),p("formGroup",n.tagForm),a(4),F("border-red-500",((s=n.tagForm.get("name"))==null?null:s.errors)??!1),a(),p("control",n.tagForm.get("name"))}},dependencies:[ce,re,ie,ne,oe,ae,se,G],encapsulation:2})};function xn(i,e){i&1&&(o(0,"div",0),c(1,"loading"),r())}function Sn(i,e){if(i&1&&c(0,"tag-details",1),i&2){let t=b();p("tag",t.tag())}}var gt=class i{activateRoute=d(ee);router=d(M);tagService=d(be);tagId=te(this.activateRoute.params.pipe(H(e=>e.id)));tag=g(null);loading=g(!0);error=g(null);constructor(){$(()=>{let e=this.tagId();e&&this.loadTag(e)})}async loadTag(e){this.loading.set(!0),this.error.set(null);try{let t=await C(this.tagService.getById(e));this.tag.set(t)}catch{this.error.set("Error al cargar el tag"),this.router.navigate(["/admin/tags"])}finally{this.loading.set(!1)}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=u({type:i,selectors:[["tag-admin"]],decls:2,vars:2,consts:[[1,"min-h-[50vh]","gap-4"],[3,"tag"]],template:function(t,n){if(t&1&&(h(0,xn,2,0,"div",0),h(1,Sn,1,1,"tag-details",1)),t&2){let s;v(n.loading()?0:-1),a(),v((s=n.tag())!=null&&s.id?1:-1)}},dependencies:[N,ut],encapsulation:2})};var wn=[{path:"",component:Oe,canMatch:[Vt],children:[{path:"products",title:"Productos",component:Qe},{path:"products/:id",title:"Producto",component:Ge},{path:"recipes",title:"Recetas",component:Xe},{path:"recipes/:id",title:"Receta",component:We},{path:"categories",title:"Categor\xEDas",component:lt},{path:"categories/:id",title:"Categor\xEDa",component:mt},{path:"tags",title:"Tags",component:pt},{path:"tags/:id",title:"Tag",component:gt},{path:"contacts",title:"Contactos",component:He},{path:"contacts/:id",title:"Contacto",component:$e},{path:"users",title:"Usuarios",component:it},{path:"users/:id",title:"Usuario",component:et},{path:"roles",title:"Roles",component:ot},{path:"roles/:id",title:"Rol",component:at},{path:"**",redirectTo:"products"}]}],bm=wn;export{wn as AdminDashboardRoutes,bm as default};
