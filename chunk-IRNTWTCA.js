import{p as me}from"./chunk-TEAMUV7L.js";import{$ as Ie,$a as de,Aa as U,Ba as K,C as u,D as Se,G as ne,H as _e,Ha as A,J as s,Ja as ke,Ka as xe,La as L,M as _,P as re,Ra as Te,S as Me,Ta as F,X as D,Xa as Oe,Ya as pe,Z as N,_ as ae,_a as B,aa as O,ba as E,ca as j,da as c,db as x,ea as d,eb as Ee,fa as I,fb as Le,g,ga as h,h as ye,ha as v,i as Pe,ia as H,ja as k,k as we,ka as oe,la as b,ma as X,n as m,na as p,oa as se,p as a,pa as ce,qa as le,s as P,ta as w,v as o,va as f,w as S,x as M,xa as q,y as $,z}from"./chunk-QMYQHEOB.js";var Fe=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["app-logo"]],decls:5,vars:0,consts:[["id","logo"],["routerLink","/",1,"text-lg","md:text-2xl","font-bold"],[1,"text-amber-500"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"a",1),f(2," Gluten "),c(3,"span",2),f(4," Free"),d()()())},dependencies:[de],styles:["[_nghost-%COMP%]{display:block}"]})};var T=class n{loading=u(!1);success=u(!1);activateLoading(){this.loading.set(!0),this.success.set(!1)}deactivateLoading(){this.loading.set(!1)}activateSuccess(){this.loading.set(!1),this.success.set(!0),setTimeout(()=>this.success.set(!1),800)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};var Y=`${x.baseUrl}/categories`,Be={id:"new",name:""},ge=class n{http=o(F);toastService=o(T);categoriesCache=new Map;getAll(){return this.categoriesCache.size?g(Array.from(this.categoriesCache.values())):this.http.get(Y).pipe(a(e=>e.forEach(t=>this.categoriesCache.set(t.id,t))))}getById(e){return e==="new"?g(Be):this.categoriesCache.has(e)?g(this.categoriesCache.get(e)):this.http.get(`${Y}/${e}`).pipe(a(t=>this.categoriesCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(Y,e).pipe(a(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${Y}/${e}`,t).pipe(a(i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${Y}/${e}`).pipe(a(()=>{this.categoriesCache.delete(e),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.categoriesCache.set(e.id,e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};var J=`${x.baseUrl}/tags`,Ge={id:"new",name:""},ue=class n{http=o(F);toastService=o(T);tagsCache=new Map;getAll(e){let t=e??"all";return this.tagsCache.has(t)?g(this.tagsCache.get(t)):this.http.get(J,{params:e?{categoryId:e}:void 0,responseType:"json"}).pipe(a(i=>this.tagsCache.set(t,i)))}getById(e){return e==="new"?g(Ge):this.http.get(`${J}/${e}`).pipe(a(t=>{this.tagsCache.clear(),this.tagsCache.set(t.id,[t])}))}create(e){return this.toastService.activateLoading(),this.http.post(J,e).pipe(a(t=>{this.tagsCache.clear(),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${J}/${e}`,t).pipe(a(i=>{this.tagsCache.clear(),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${J}/${e}`).pipe(a(()=>{this.tagsCache.clear(),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};var Q=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["x-circle"]],decls:3,vars:0,consts:[[1,"x-circle-btn","cursor-pointer","inline-flex","items-center","justify-center","p-2","rounded-full","transition-colors","duration-200","hover:bg-base-200","text-base-content"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"]],template:function(t,i){t&1&&(h(0,"div",0),$(),h(1,"svg",1),H(2,"path",2),v()())},styles:["[_nghost-%COMP%]{display:inline-flex}"]})};var $e=(n,e)=>e.id;function Qe(n,e){if(n&1){let t=k();h(0,"li")(1,"button",4),X("click",function(){let r=S(t).$implicit,l=p();return M(l.selectCategory(r.id))}),f(2),v()()}if(n&2){let t=e.$implicit,i=p();s(),w("active",i.selectedCategory()===t.id),s(),q(" ",t.name," ")}}function We(n,e){if(n&1){let t=k();h(0,"button",8),X("click",function(){let r=S(t).$implicit,l=p();return M(l.toggleTag(r.id))}),f(1),v()}if(n&2){let t=e.$implicit,i=p();w("active",i.selectedTags().has(t.id)),s(),q(" ",t.name," ")}}var fe=class n{categoryService=o(ge);tagService=o(ue);route=o(pe);router=o(B);configurationService=o(me);categories=u([]);tags=u([]);selectedCategory=u("all");selectedTags=u(new Set);ngOnInit(){this.categoryService.getAll().subscribe(e=>this.categories.set(e)),this.route.queryParamMap.subscribe(e=>{let t=e.get("categoryId")??"all",i=e.get("tagIds")??"",r=i?i.split(",").filter(Boolean):[];this.selectedCategory.set(t),this.selectedTags.set(new Set(r)),this.loadTags(t==="all"?void 0:t)})}selectCategory(e){this.selectedCategory.set(e),this.selectedTags.set(new Set),this.loadTags(e==="all"?void 0:e),this.updateQueryParams(!0)}toggleTag(e){let t=new Set(this.selectedTags());t.has(e)?t.delete(e):t.add(e),this.selectedTags.set(t),this.updateQueryParams()}resetTags(){this.selectedTags().size&&(this.selectedTags.set(new Set),this.updateQueryParams())}loadTags(e){this.tagService.getAll(e).subscribe(t=>this.tags.set(t))}updateQueryParams(e=!1){let t=Array.from(this.selectedTags());this.router.navigate([],{relativeTo:this.route,queryParams:{categoryId:this.selectedCategory()==="all"?null:this.selectedCategory(),tagIds:t.length?t.join(","):null},queryParamsHandling:"merge"}).then(()=>{e&&(this.configurationService.toggleSidebarItemsStatus("closed"),this.configurationService.toggleSidebarPageStatus("closed"))})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["mobile-product-filters"]],decls:18,vars:5,consts:[[1,"mobile-filters"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-semibold"],[1,"flex","flex-col","gap-1","mb-4"],["type","button",1,"filter-item","cursor-pointer",3,"click"],["type","button",1,"text-primary","text-xs",3,"click","disabled"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"filter-tag","cursor-pointer",3,"active"],["type","button",1,"filter-tag","cursor-pointer",3,"click"]],template:function(t,i){t&1&&(h(0,"div",0)(1,"div",1)(2,"h4",2),f(3,"Categor\xEDas"),v()(),h(4,"ul",3)(5,"li")(6,"button",4),X("click",function(){return i.selectCategory("all")}),f(7," Todos "),v()(),O(8,Qe,3,3,"li",null,$e),v(),h(10,"div",1)(11,"h4",2),f(12,"Tags"),v(),h(13,"button",5),X("click",function(){return i.resetTags()}),f(14," Limpiar "),v()(),h(15,"div",6),O(16,We,2,3,"button",7,$e),v()()),t&2&&(s(6),w("active",i.selectedCategory()==="all"),s(2),E(i.categories()),s(5),w("opacity-50",!i.selectedTags().size),oe("disabled",!i.selectedTags().size),s(3),E(i.tags()))},styles:["[_nghost-%COMP%]{display:block}.mobile-filters[_ngcontent-%COMP%]{padding:10px 12px;border-top:1px solid #e5e7eb}.filter-item[_ngcontent-%COMP%]{width:100%;text-align:left;padding:8px 10px;border-radius:8px;background:transparent;border:1px solid transparent;transition:background-color .2s ease,color .2s ease,border-color .2s ease}.filter-item[_ngcontent-%COMP%]:hover{background:var(--fallback-b2, rgba(229, 231, 235, .6));color:var(--fallback-bc, #1f2937)}.filter-item.active[_ngcontent-%COMP%]{background:var(--fallback-b2, rgba(229, 231, 235, .8));border-color:var(--fallback-b2, rgba(229, 231, 235, .8));color:var(--fallback-bc, #1f2937);font-weight:600}.filter-tag[_ngcontent-%COMP%]{background:#eef2f6;border-radius:16px;padding:6px 10px;font-size:12px;transition:background-color .2s ease,color .2s ease}.filter-tag.active[_ngcontent-%COMP%], .filter-tag[_ngcontent-%COMP%]:hover{background:var(--fallback-b2, rgba(229, 231, 235, .8));color:var(--fallback-bc, #1f2937);font-weight:600}"]})};function Ze(n,e){if(n&1){let t=k();c(0,"button",5),b("click",function(){S(t);let r=p(3);return M(r.handleProductClick())}),c(1,"span"),f(2,"Productos"),d(),$(),c(3,"svg",6),I(4,"path",7),d()(),z(),c(5,"div",8)(6,"div",9),I(7,"mobile-product-filters",10),d()()}if(n&2){let t=p(3);s(3),w("rotate-90",t.showProductFilters()),s(2),w("open",t.showProductFilters())}}function Xe(n,e){if(n&1){let t=k();c(0,"a",11),b("click",function(){S(t);let r=p(2).$implicit,l=p();return M(l.handleMenuClick(r))}),f(1),d()}if(n&2){let t=p(2).$implicit;s(),q(" ",t.label," ")}}function Ke(n,e){if(n&1&&D(0,Ze,8,4)(1,Xe,2,1,"a",4),n&2){let t=p().$implicit;N(t.routerLink==="/products"?0:1)}}function Ye(n,e){if(n&1&&D(0,Ke,2,1),n&2){let t=e.$implicit,i=p();N(!t.adminOnly||i.authService.isAdmin()?0:-1)}}var je=class n{menuItems=L.required();configurationService=o(me);router=o(B);authService=o(Le);showProductFilters=u(!1);isOnProducts=u(!1);isMobile=u(!1);constructor(){this.isOnProducts.set(this.router.url.startsWith("/products")),this.isMobile.set(window.innerWidth<1024),this.router.events.pipe(we(e=>e instanceof Oe)).subscribe(e=>{let t=e.urlAfterRedirects.startsWith("/products");this.isOnProducts.set(t),t||this.showProductFilters.set(!1)})}isOpen(){return this.configurationService.sidebarItemsStatus()==="open"}close(){this.configurationService.toggleSidebarItemsStatus("closed")}handleEscape(e){e.key==="Escape"&&this.isOpen()&&this.close()}onResize(){this.isMobile.set(window.innerWidth<1024)}toggleProductFilters(){this.showProductFilters.update(e=>!e)}handleProductClick(){if(this.isMobile()){this.toggleProductFilters();return}if(this.isOnProducts()){this.toggleProductFilters();return}this.showProductFilters.set(!0),this.configurationService.toggleSidebarItemsStatus("closed"),this.configurationService.toggleSidebarPageStatus("closed"),this.router.navigateByUrl("/products")}handleMenuClick(e){e.adminOnly&&!this.authService.isAdmin()||(this.configurationService.toggleSidebarItemsStatus("closed"),this.configurationService.toggleSidebarPageStatus("closed"),typeof e.routerLink=="string"?this.router.navigateByUrl(e.routerLink):this.router.navigate([e.routerLink]))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["sidebar-items"]],hostBindings:function(t,i){t&1&&b("keydown",function(l){return i.handleEscape(l)},_e)("resize",function(){return i.onResize()},_e)},inputs:{menuItems:[1,"menuItems"]},decls:7,vars:2,consts:[[1,"fixed","inset-0","bg-base-100","z-50","transform","transition-transform","duration-500","flex","flex-col","-translate-x-full"],[1,"flex","justify-end"],[1,"p-2",3,"click"],[1,"flex","flex-col","gap-2","px-4"],[1,"p-2","cursor-pointer","rounded-md","text-base-content","hover:bg-base-200","transition-colors","duration-200"],["type","button",1,"p-2","cursor-pointer","rounded-md","text-base-content","hover:bg-base-200","transition-colors","duration-200","flex","items-center","gap-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-3.5","h-3.5","text-slate-500","transition-transform","duration-300"],["stroke-linecap","round","stroke-linejoin","round","d","M9 5l7 7-7 7"],[1,"submenu-container"],[1,"submenu-inner"],[1,"block","lg:hidden","mt-2"],[1,"p-2","cursor-pointer","rounded-md","text-base-content","hover:bg-base-200","transition-colors","duration-200",3,"click"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"button",2),b("click",function(){return i.configurationService.toggleSidebarItemsStatus("closed")}),I(3,"x-circle"),d()(),c(4,"nav",3),O(5,Ye,1,1,null,null,ae),d()()),t&2&&(w("translate-x-0",i.isOpen()),s(5),E(i.menuItems()))},dependencies:[Q,fe],styles:["[_nghost-%COMP%]{display:block}.submenu-container[_ngcontent-%COMP%]{overflow:hidden;max-height:0;opacity:0;transition:max-height .35s ease,opacity .25s ease}.submenu-container.open[_ngcontent-%COMP%]{max-height:1000px;opacity:1}.submenu-inner[_ngcontent-%COMP%]{margin-left:.5rem;padding-left:.25rem}"]})};var ee=`${x.baseUrl}/contacts`,Je={id:"new",title:"",phone:"",email:""},Re=class n{http=o(F);contactsCache=new Map;toastService=o(T);getAll(){return this.contactsCache.size?g(Array.from(this.contactsCache.values())):this.http.get(ee).pipe(a(e=>e.forEach(t=>this.contactsCache.set(t.id,t))))}getById(e){return e==="new"?g(Je):this.contactsCache.has(e)?g(this.contactsCache.get(e)):this.http.get(`${ee}/${e}`).pipe(a(t=>this.contactsCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(ee,e).pipe(a(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${ee}/${e}`,t).pipe(a(async i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${ee}/${e}`).pipe(a(async()=>{this.contactsCache.delete(e),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.contactsCache.set(e.id,e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};var De=class n{activateRoute=o(pe);router=o(B);currentPage=Ee(this.activateRoute.queryParamMap.pipe(Pe(e=>e.get("page")?+e.get("page"):1),Pe(e=>isNaN(e)?1:e)),{initialValue:1});setCurrentPage(e){this.router.navigate([],{queryParams:{page:e},queryParamsHandling:"merge"})}resetPage(){this.router.navigate([],{queryParams:{page:null},queryParamsHandling:"merge"})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};var W=`${x.baseUrl}/products`,et={id:"new",title:"",price:0,description:"",slug:"",stock:0,isFeatured:!1,tags:[],deleteAt:null,images:[],imageIds:[],category:{id:"",name:""},user:{}},he=class n{constructor(){}http=o(F);productsCache=new Map;productCache=new Map;toastService=o(T);getProducts(e={}){let t=x.cantProducts,{limit:i=t,offset:r=0,isFeatured:l=!1,categoryId:y,tagIds:V,query:R}=e,Ce=l?"isFeatured":`${i}-${r}-${y??"all"}-${(V??[]).join(",")}-${R??""}`;if(this.productsCache.has(Ce))return g(this.productsCache.get(Ce));let Z={limit:i,offset:r};return l!==void 0&&(Z.isFeatured=l),y&&(Z.categoryId=y),V&&V.length&&(Z.tagIds=V),R&&(Z.query=R),this.http.get(W,{params:Z,responseType:"json"}).pipe(a(He=>this.productsCache.set(Ce,He)))}searchProducts(e={}){let{query:t="",limit:i=x.cantProducts,offset:r=0,categoryId:l,tagIds:y,isFeatured:V}=e,R={query:t,limit:i,offset:r};return l&&(R.categoryId=l),y&&y.length&&(R.tagIds=y),V!==void 0&&(R.isFeatured=V),this.http.get(`${W}/search`,{params:R,responseType:"json"})}getProductByIdSlug(e){return e==="new"?g(et):this.productCache.has(e)?g(this.productCache.get(e)):this.http.get(`${W}/${e}`,{responseType:"json"}).pipe(a(i=>this.productCache.set(e,i)))}createProduct(e){return this.toastService.activateLoading(),this.http.post(`${W}`,e).pipe(a(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}updateProduct(e,t){return this.toastService.activateLoading(),this.http.patch(`${W}/${e}`,t).pipe(a(i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}deleteProduct(e){return this.toastService.activateLoading(),this.http.delete(`${W}/${e}`).pipe(a(()=>{this.productCache.delete(e),this.productsCache.clear(),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.productCache.get(e.id)?(this.productCache.set(e.id,e),this.productsCache.forEach(i=>{i.products=i.products.map(r=>r.id===e.id?e:r)})):(this.productCache.set(e.id,e),this.productsCache.clear())}static \u0275fac=function(t){return new(t||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};var tt=["swiper"];function it(n,e){if(n&1&&(h(0,"swiper-slide",2),H(1,"img",4),v()),n&2){let t=e.$implicit;s(),oe("src",t,ne)}}function nt(n,e){if(n&1&&O(0,it,2,1,"swiper-slide",2,ae),n&2){let t=p();E(t.images())}}function rt(n,e){n&1&&(h(0,"swiper-slide",2),H(1,"img",5),v())}var ve=class n{images=L.required();autoplay=L(!0);spaceBetween=10;slidesPerView=1;slideChange=new Me;swiperRef;ngAfterViewInit(){let e=this.swiperRef?.nativeElement;if(e){let t=this.images(),i=this.autoplay()&&t&&t.length>1;e.pagination={clickable:!0,dynamicBullets:!0,type:"bullets"},e.navigation=!0,e.autoplay=i?{delay:5e3,disableOnInteraction:!1,pauseOnMouseEnter:!0,reverseDirection:!1}:!1,e.speed=1200,e.effect="fade",e.fadeEffect={crossFade:!0},e.spaceBetween=this.spaceBetween,e.rewind=!1,e.loopAdditionalSlides=1,e.slidesPerView=this.slidesPerView,e.loop=t&&t.length>1,e.initialize(),e.addEventListener("slidechange",()=>{let r=e.swiper?.realIndex??0;this.slideChange.emit(r)})}}goTo(e){let t=this.swiperRef?.nativeElement;t?.swiper&&(t.swiper.slideToLoop(e),this.slideChange.emit(e))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["image-carrusel"]],viewQuery:function(t,i){if(t&1&&se(tt,5),t&2){let r;ce(r=le())&&(i.swiperRef=r.first)}},inputs:{images:[1,"images"],autoplay:[1,"autoplay"]},outputs:{slideChange:"slideChange"},decls:5,vars:1,consts:[["swiper",""],["navigation","true","pagination","true","pagination-clickable","true","speed","1200","effect","fade","fade-effect-cross-fade","true","dir","ltr",1,"w-full","h-full"],[1,"w-full","h-full","flex","justify-center","items-center"],["slot","pagination",1,"swiper-pagination"],["alt","Imagen",1,"w-full","h-full","object-cover","object-center",3,"src"],["src","assets/images/default-image.jpg","alt","Imagen por defecto",1,"w-full","h-full","object-cover","object-center","opacity-80"]],template:function(t,i){t&1&&(h(0,"swiper-container",1,0),D(2,nt,2,0)(3,rt,2,0,"swiper-slide",2),H(4,"div",3),v()),t&2&&(s(2),N(i.images().length?2:3))},styles:["[_nghost-%COMP%]{display:block}swiper-container[_ngcontent-%COMP%]{height:100%;--swiper-theme-color: #ffffff;--swiper-navigation-color: #ffffff;--swiper-pagination-color: #ffffff;--swiper-pagination-bullet-inactive-color: #e5e7eb;--swiper-pagination-bullet-inactive-opacity: .6;--swiper-pagination-bullet-size: 10px;--swiper-pagination-bullet-horizontal-gap: 6px;--swiper-navigation-size: 28px;--swiper-navigation-sides-offset: 40px}swiper-slide[_ngcontent-%COMP%]{height:100%}swiper-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:center center;display:block}swiper-container[_ngcontent-%COMP%]::part(button-prev), swiper-container[_ngcontent-%COMP%]::part(button-next), swiper-container[_ngcontent-%COMP%]::part(pagination){z-index:50;filter:drop-shadow(0 2px 4px rgba(0,0,0,.6))}swiper-container[_ngcontent-%COMP%]::part(button-prev), swiper-container[_ngcontent-%COMP%]::part(button-next){top:52%;transform:translateY(-50%)}swiper-container[_ngcontent-%COMP%]::part(pagination){bottom:24px;left:0;right:0;width:100%;display:flex;justify-content:center}swiper-container[_ngcontent-%COMP%]   [slot=pagination][_ngcontent-%COMP%]{position:absolute;left:0;right:0;bottom:24px;z-index:50;filter:drop-shadow(0 2px 4px rgba(0,0,0,.6));display:flex;justify-content:center}@media (max-width: 640px){swiper-container[_ngcontent-%COMP%]{--swiper-navigation-sides-offset: 28px;--swiper-navigation-size: 22px;--swiper-pagination-bullet-size: 5px;--swiper-pagination-bullet-horizontal-gap: 4px}swiper-container[_ngcontent-%COMP%]::part(pagination){bottom:18px}swiper-container[_ngcontent-%COMP%]   [slot=pagination][_ngcontent-%COMP%]{bottom:18px}}"]})};var at=["carousel"],ot=(n,e)=>e.identifier??e.src;function st(n,e){if(n&1){let t=k();c(0,"span",9),b("click",function(r){S(t);let l=p().$implicit,y=p(2);return M(y.onRemove(r,l.identifier??l.src))}),I(1,"x-circle"),d()}}function ct(n,e){if(n&1){let t=k();c(0,"button",6),b("click",function(){let r=S(t).$index,l=p(2);return M(l.goTo(r))}),I(1,"img",7),D(2,st,2,0,"span",8),d()}if(n&2){let t=e.$implicit,i=e.$index,r=p(2);w("active",r.currentIndex()===i),s(),j("src",t.src,ne)("alt",t.alt||"Imagen "+(i+1)),s(),N(r.removable()?2:-1)}}function lt(n,e){if(n&1&&(c(0,"div",4),O(1,ct,3,5,"button",5,ot),d()),n&2){let t=p();s(),E(t.images())}}var Ne=class n{images=L.required();removable=L(!1);remove=xe();slideChange=xe();carousel;currentIndex=u(0);imageUrls(){return this.images().map(e=>e?.src).filter(e=>!!e)}handleSlideChange(e){this.currentIndex.set(e),this.slideChange.emit(e)}goTo(e){this.carousel?.goTo(e),this.handleSlideChange(e)}onRemove(e,t){e.stopPropagation(),this.remove.emit(t)}ngOnChanges(e){e.images&&(this.currentIndex.set(0),queueMicrotask(()=>this.carousel?.goTo(0)))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["image-gallery"]],viewQuery:function(t,i){if(t&1&&se(at,5),t&2){let r;ce(r=le())&&(i.carousel=r.first)}},inputs:{images:[1,"images"],removable:[1,"removable"]},outputs:{remove:"remove",slideChange:"slideChange"},features:[Se],decls:5,vars:2,consts:[["carousel",""],[1,"gallery"],[1,"gallery-main"],[3,"slideChange","images"],[1,"gallery-thumbs"],["type","button",1,"thumb",3,"active"],["type","button",1,"thumb",3,"click"],[3,"src","alt"],[1,"remove-btn"],[1,"remove-btn",3,"click"]],template:function(t,i){if(t&1){let r=k();c(0,"div",1)(1,"div",2)(2,"image-carrusel",3,0),b("slideChange",function(y){return S(r),M(i.handleSlideChange(y))}),d()(),D(4,lt,3,0,"div",4),d()}t&2&&(s(2),j("images",i.imageUrls()),s(2),N(i.images().length?4:-1))},dependencies:[Te,ve,Q],styles:["[_nghost-%COMP%]{display:block}.gallery[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;align-items:center}.gallery-main[_ngcontent-%COMP%]{width:100%;max-width:1536px;height:clamp(240px,65vw,720px);max-height:720px;border-radius:clamp(.5rem,1vw,.75rem);overflow:hidden;background:hsl(var(--b2));border:1px solid hsl(var(--b3))}.gallery-thumbs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;justify-content:center;width:100%;max-width:1536px;margin-inline:auto;padding-bottom:.5rem}.thumb[_ngcontent-%COMP%]{position:relative;border:2px solid transparent;border-radius:.5rem;padding:.15rem;background:hsl(var(--b2));width:clamp(72px,18vw,96px);height:clamp(54px,13vw,72px);cursor:pointer;transition:border-color .2s ease,transform .2s ease}.thumb[_ngcontent-%COMP%]:hover{transform:translateY(-1px);border-color:hsl(var(--b3))}.thumb.active[_ngcontent-%COMP%]{border-color:hsl(var(--p));box-shadow:0 0 0 3px color-mix(in srgb,hsl(var(--p)) 20%,transparent)}.thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:.35rem}.remove-btn[_ngcontent-%COMP%]{position:absolute;top:6px;right:6px;width:1.75rem;height:1.75rem;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;background:hsl(var(--b1));box-shadow:0 6px 14px color-mix(in srgb,hsl(var(--bc)) 12%,transparent)}"]})};function Bi(){let n=o(he),e=u(null),t=u(!0),i=u(null);async function r(l){t.set(!0),i.set(null);try{let y=l.query?await ye(n.searchProducts(l)):await ye(n.getProducts(l));e.set(y)}catch{i.set("Error al cargar los productos")}finally{t.set(!1)}}return{productResponse:e,loading:t,error:i,loadProducts:r}}var te=()=>[],pt=()=>({page:1}),be=n=>({page:n});function dt(n,e){if(n&1){let t=k();c(0,"button",14),b("click",function(){let r=S(t).$implicit,l=p();return M(l.goToPage(r))}),f(1),d()}if(n&2){let t=e.$implicit,i=p();w("btn-primary",t===i.activePage()),j("routerLink",U(5,te))("queryParams",K(6,be,t)),s(),q(" ",t," ")}}function mt(n,e){n&1&&(c(0,"button",8),f(1,"0"),d())}var Ve=class n{pages=L(0);currentPage=L(1);activePage=ke(this.currentPage);totalPages=A(()=>Math.max(0,this.pages()??0));getPagesList=A(()=>{let e=this.totalPages();return e?Array.from({length:e},(t,i)=>i+1):[]});isFirstPage=A(()=>this.activePage()<=1);isLastPage=A(()=>this.activePage()>=this.totalPages()&&this.totalPages()>0);previousPage=A(()=>Math.max(1,this.activePage()-1));nextPage=A(()=>Math.min(this.totalPages(),this.activePage()+1));goToPage(e){if(!this.totalPages())return;let t=Math.min(Math.max(e,1),this.totalPages());this.activePage.set(t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["pagination"]],inputs:{pages:[1,"pages"],currentPage:[1,"currentPage"]},decls:18,vars:24,consts:[[1,"join","flex","justify-center","items-center"],["type","button","aria-label","Primera p\xE1gina","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-4"],["fill-rule","evenodd","d","M10.72 11.47a.75.75 0 0 0 0 1.06l7.5 7.5a.75.75 0 1 0 1.06-1.06L12.31 12l6.97-6.97a.75.75 0 0 0-1.06-1.06l-7.5 7.5Z","clip-rule","evenodd"],["fill-rule","evenodd","d","M4.72 11.47a.75.75 0 0 0 0 1.06l7.5 7.5a.75.75 0 1 0 1.06-1.06L6.31 12l6.97-6.97a.75.75 0 0 0-1.06-1.06l-7.5 7.5Z","clip-rule","evenodd"],["type","button","aria-label","P\xE1gina anterior","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["fill-rule","evenodd","d","M7.72 12.53a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 1 1 1.06 1.06L9.31 12l6.97 6.97a.75.75 0 1 1-1.06 1.06l-7.5-7.5Z","clip-rule","evenodd"],["type","button","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"btn-primary","routerLink","queryParams"],["type","button","disabled","",1,"join-item","btn"],["type","button","aria-label","P\xE1gina siguiente","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["fill-rule","evenodd","d","M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z","clip-rule","evenodd"],["type","button","aria-label","\xDAltima p\xE1gina","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","disabled","routerLink","queryParams"],["fill-rule","evenodd","d","M13.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L11.69 12 4.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z","clip-rule","evenodd"],["fill-rule","evenodd","d","M19.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06L17.69 12l-6.97-6.97a.75.75 0 0 1 1.06-1.06l7.5 7.5Z","clip-rule","evenodd"],["type","button","queryParamsHandling","merge",1,"join-item","btn","btn-sm","w-10",3,"click","routerLink","queryParams"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"button",1),b("click",function(){return i.goToPage(1)}),$(),c(2,"svg",2),I(3,"path",3)(4,"path",4),d()(),z(),c(5,"button",5),b("click",function(){return i.goToPage(i.previousPage())}),$(),c(6,"svg",2),I(7,"path",6),d()(),O(8,dt,2,8,"button",7,Ie,!1,mt,2,0,"button",8),z(),c(11,"button",9),b("click",function(){return i.goToPage(i.nextPage())}),$(),c(12,"svg",2),I(13,"path",10),d()(),z(),c(14,"button",11),b("click",function(){return i.goToPage(i.totalPages())}),$(),c(15,"svg",2),I(16,"path",12)(17,"path",13),d()()()),t&2&&(s(),j("disabled",i.isFirstPage()||!i.totalPages())("routerLink",U(13,te))("queryParams",U(14,pt)),s(4),j("disabled",i.isFirstPage()||!i.totalPages())("routerLink",U(15,te))("queryParams",K(16,be,i.previousPage())),s(3),E(i.getPagesList()),s(3),j("disabled",i.isLastPage()||!i.totalPages())("routerLink",U(18,te))("queryParams",K(19,be,i.nextPage())),s(3),j("disabled",i.isLastPage()||!i.totalPages())("routerLink",U(21,te))("queryParams",K(22,be,i.totalPages()||1)))},dependencies:[de],styles:["[_nghost-%COMP%]{display:block}"]})};var ie=`${x.baseUrl}/recipes`,gt={id:"new",title:"",text:""},qe=class n{http=o(F);recipesCache=new Map;toastService=o(T);getAll(){return this.recipesCache.size?g(Array.from(this.recipesCache.values())):this.http.get(ie).pipe(a(e=>e.forEach(t=>this.recipesCache.set(t.id,t))))}getById(e){return e==="new"?g(gt):this.recipesCache.has(e)?g(this.recipesCache.get(e)):this.http.get(`${ie}/${e}`).pipe(a(t=>this.recipesCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(ie,e).pipe(a(async t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${ie}/${e}`,t).pipe(a(i=>{this.insertOrUpdateCache(i),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${ie}/${e}`).pipe(a(async()=>{this.recipesCache.delete(e),this.toastService.activateSuccess()}),m(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.recipesCache.set(e.id,e)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})};var ut=x.baseUrl,Ue="assets/images/default-image.jpg",Ae=class n{transform(e){if(!e||Array.isArray(e)&&e.length===0)return Ue;let t=Array.isArray(e)?e[0]:e,i=this.resolveImageValue(t);return i?i.startsWith("assets/")||/^https?:\/\//.test(i)?i:`${ut}/files/product/${i}`:Ue}resolveImageValue(e){return e?typeof e=="string"?e:e.secureUrl||e.url||e.path||e.fileName||e.filename||e.name||e.id||null:null}static \u0275fac=function(t){return new(t||n)};static \u0275pipe=re({name:"productImage",type:n,pure:!0})};var ze=class n{transform(e){return e==null?"0":"Gs. "+e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}static \u0275fac=function(t){return new(t||n)};static \u0275pipe=re({name:"guaranies",type:n,pure:!0})};export{Fe as a,Q as b,T as c,ge as d,ue as e,je as f,Re as g,De as h,he as i,ve as j,Ne as k,Ae as l,ze as m,Bi as n,Ve as o,qe as p};
