import{a as h}from"./chunk-T6RCUUK6.js";import{b as Se,c as te}from"./chunk-MQO5QXV5.js";import{a as ee,b as j,c as m,d as q,e as G,g as $,j as z,k as H,n as Z,p as J}from"./chunk-DVBBQGII.js";import{$a as x,A,Aa as B,B as S,Ba as w,C as K,Da as M,Ea as be,F as g,Ga as D,Ha as c,Ia as I,J as me,Ja as U,Ka as W,M as a,Ma as ve,P as b,U as pe,Wa as R,Xa as xe,Za as X,_,aa as C,ba as fe,da as k,ea as N,fa as l,ga as i,ha as t,hb as he,ia as d,ib as ye,jb as Y,kb as E,lb as _e,ma as Q,oa as y,qa as v,rb as Ce,ua as ge,y as p,ya as r,z as T,za as f}from"./chunk-YXJLHSRH.js";var Ee=()=>({exact:!0}),ie=class o{authService=p(Ce);static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user"]],decls:34,vars:4,consts:[[1,"space-y-4"],[1,"text-3xl","font-bold","mb-2","mt-6"],[1,"grid","grid-cols-1","lg:grid-cols-[18%_1fr]","gap-4","lg:gap-6","items-start"],[1,"hidden","lg:block","rounded-xl","border","border-base-200","bg-base-100/60","p-3","shadow-sm","backdrop-blur-sm"],[1,"flex","flex-col","gap-2"],["routerLink","/user/profile","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block",3,"routerLinkActiveOptions"],["routerLink","/user/directions","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block"],["routerLink","/user/billing","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block"],["routerLink","/user/orders","routerLinkActive","bg-base-200 font-semibold",1,"w-full","text-left","p-2","rounded-md","cursor-pointer","text-base-content","transition-colors","duration-200","hover:bg-base-200","hover:text-base-content","block"],[1,"flex","flex-col","gap-4"],[1,"lg:hidden","rounded-xl","border","border-base-200","bg-base-100/60","p-3","shadow-sm","backdrop-blur-sm"]],template:function(e,s){e&1&&(i(0,"div",0)(1,"h1",1),r(2,"Mi Cuenta"),t(),i(3,"div",2)(4,"aside",3)(5,"ul",4)(6,"li")(7,"a",5),r(8," Mi perfil "),t()(),i(9,"li")(10,"a",6),r(11," Mis direcciones "),t()(),i(12,"li")(13,"a",7),r(14," Mis datos de facturaci\xF3n "),t()(),i(15,"li")(16,"a",8),r(17," Mis pedidos "),t()()()(),i(18,"main",9)(19,"div",10)(20,"ul",4)(21,"li")(22,"a",5),r(23," Mi perfil "),t()(),i(24,"li")(25,"a",6),r(26," Mis direcciones "),t()(),i(27,"li")(28,"a",7),r(29," Mis datos de facturaci\xF3n "),t()(),i(30,"li")(31,"a",8),r(32," Mis pedidos "),t()()()(),d(33,"router-outlet"),t()()()),e&2&&(a(7),l("routerLinkActiveOptions",D(2,Ee)),a(15),l("routerLinkActiveOptions",D(3,Ee)))},dependencies:[E,_e,ye],styles:["[_nghost-%COMP%]{display:block}"]})};var Ie=()=>["/user/billing","new"],ke=o=>({edit:o}),Ne=(o,n)=>n.id;function Pe(o,n){o&1&&(i(0,"p"),r(1,"Cargando datos de facturacion..."),t())}function Fe(o,n){o&1&&(i(0,"p",6),r(1,"Aun no agregaste datos de facturacion."),t())}function Me(o,n){o&1&&(S(),i(0,"svg",15),d(1,"path",22),t())}function Ue(o,n){o&1&&(S(),i(0,"svg",16),d(1,"path",23),t())}function Oe(o,n){if(o&1){let e=Q();i(0,"article",7)(1,"div",8)(2,"div",9)(3,"h3",10),r(4),t(),i(5,"p",11),r(6),t(),i(7,"p",11),r(8),t(),i(9,"p",12),r(10),t()(),i(11,"div",13)(12,"button",14),y("click",function(){let u=T(e).$implicit,F=v(2);return A(F.toggleDefault(u))}),_(13,Me,2,0,":svg:svg",15)(14,Ue,2,0,":svg:svg",16),t(),i(15,"a",17),S(),i(16,"svg",18),d(17,"path",19),t()(),K(),i(18,"button",20),y("click",function(){let u=T(e).$implicit,F=v(2);return A(F.remove(u))}),S(),i(19,"svg",18),d(20,"path",21),t()()()()()}if(o&2){let e=n.$implicit;a(4),f(e.legalName),a(2),B("RUC: ",e.taxId),a(2),w("",e.email," \xB7 ",e.phone),a(2),M("",e.addressLine1,", ",e.city,", ",e.state," - ",e.country),a(3),C(e.isDefault?13:14),a(2),l("routerLink",D(11,Ie))("queryParams",c(12,ke,e.id))}}function Le(o,n){if(o&1&&k(0,Oe,21,14,"article",7,Ne),o&2){let e=v();N(e.profiles())}}var ne=class o{accountService=p(h);profiles=g([]);loading=g(!0);ngOnInit(){this.load()}load(){this.loading.set(!0),this.accountService.getBillingProfiles().subscribe({next:n=>this.profiles.set(n??[]),error:()=>this.loading.set(!1),complete:()=>this.loading.set(!1)})}toggleDefault(n){this.loading.set(!0);let e=!(n.isDefault??!1);this.accountService.updateBilling(n.id,{isDefault:e}).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}remove(n){this.loading.set(!0),this.accountService.deleteBilling(n.id).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user-billings"]],decls:13,vars:1,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],["routerLink","/user/billing/new",1,"btn","btn-primary","btn-sm"],[1,"space-y-3"],[1,"text-base-content/70"],[1,"p-4","border","border-base-300","rounded-lg","bg-base-100","shadow-sm"],[1,"flex","items-start","justify-between","gap-3"],[1,"space-y-1"],[1,"font-semibold","text-lg","leading-tight"],[1,"text-sm","text-base-content/70","leading-snug"],[1,"text-sm","text-base-content/80","leading-snug"],[1,"flex","items-center","gap-1"],["type","button","aria-label","Marcar como principal",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-5","text-warning"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-base-content"],["aria-label","Editar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5"],["stroke-linecap","round","stroke-linejoin","round","d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"],["type","button","aria-label","Eliminar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-error/10","text-error",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"],["fill-rule","evenodd","d","M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z","clip-rule","evenodd"],["stroke-linecap","round","stroke-linejoin","round","d","M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),r(4,"Datos de facturacion"),t(),i(5,"p",3),r(6,"Gestiona tus perfiles de factura."),t()(),i(7,"a",4),r(8,"Agregar nuevo"),t()(),i(9,"div",5),_(10,Pe,2,0,"p")(11,Fe,2,0,"p",6)(12,Le,2,0),t()()),e&2&&(a(10),C(s.loading()?10:s.profiles().length===0?11:12))},dependencies:[x,E],styles:["[_nghost-%COMP%]{display:block}"]})};var Ve=()=>["/user/directions","new"],Te=o=>({edit:o}),Ae=(o,n)=>n.id;function Be(o,n){o&1&&(i(0,"p"),r(1,"Cargando direcciones..."),t())}function Re(o,n){o&1&&(i(0,"p",6),r(1,"A\xFAn no agregaste direcciones."),t())}function je(o,n){o&1&&(S(),i(0,"svg",15),d(1,"path",22),t())}function qe(o,n){o&1&&(S(),i(0,"svg",16),d(1,"path",23),t())}function Ge(o,n){if(o&1){let e=Q();i(0,"article",7)(1,"div",8)(2,"div",9)(3,"h3",10),r(4),t(),i(5,"p",11),r(6),t(),i(7,"p",12),r(8),t()(),i(9,"div",13)(10,"button",14),y("click",function(){let u=T(e).$implicit,F=v(2);return A(F.toggleDefault(u))}),_(11,je,2,0,":svg:svg",15)(12,qe,2,0,":svg:svg",16),t(),i(13,"a",17),S(),i(14,"svg",18),d(15,"path",19),t()(),K(),i(16,"button",20),y("click",function(){let u=T(e).$implicit,F=v(2);return A(F.remove(u))}),S(),i(17,"svg",18),d(18,"path",21),t()()()()()}if(o&2){let e=n.$implicit;a(4),f(e.label),a(2),w("",e.fullName," \xB7 ",e.phone),a(2),M("",e.street,", ",e.city,", ",e.state," - ",e.country),a(3),C(e.isDefault?11:12),a(2),l("routerLink",D(10,Ve))("queryParams",c(11,Te,e.id))}}function $e(o,n){if(o&1&&k(0,Ge,19,13,"article",7,Ae),o&2){let e=v();N(e.addresses())}}var re=class o{accountService=p(h);addresses=g([]);loading=g(!0);ngOnInit(){this.load()}load(){this.loading.set(!0),this.accountService.getAddresses().subscribe({next:n=>this.addresses.set(n??[]),error:()=>this.loading.set(!1),complete:()=>this.loading.set(!1)})}toggleDefault(n){this.loading.set(!0);let e=!(n.isDefault??!1);this.accountService.updateAddress(n.id,{isDefault:e}).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}remove(n){this.loading.set(!0),this.accountService.deleteAddress(n.id).subscribe({next:()=>this.load(),error:()=>this.loading.set(!1)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user-directions"]],decls:13,vars:1,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],["routerLink","/user/directions/new",1,"btn","btn-primary","btn-sm"],[1,"space-y-3"],[1,"text-base-content/70"],[1,"p-4","border","border-base-300","rounded-lg","bg-base-100","shadow-sm"],[1,"flex","items-start","justify-between","gap-3"],[1,"space-y-1"],[1,"font-semibold","text-lg","leading-tight"],[1,"text-sm","text-base-content/70","leading-snug"],[1,"text-sm","text-base-content/80","leading-snug"],[1,"flex","items-center","gap-1"],["type","button","aria-label","Marcar como principal",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-5","text-warning"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5","text-base-content"],["aria-label","Editar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-base-200",3,"routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-5"],["stroke-linecap","round","stroke-linejoin","round","d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"],["type","button","aria-label","Eliminar",1,"h-9","w-9","flex","items-center","justify-center","rounded-md","transition-colors","hover:bg-error/10","text-error",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"],["fill-rule","evenodd","d","M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z","clip-rule","evenodd"],["stroke-linecap","round","stroke-linejoin","round","d","M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),r(4,"Mis direcciones"),t(),i(5,"p",3),r(6,"Revisa tus datos de env\xEDo."),t()(),i(7,"a",4),r(8,"Agregar nuevo"),t()(),i(9,"div",5),_(10,Be,2,0,"p")(11,Re,2,0,"p",6)(12,$e,2,0),t()()),e&2&&(a(10),C(s.loading()?10:s.addresses().length===0?11:12))},dependencies:[x,E],styles:["[_nghost-%COMP%]{display:block}"]})};var V=o=>({"border-error focus:border-error":o}),oe=class o{fb=p(Z);accountService=p(h);router=p(Y);editingId=null;submitting=g(!1);form=this.fb.nonNullable.group({label:["",[m.required]],fullName:["",[m.required]],phone:["",[m.required]],street:["",[m.required]],city:["",[m.required]],state:["",[m.required]],country:["Paraguay",[m.required]],isDefault:[!1]});initialValue=this.form.getRawValue();ngOnInit(){let e=new URL(window.location.href).searchParams.get("edit");e&&(this.editingId=e,this.prefill(e))}prefill(n){this.submitting.set(!0),this.accountService.getAddresses().subscribe({next:e=>{let s=(e??[]).find(u=>u.id===n);s&&(this.form.patchValue(s),this.updateInitialValue())},complete:()=>this.submitting.set(!1),error:()=>this.submitting.set(!1)})}save(){if(this.form.invalid)return;this.submitting.set(!0);let n=this.form.getRawValue();(this.editingId?this.accountService.updateAddress(this.editingId,n):this.accountService.createAddress(n)).subscribe({next:()=>{this.updateInitialValue(),this.submitting.set(!1),this.router.navigate(["/user/directions"])},error:()=>this.submitting.set(!1)})}hasChanges(){return!this.isEqual(this.form.getRawValue(),this.initialValue)}updateInitialValue(){this.initialValue=this.form.getRawValue(),this.form.markAsPristine()}isEqual(n,e){let s=Object.keys(n);return s.length===Object.keys(e).length&&s.every(u=>n[u]===e[u])}isInvalid(n){let e=this.form.get(n);return!!e&&e.invalid&&(e.dirty||e.touched)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user-directions-new"]],decls:43,vars:24,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","bg-base-200/60","rounded-lg","p-5",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"font-semibold"],["formControlName","label","placeholder","Casa / Oficina",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","phone",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","fullName",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","state",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","flex-col","gap-2"],["formControlName","street","placeholder","Calle y n\xFAmero",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","city",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","country",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","items-center","gap-2","pt-1"],["type","checkbox","formControlName","isDefault",1,"checkbox","checkbox-primary"],[1,"md:col-span-2","flex","justify-end"],["type","submit",1,"btn","btn-primary","min-w-36",3,"disabled"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),r(4),t(),i(5,"p",3),r(6,"Completa los datos de env\xEDo."),t()()(),i(7,"form",4),y("ngSubmit",function(){return s.save()}),i(8,"div",5)(9,"span",6),r(10,"Etiqueta"),t(),d(11,"input",7),t(),i(12,"div",5)(13,"span",6),r(14,"Tel\xE9fono"),t(),d(15,"input",8),t(),i(16,"div",5)(17,"span",6),r(18,"Nombre completo"),t(),d(19,"input",9),t(),i(20,"div",5)(21,"span",6),r(22,"Departamento"),t(),d(23,"input",10),t(),i(24,"div",11)(25,"span",6),r(26,"Calle y n\xFAmero"),t(),d(27,"input",12),t(),i(28,"div",5)(29,"span",6),r(30,"Ciudad"),t(),d(31,"input",13),t(),i(32,"div",5)(33,"span",6),r(34,"Pa\xEDs"),t(),d(35,"input",14),t(),i(36,"label",15),d(37,"input",16),i(38,"span",6),r(39,"Usar como direcci\xF3n principal"),t()(),i(40,"div",17)(41,"button",18),r(42," Guardar "),t()()()()),e&2&&(a(4),f(s.editingId?"Editar direcci\xF3n":"Nueva direcci\xF3n"),a(3),l("formGroup",s.form),a(4),l("ngClass",c(10,V,s.isInvalid("label"))),a(4),l("ngClass",c(12,V,s.isInvalid("phone"))),a(4),l("ngClass",c(14,V,s.isInvalid("fullName"))),a(4),l("ngClass",c(16,V,s.isInvalid("state"))),a(4),l("ngClass",c(18,V,s.isInvalid("street"))),a(4),l("ngClass",c(20,V,s.isInvalid("city"))),a(4),l("ngClass",c(22,V,s.isInvalid("country"))),a(6),l("disabled",s.form.invalid||!s.hasChanges()||s.submitting()))},dependencies:[x,R,J,$,j,ee,q,G,z,H],styles:["[_nghost-%COMP%]{display:block}"]})};var P=o=>({"border-error focus:border-error":o}),ae=class o{fb=p(Z);accountService=p(h);router=p(Y);editingId=null;submitting=g(!1);form=this.fb.nonNullable.group({legalName:["",[m.required]],taxId:["",[m.required]],email:["",[m.required,m.email]],phone:["",[m.required]],addressLine1:["",[m.required]],city:["",[m.required]],state:["",[m.required]],country:["Paraguay",[m.required]],isDefault:[!1]});initialValue=this.form.getRawValue();ngOnInit(){let e=new URL(window.location.href).searchParams.get("edit");e&&(this.editingId=e,this.prefill(e))}prefill(n){this.submitting.set(!0),this.accountService.getBillingProfiles().subscribe({next:e=>{let s=(e??[]).find(u=>u.id===n);s&&(this.form.patchValue(s),this.updateInitialValue())},complete:()=>this.submitting.set(!1),error:()=>this.submitting.set(!1)})}save(){if(this.form.invalid)return;this.submitting.set(!0);let n=this.form.getRawValue();(this.editingId?this.accountService.updateBilling(this.editingId,n):this.accountService.createBilling(n)).subscribe({next:()=>{this.updateInitialValue(),this.submitting.set(!1),this.router.navigate(["/user/billing"])},error:()=>this.submitting.set(!1)})}hasChanges(){return!this.isEqual(this.form.getRawValue(),this.initialValue)}updateInitialValue(){this.initialValue=this.form.getRawValue(),this.form.markAsPristine()}isEqual(n,e){let s=Object.keys(n);return s.length===Object.keys(e).length&&s.every(u=>n[u]===e[u])}isInvalid(n){let e=this.form.get(n);return!!e&&e.invalid&&(e.dirty||e.touched)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user-billings-new"]],decls:48,vars:27,consts:[[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","bg-base-200/60","rounded-lg","p-5",3,"ngSubmit","formGroup"],[1,"flex","flex-col","gap-2"],[1,"font-semibold"],["formControlName","legalName",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["type","email","formControlName","email",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","taxId",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","phone",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","country",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","state",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","flex-col","gap-2"],["formControlName","addressLine1",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["formControlName","city",1,"input","input-bordered","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"hidden","md:block"],[1,"md:col-span-2","flex","items-center","gap-2","pt-1"],["type","checkbox","formControlName","isDefault",1,"checkbox","checkbox-primary"],[1,"md:col-span-2","flex","justify-end","pt-1"],["type","submit",1,"btn","btn-primary","min-w-32",3,"disabled"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div",1)(2,"div")(3,"h2",2),r(4),t(),i(5,"p",3),r(6,"Completa los datos de facturaci\xF3n."),t()()(),i(7,"form",4),y("ngSubmit",function(){return s.save()}),i(8,"div",5)(9,"span",6),r(10,"Raz\xF3n social"),t(),d(11,"input",7),t(),i(12,"div",5)(13,"span",6),r(14,"Email"),t(),d(15,"input",8),t(),i(16,"div",5)(17,"span",6),r(18,"RUC"),t(),d(19,"input",9),t(),i(20,"div",5)(21,"span",6),r(22,"Tel\xE9fono"),t(),d(23,"input",10),t(),i(24,"div",5)(25,"span",6),r(26,"Pa\xEDs"),t(),d(27,"input",11),t(),i(28,"div",5)(29,"span",6),r(30,"Departamento"),t(),d(31,"input",12),t(),i(32,"div",13)(33,"span",6),r(34,"Direcci\xF3n"),t(),d(35,"input",14),t(),i(36,"div",5)(37,"span",6),r(38,"Ciudad"),t(),d(39,"input",15),t(),d(40,"div",16),i(41,"label",17),d(42,"input",18),i(43,"span",6),r(44,"Usar como perfil principal"),t()(),i(45,"div",19)(46,"button",20),r(47," Guardar "),t()()()()),e&2&&(a(4),f(s.editingId?"Editar facturaci\xF3n":"Nuevo perfil de facturaci\xF3n"),a(3),l("formGroup",s.form),a(4),l("ngClass",c(11,P,s.isInvalid("legalName"))),a(4),l("ngClass",c(13,P,s.isInvalid("email"))),a(4),l("ngClass",c(15,P,s.isInvalid("taxId"))),a(4),l("ngClass",c(17,P,s.isInvalid("phone"))),a(4),l("ngClass",c(19,P,s.isInvalid("country"))),a(4),l("ngClass",c(21,P,s.isInvalid("state"))),a(4),l("ngClass",c(23,P,s.isInvalid("addressLine1"))),a(4),l("ngClass",c(25,P,s.isInvalid("city"))),a(7),l("disabled",s.form.invalid||!s.hasChanges()||s.submitting()))},dependencies:[x,R,J,$,j,ee,q,G,z,H],styles:["[_nghost-%COMP%]{display:block}"]})};var ue=o=>({"border-error focus:border-error":o}),le=class o{fb=p(Z);accountService=p(h);submitting=g(!1);form=this.fb.nonNullable.group({fullName:["",[m.required,m.minLength(2)]],email:["",[m.required,m.email]],phone:["",[m.required]]});initialValue=this.form.getRawValue();ngOnInit(){this.fetchProfile()}fetchProfile(){this.submitting.set(!0),this.accountService.getProfile().subscribe({next:n=>{this.form.patchValue({fullName:n.fullName??"",email:n.email??"",phone:n.phone??""}),this.updateInitialValue()},error:()=>this.submitting.set(!1),complete:()=>this.submitting.set(!1)})}save(){this.form.invalid||(this.submitting.set(!0),this.accountService.updateProfile(this.form.getRawValue()).subscribe({next:()=>{this.updateInitialValue(),this.submitting.set(!1)},error:()=>this.submitting.set(!1)}))}hasChanges(){return!this.isEqual(this.form.getRawValue(),this.initialValue)}updateInitialValue(){this.initialValue=this.form.getRawValue(),this.form.markAsPristine()}isEqual(n,e){let s=Object.keys(n);return s.length===Object.keys(e).length&&s.every(u=>n[u]===e[u])}isInvalid(n){let e=this.form.get(n);return!!e&&e.invalid&&(e.dirty||e.touched)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user-profile"]],decls:22,vars:11,consts:[[1,"space-y-4"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","bg-base-200/60","rounded-lg","p-5","max-w-3xl",3,"ngSubmit","formGroup"],[1,"md:col-span-2","flex","flex-col","gap-2"],[1,"font-semibold"],["type","text","formControlName","fullName","placeholder","Tu nombre",1,"input","input-bordered","w-full","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"flex","flex-col","gap-2"],["type","email","formControlName","email","placeholder","tucorreo@mail.com",1,"input","input-bordered","w-full","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],["type","text","formControlName","phone","placeholder","+595...",1,"input","input-bordered","w-full","border","border-base-300","focus:outline-none","focus:ring-[1px]","focus:ring-base-300","focus:border-base-400",3,"ngClass"],[1,"md:col-span-2","flex","justify-end","pt-1"],["type","submit",1,"btn","btn-primary","min-w-32",3,"disabled"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div")(2,"h2",1),r(3,"Mi perfil"),t(),i(4,"p",2),r(5,"Actualiza tus datos personales."),t()(),i(6,"form",3),y("ngSubmit",function(){return s.save()}),i(7,"div",4)(8,"span",5),r(9,"Nombre completo"),t(),d(10,"input",6),t(),i(11,"div",7)(12,"span",5),r(13,"Email"),t(),d(14,"input",8),t(),i(15,"div",7)(16,"span",5),r(17,"Tel\xE9fono"),t(),d(18,"input",9),t(),i(19,"div",10)(20,"button",11),r(21," Guardar "),t()()()()),e&2&&(a(6),l("formGroup",s.form),a(4),l("ngClass",c(5,ue,s.isInvalid("fullName"))),a(4),l("ngClass",c(7,ue,s.isInvalid("email"))),a(4),l("ngClass",c(9,ue,s.isInvalid("phone"))),a(2),l("disabled",s.form.invalid||!s.hasChanges()||s.submitting()))},dependencies:[x,R,J,$,j,q,G,z,H],styles:["[_nghost-%COMP%]{display:block}"]})};var ze=o=>["/user/orders",o],He=(o,n)=>n.id;function Ze(o,n){o&1&&(i(0,"p"),r(1,"Cargando pedidos..."),t())}function Je(o,n){o&1&&(i(0,"div",3)(1,"p"),r(2,"Aun no tienes pedidos."),t(),i(3,"a",5),r(4,"Ver productos"),t()())}function Ke(o,n){if(o&1&&(i(0,"article",6)(1,"div",7)(2,"div")(3,"p",2),r(4),t(),i(5,"h3",8),r(6),t()(),i(7,"div",9)(8,"p",10),r(9),I(10,"guaranies"),t(),i(11,"p",11),r(12),I(13,"date"),t()()(),i(14,"div",12)(15,"span"),r(16),t(),i(17,"a",13),r(18," Ver detalles "),t()()()),o&2){let e=n.$implicit,s=v(2);a(4),f(e.orderNumber||e.id),a(2),f(s.statusLabel(e.status)),a(3),f(U(10,7,e.total??0)),a(3),f(W(13,9,e.createdAt,"dd/MM/yyyy HH:mm:ss")),a(4),w("",(e.items==null?null:e.items.length)||0," ",((e.items==null?null:e.items.length)||0)===1?"item":"items"),a(),l("routerLink",c(12,ze,e.id))}}function Qe(o,n){if(o&1&&(i(0,"div",4),k(1,Ke,19,14,"article",6,He),t()),o&2){let e=v();a(),N(e.orders())}}var de=class o{accountService=p(h);orders=g([]);loading=g(!0);statusMap={pending:"Pendiente",paid:"Pagado",shipped:"Enviado",delivered:"Entregado",cancelled:"Cancelado",refunded:"Reembolsado"};ngOnInit(){this.loadOrders()}loadOrders(){this.loading.set(!0),this.accountService.getOrders(20,0).subscribe({next:n=>this.orders.set(n??[]),error:()=>this.orders.set([]),complete:()=>this.loading.set(!1)})}statusLabel(n){if(!n)return"Pendiente";let e=n.toLowerCase();return this.statusMap[e]??n}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user-orders"]],decls:9,vars:1,consts:[[1,"space-y-4"],[1,"text-xl","font-bold"],[1,"text-sm","text-base-content/70"],[1,"text-base-content/70","space-y-3"],[1,"space-y-3"],["routerLink","/products",1,"btn","btn-primary","btn-sm"],[1,"p-4","border","border-base-300","rounded-lg","bg-base-100","shadow-sm"],[1,"flex","flex-wrap","items-center","justify-between","gap-2"],[1,"font-semibold","text-lg"],[1,"text-right"],[1,"font-semibold"],[1,"text-xs","text-base-content/70"],[1,"mt-3","flex","items-center","justify-between","text-sm","text-base-content/80"],[1,"btn","btn-outline","btn-sm",3,"routerLink"]],template:function(e,s){e&1&&(i(0,"section",0)(1,"div")(2,"h2",1),r(3,"Mis pedidos"),t(),i(4,"p",2),r(5,"Revisa tu historial de compras."),t()(),_(6,Ze,2,0,"p")(7,Je,5,0,"div",3)(8,Qe,3,0,"div",4),t()),e&2&&(a(6),C(s.loading()?6:s.orders().length===0?7:8))},dependencies:[x,E,X,te],styles:["[_nghost-%COMP%]{display:block}"]})};var De=o=>["/product",o],We=()=>[];function Xe(o,n){if(o&1&&(i(0,"div",19)(1,"a",20),d(2,"img",21),I(3,"productImage"),t(),i(4,"div",22)(5,"div",23)(6,"div",24)(7,"a",25),r(8),t(),i(9,"p",26),r(10),t()()(),i(11,"div",27)(12,"p",4),r(13),I(14,"guaranies"),t(),i(15,"span",12),r(16),I(17,"guaranies"),t()()()()),o&2){let e=n.$implicit,s=v(4);a(),l("routerLink",c(16,De,(e.product==null?null:e.product.id)||(e.product==null?null:e.product.slug)||"")),a(),l("alt",be((e.product==null?null:e.product.title)||e.name))("src",U(3,10,(e.product==null?null:e.product.images)??D(18,We)),me),a(5),l("routerLink",c(19,De,(e.product==null?null:e.product.id)||(e.product==null?null:e.product.slug)||"")),a(),B(" ",(e.product==null?null:e.product.title)||e.name||"Producto"," "),a(2),B(" ",e.product==null?null:e.product.description," "),a(3),w(" ",e.quantity||1," x ",U(14,12,e.unitPrice??e.price??0)," "),a(3),f(U(17,14,s.itemSubtotal(e)))}}function Ye(o,n){if(o&1&&(i(0,"div",15),k(1,Xe,18,21,"div",19,fe),t()),o&2){let e=v();a(),N(e.items)}}function et(o,n){o&1&&(i(0,"p",4),r(1,"No hay items en este pedido."),t())}function tt(o,n){if(o&1&&(i(0,"div",3)(1,"div")(2,"p",4),r(3),t(),i(4,"h1",5),r(5),t(),i(6,"p",6),r(7),I(8,"date"),t()(),i(9,"div",7)(10,"p",8),r(11),I(12,"guaranies"),t()()(),i(13,"div",9)(14,"div",10)(15,"div",11)(16,"h3",12),r(17,"Direcci\xF3n de env\xEDo"),t(),i(18,"p",13),r(19),t(),i(20,"p",13),r(21),t(),i(22,"p",13),r(23),t()(),i(24,"div",11)(25,"h3",12),r(26,"Facturaci\xF3n"),t(),i(27,"p",13),r(28),t(),i(29,"p",13),r(30),t(),i(31,"p",13),r(32),t(),i(33,"p",13),r(34),t()()(),i(35,"div",14)(36,"h2",8),r(37,"Productos"),t(),_(38,Ye,3,0,"div",15)(39,et,2,0,"p",4),t()(),i(40,"div",16)(41,"a",17),r(42,"Volver a pedidos"),t(),i(43,"a",18),r(44,"Seguir comprando"),t()()),o&2){let e=n,s=v(2);a(3),f(e.orderNumber||e.id),a(2),f(s.statusLabel(e.status)),a(2),f(W(8,19,e.createdAt,"dd/MM/yyyy HH:mm:ss")),a(4),f(U(12,22,e.total??0)),a(8),f(e.shippingAddress==null?null:e.shippingAddress.fullName),a(2),f(e.shippingAddress==null?null:e.shippingAddress.phone),a(2),M("",e.shippingAddress==null?null:e.shippingAddress.street,", ",e.shippingAddress==null?null:e.shippingAddress.city,", ",e.shippingAddress==null?null:e.shippingAddress.state," - ",e.shippingAddress==null?null:e.shippingAddress.country),a(5),f(e.billingProfile==null?null:e.billingProfile.legalName),a(2),B("RUC: ",e.billingProfile==null?null:e.billingProfile.taxId),a(2),w("",e.billingProfile==null?null:e.billingProfile.email," \xB7 ",e.billingProfile==null?null:e.billingProfile.phone),a(2),M("",e.billingProfile==null?null:e.billingProfile.addressLine1,", ",e.billingProfile==null?null:e.billingProfile.city,", ",e.billingProfile==null?null:e.billingProfile.state," - ",e.billingProfile==null?null:e.billingProfile.country),a(4),C(e.items!=null&&e.items.length?38:39)}}function it(o,n){o&1&&(i(0,"p"),r(1,"No se encontr\xF3 el pedido."),t())}function nt(o,n){if(o&1&&(i(0,"section",2),_(1,tt,45,24)(2,it,2,0,"p"),t()),o&2){let e,s=v();a(),C((e=s.order())?1:2,e)}}function rt(o,n){o&1&&(i(0,"p"),r(1,"Cargando pedido..."),t())}var ce=class o{accountService=p(h);route=p(he);order=g(null);loading=g(!0);statusMap={pending:"Pendiente",paid:"Pagado",shipped:"Enviado",delivered:"Entregado",cancelled:"Cancelado",refunded:"Reembolsado"};ngOnInit(){let n=this.route.snapshot.params.id;n&&this.loadOrder(n)}loadOrder(n){this.loading.set(!0),this.accountService.getOrder(n).subscribe({next:e=>this.order.set(e),error:()=>this.order.set(null),complete:()=>this.loading.set(!1)})}statusLabel(n){if(!n)return"Pendiente";let e=n.toLowerCase();return this.statusMap[e]??n}itemCount(n){return n?.reduce((e,s)=>e+(s.quantity??0),0)??0}itemSubtotal(n){let e=n.quantity??0,s=n.unitPrice??n.price??0;return e*s}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-user-order-detail"]],decls:3,vars:2,consts:[["loadingTpl",""],["class","space-y-4",4,"ngIf","ngIfElse"],[1,"space-y-4"],[1,"flex","items-center","justify-between","gap-3"],[1,"text-sm","text-base-content/70"],[1,"text-2xl","font-bold"],[1,"text-xs","text-base-content/70"],[1,"text-right"],[1,"text-lg","font-semibold"],[1,"grid","gap-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"p-4","border","border-base-300","rounded-xl","bg-base-100","space-y-1"],[1,"font-semibold"],[1,"text-sm","text-base-content/80"],[1,"p-4","border","border-base-300","rounded-xl","bg-base-100","space-y-3"],[1,"space-y-3"],[1,"pt-2","flex","gap-2"],["routerLink","/user/orders",1,"btn","btn-outline","btn-sm"],["routerLink","/products",1,"btn","btn-primary","btn-sm"],[1,"relative","flex","bg-base-100","shadow-sm","rounded-lg","border","border-base-200","overflow-hidden"],[1,"w-40","md:w-48","shrink-0","block",3,"routerLink"],[1,"w-full","h-28","md:h-32","object-cover",3,"src","alt"],[1,"flex-1","p-3","flex","flex-col","gap-2"],[1,"flex","items-start","gap-3"],[1,"flex-1"],[1,"font-semibold","text-base","leading-tight","line-clamp-2","no-underline",3,"routerLink"],[1,"text-sm","text-base-content/70","line-clamp-2"],[1,"flex","items-end","justify-between","mt-auto"]],template:function(e,s){if(e&1&&pe(0,nt,3,1,"section",1)(1,rt,2,0,"ng-template",null,0,ve),e&2){let u=ge(2);l("ngIf",!s.loading())("ngIfElse",u)}},dependencies:[x,xe,E,X,te,Se],styles:["[_nghost-%COMP%]{display:block}"]})};var ot=[{path:"",component:ie,children:[{path:"profile",component:le},{path:"directions/new",component:oe},{path:"directions",component:re},{path:"billing/new",component:ae},{path:"billing",component:ne},{path:"orders",component:de},{path:"orders/:id",component:ce},{path:"**",redirectTo:"profile"}]}],hi=ot;export{hi as default,ot as userRoutes};
