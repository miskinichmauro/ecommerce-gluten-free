import{o as A}from"./chunk-VMC7GUZQ.js";import{$,C as y,Fa as oe,H as W,Ha as se,Ia as P,J as h,M as l,P as J,Qa as x,Va as ae,W as Q,Xa as T,Y,Ya as U,Z,_ as ee,aa as j,ab as u,ba as E,bb as ce,ca as f,cb as pe,da as g,ea as G,fa as I,g as c,ga as _,h as z,ha as te,i as X,ia as D,ka as M,la as ie,ma as v,n as p,p as o,s as m,sa as F,ta as C,v as n,va as N,w,x as R,y as K,ya as re,za as ne}from"./chunk-TGY6NUM4.js";var me=class i{static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["app-logo"]],decls:5,vars:0,consts:[["id","logo"],["routerLink","/",1,"text-lg","md:text-2xl","font-bold"],[1,"text-amber-500"]],template:function(t,r){t&1&&(f(0,"div",0)(1,"a",1),C(2," Gluten "),f(3,"span",2),C(4," Free"),g()()())},dependencies:[U],styles:["[_nghost-%COMP%]{display:block}"]})};function be(i,e){if(i&1){let t=D();I(0,"a",2),ie("click",function(){w(t);let s=v().$implicit,a=v();return R(a.handleOnClick(s.routerLink))}),C(1),_()}if(i&2){let t=v().$implicit;h(),N(" ",t.label," ")}}function ye(i,e){if(i&1&&Q(0,be,2,1,"a",1),i&2){let t=e.$implicit,r=v();Y(!t.adminOnly||r.authService.isAdmin()?0:-1)}}var B=class i{menuItems=P.required();authService=n(pe);configurationService=n(A);router=n(T);handleOnClick(e){this.configurationService.toggleSidebarItemsStatus("closed"),this.configurationService.toggleSidebarPageStatus("closed"),typeof e=="string"?this.router.navigateByUrl(e):this.router.navigate([e])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["menu-items"]],inputs:{menuItems:[1,"menuItems"]},decls:3,vars:0,consts:[[1,"flex","flex-col","gap-2","px-4"],[1,"p-2","cursor-pointer","rounded-md","hover:bg-gray-800","transition"],[1,"p-2","cursor-pointer","rounded-md","hover:bg-gray-800","transition",3,"click"]],template:function(t,r){t&1&&(I(0,"nav",0),$(1,ye,1,1,null,null,Z),_()),t&2&&(h(),j(r.menuItems()))},styles:["[_nghost-%COMP%]{display:block}"]})};var V=class i{static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["x-circle"]],decls:3,vars:0,consts:[[1,"x-circle-btn","cursor-pointer","inline-flex","items-center","justify-center","p-2","rounded-full","transition-colors","duration-200","hover:bg-base-200","text-base-content"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"]],template:function(t,r){t&1&&(I(0,"div",0),K(),I(1,"svg",1),te(2,"path",2),_()())},styles:["[_nghost-%COMP%]{display:inline-flex}"]})};var le=class i{menuItems=P.required();configurationService=n(A);isOpen(){return this.configurationService.sidebarItemsStatus()==="open"}close(){this.configurationService.toggleSidebarItemsStatus("closed")}handleEscape(e){e.key==="Escape"&&this.isOpen()&&this.close()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["sidebar-items"]],hostBindings:function(t,r){t&1&&M("keydown",function(a){return r.handleEscape(a)},W)},inputs:{menuItems:[1,"menuItems"]},decls:5,vars:3,consts:[[1,"fixed","inset-0","bg-base-100","z-50","transform","transition-transform","duration-500","flex","flex-col","-translate-x-full"],[1,"flex","justify-end"],[1,"btn","btn-ghost",3,"click"],[3,"menuItems"]],template:function(t,r){t&1&&(f(0,"div",0)(1,"div",1)(2,"button",2),M("click",function(){return r.configurationService.toggleSidebarItemsStatus("closed")}),G(3,"x-circle"),g()(),G(4,"menu-items",3),g()),t&2&&(F("translate-x-0",r.isOpen()),h(4),E("menuItems",r.menuItems()))},dependencies:[B,V],styles:["[_nghost-%COMP%]{display:block}"]})};var b=class i{loading=y(!1);success=y(!1);activateLoading(){this.loading.set(!0),this.success.set(!1)}deactivateLoading(){this.loading.set(!1)}activateSuccess(){this.loading.set(!1),this.success.set(!0),setTimeout(()=>this.success.set(!1),800)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})};var k=`${u.baseUrl}/contacts`,Pe={id:"new",title:"",phone:"",email:""},ue=class i{http=n(x);contactsCache=new Map;toastService=n(b);getAll(){return this.contactsCache.size?c(Array.from(this.contactsCache.values())):this.http.get(k).pipe(o(e=>e.forEach(t=>this.contactsCache.set(t.id,t))))}getById(e){return e==="new"?c(Pe):this.contactsCache.has(e)?c(this.contactsCache.get(e)):this.http.get(`${k}/${e}`).pipe(o(t=>this.contactsCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(k,e).pipe(o(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${k}/${e}`,t).pipe(o(async r=>{this.insertOrUpdateCache(r),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${k}/${e}`).pipe(o(async()=>{this.contactsCache.delete(e),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.contactsCache.set(e.id,e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})};var de=class i{activateRoute=n(ae);router=n(T);currentPage=ce(this.activateRoute.queryParamMap.pipe(X(e=>e.get("page")?+e.get("page"):1),X(e=>isNaN(e)?1:e)),{initialValue:1});setCurrentPage(e){this.router.navigate([],{queryParams:{page:e},queryParamsHandling:"merge"})}resetPage(){this.router.navigate([],{queryParams:{page:null},queryParamsHandling:"merge"})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})};var O=`${u.baseUrl}/products`,Se={id:"new",title:"",price:0,unitOfMeasure:"",description:"",slug:"",stock:0,tags:[],deleteAt:null,images:[],imageIds:[],user:{}},H=class i{constructor(){}http=n(x);productsCache=new Map;productCache=new Map;toastService=n(b);getProducts(e={}){let t=u.cantProducts,{limit:r=t,offset:s=0,isFeatured:a=!1}=e,S=a?"isFeatured":`${r}-${s}`;return this.productsCache.has(S)?c(this.productsCache.get(S)):this.http.get(O,{params:{limit:r,offset:s,isFeatured:a},responseType:"json"}).pipe(o(Ce=>this.productsCache.set(S,Ce)))}searchProducts(e={}){let{query:t="",limit:r=u.cantProducts,offset:s=0}=e;return this.http.get(`${O}/search`,{params:{query:t,limit:r,offset:s},responseType:"json"})}getProductByIdSlug(e){return e==="new"?c(Se):this.productCache.has(e)?c(this.productCache.get(e)):this.http.get(`${O}/${e}`,{responseType:"json"}).pipe(o(r=>this.productCache.set(e,r)))}createProduct(e){return this.toastService.activateLoading(),this.http.post(`${O}`,e).pipe(o(t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}updateProduct(e,t){return this.toastService.activateLoading(),this.http.patch(`${O}/${e}`,t).pipe(o(r=>{this.insertOrUpdateCache(r),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.productCache.get(e.id)?(this.productCache.set(e.id,e),this.productsCache.forEach(r=>{r.products=r.products.map(s=>s.id===e.id?e:s)})):(this.productCache.set(e.id,e),this.productsCache.clear())}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})};function xt(){let i=n(H),e=y(null),t=y(!0),r=y(null);async function s(a){t.set(!0),r.set(null);try{let S=a.query?await z(i.searchProducts(a)):await z(i.getProducts(a));e.set(S)}catch{r.set("Error al cargar los productos")}finally{t.set(!1)}}return{productResponse:e,loading:t,error:r,loadProducts:s}}var Ie=()=>[],xe=i=>({page:i});function _e(i,e){if(i&1){let t=D();f(0,"button",3),M("click",function(){let s=w(t).$implicit,a=v();return R(a.activePage.set(s))}),C(1),g()}if(i&2){let t=e.$implicit,r=v();F("btn-primary",t===r.activePage()),E("routerLink",re(5,Ie))("queryParams",ne(6,xe,t)),h(),N(" ",t," ")}}function Me(i,e){i&1&&(f(0,"button",2),C(1,"0"),g())}var fe=class i{pages=P(0);currentPage=P(1);activePage=se(this.currentPage);getPagesList=oe(()=>Array.from({length:this.pages()},(e,t)=>t+1));static \u0275fac=function(t){return new(t||i)};static \u0275cmp=l({type:i,selectors:[["pagination"]],inputs:{pages:[1,"pages"],currentPage:[1,"currentPage"]},decls:4,vars:1,consts:[[1,"join","flex","justify-center","items-center"],[1,"join-item","btn",3,"btn-primary","routerLink","queryParams"],[1,"join-item","btn"],[1,"join-item","btn",3,"click","routerLink","queryParams"]],template:function(t,r){t&1&&(f(0,"div",0),$(1,_e,2,8,"button",1,ee,!1,Me,2,0,"button",2),g()),t&2&&(h(),j(r.getPagesList()))},dependencies:[U],styles:["[_nghost-%COMP%]{display:block}"]})};var L=`${u.baseUrl}/recipes`,ke={id:"new",title:"",text:""},ge=class i{http=n(x);recipesCache=new Map;toastService=n(b);getAll(){return this.recipesCache.size?c(Array.from(this.recipesCache.values())):this.http.get(L).pipe(o(e=>e.forEach(t=>this.recipesCache.set(t.id,t))))}getById(e){return e==="new"?c(ke):this.recipesCache.has(e)?c(this.recipesCache.get(e)):this.http.get(`${L}/${e}`).pipe(o(t=>this.recipesCache.set(e,t)))}create(e){return this.toastService.activateLoading(),this.http.post(L,e).pipe(o(async t=>{this.insertOrUpdateCache(t),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}update(e,t){return this.toastService.activateLoading(),this.http.patch(`${L}/${e}`,t).pipe(o(r=>{this.insertOrUpdateCache(r),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}delete(e){return this.toastService.activateLoading(),this.http.delete(`${L}/${e}`).pipe(o(async()=>{this.recipesCache.delete(e),this.toastService.activateSuccess()}),p(()=>this.toastService.deactivateLoading()))}insertOrUpdateCache(e){this.recipesCache.set(e.id,e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"})};var Oe=u.baseUrl,he="assets/images/default-image.jpg",ve=class i{transform(e){if(!e||Array.isArray(e)&&e.length===0)return he;let t=Array.isArray(e)?e[0]:e,r=this.resolveImageValue(t);return r?r.startsWith("assets/")||/^https?:\/\//.test(r)?r:`${Oe}/files/product/${r}`:he}resolveImageValue(e){return e?typeof e=="string"?e:e.secureUrl||e.url||e.path||e.fileName||e.filename||e.name||e.id||null:null}static \u0275fac=function(t){return new(t||i)};static \u0275pipe=J({name:"productImage",type:i,pure:!0})};export{me as a,B as b,V as c,le as d,b as e,ue as f,de as g,H as h,ve as i,xt as j,fe as k,ge as l};
