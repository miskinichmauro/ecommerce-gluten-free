import{$ as j,A as $,Aa as l,D as b,Ea as K,G as F,Ga as G,Ha as J,La as c,Ma as Q,N as k,O as E,P as _,Q as N,R as P,S as v,U as x,V as D,W as L,X as T,Z as A,e as o,ea as q,f as I,g as R,ga as h,i,ia as S,ka as V,l as p,la as B,o as s,p as M,q as U,ra as H,ta as z,u as C,ua as w}from"./chunk-LRPCWCEJ.js";var W=class r{activateRoute=s(K);router=s(G);currentPage=Q(this.activateRoute.queryParamMap.pipe(R(e=>e.get("page")?+e.get("page"):1),R(e=>isNaN(e)?1:e)),{initialValue:1});setPage(e){this.router.navigate([],{queryParams:{page:e},queryParamsHandling:"merge"})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})};var y=`${c.baseUrl}/products`,ie={id:"new",title:"",price:0,unitOfMeasure:"",description:"",slug:"",stock:0,tags:[""],deleteAt:null,imagesName:[""],user:{}},O=class r{constructor(){}http=s(l);productsCache=new Map;productCache=new Map;getProducts(e={}){let t=c.cantProducts,{limit:n=t,offset:a=0,isFeatured:m=!1}=e,u=m?"isFeatured":`${n}-${a}`;return this.productsCache.has(u)?o(this.productsCache.get(u)):this.http.get(y,{params:{limit:n,offset:a,isFeatured:m},responseType:"json"}).pipe(i(ne=>this.productsCache.set(u,ne)))}getProductByIdSlug(e){return e==="new"?o(ie):this.productCache.has(e)?o(this.productCache.get(e)):this.http.get(`${y}/${e}`,{responseType:"json"}).pipe(i(n=>this.productCache.set(e,n)))}createProduct(e){return this.http.post(`${y}`,e).pipe(i(n=>this.insertOrUpdateCache(n)))}updateProduct(e,t){return this.http.patch(`${y}/${e}`,t).pipe(i(a=>this.insertOrUpdateCache(a)))}insertOrUpdateCache(e){this.productCache.get(e.id)?(this.productCache.set(e.id,e),this.productsCache.forEach(n=>{n.products=n.products.map(a=>a.id===e.id?e:a)})):(this.productCache.set(e.id,e),this.productsCache.clear())}static \u0275fac=function(t){return new(t||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})};function Ue(){let r=s(O),e=C(null),t=C(!0),n=C(null);async function a(m){t.set(!0),n.set(null);try{let u=await I(r.getProducts(m));e.set(u)}catch{n.set("Error al cargar los productos")}finally{t.set(!1)}}return{productResponse:e,loading:t,error:n,loadProducts:a}}var ae=()=>[],se=r=>({page:r});function ce(r,e){if(r&1){let t=T();P(0,"button",3),A("click",function(){let a=M(t).$implicit,m=j();return U(m.activePage.set(a))}),h(1),v()}if(r&2){let t=e.$implicit,n=j();q("btn-primary",t===n.activePage()),N("routerLink",V(5,ae))("queryParams",B(6,se,t)),$(),S(" ",t," ")}}function pe(r,e){r&1&&(P(0,"button",2),h(1,"0"),v())}var X=class r{pages=w(0);currentPage=w(1);activePage=z(this.currentPage);getPagesList=H(()=>Array.from({length:this.pages()},(e,t)=>t+1));static \u0275fac=function(t){return new(t||r)};static \u0275cmp=b({type:r,selectors:[["pagination"]],inputs:{pages:[1,"pages"],currentPage:[1,"currentPage"]},decls:4,vars:1,consts:[[1,"join","flex","justify-center","items-center"],[1,"join-item","btn",3,"btn-primary","routerLink","queryParams"],[1,"join-item","btn"],[1,"join-item","btn",3,"click","routerLink","queryParams"]],template:function(t,n){t&1&&(P(0,"div",0),E(1,ce,2,8,"button",1,k,!1,pe,2,0,"button",2),v()),t&2&&($(),_(n.getPagesList()))},dependencies:[J],styles:["[_nghost-%COMP%]{display:block}"]})};var Y=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=b({type:r,selectors:[["loading"]],decls:4,vars:0,consts:[[1,"flex","flex-col","justify-center","items-center","min-h-[50vh]","gap-4"],[1,"loading","loading-spinner","loading-lg"]],template:function(t,n){t&1&&(x(0,"div",0),L(1,"span",1),x(2,"p"),h(3," Cargando... "),D()())},styles:["[_nghost-%COMP%]{display:block}"]})};var f=`${c.baseUrl}/recipes`,me={id:"new",title:"",text:""},Z=class r{http=s(l);recipesCache=new Map;getAll(){return this.recipesCache.size?o(Array.from(this.recipesCache.values())):this.http.get(f).pipe(i(e=>e.forEach(t=>this.recipesCache.set(t.id,t))))}getById(e){return e==="new"?o(me):this.recipesCache.has(e)?o(this.recipesCache.get(e)):this.http.get(`${f}/${e}`).pipe(i(t=>this.recipesCache.set(e,t)))}create(e){return this.http.post(f,e).pipe(i(t=>this.insertOrUpdateCache(t)))}update(e,t){return this.http.patch(`${f}/${e}`,t).pipe(i(n=>this.insertOrUpdateCache(n)))}delete(e){return this.http.delete(`${f}/${e}`).pipe(i(()=>this.recipesCache.delete(e)))}insertOrUpdateCache(e){this.recipesCache.set(e.id,e)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})};var g=`${c.baseUrl}/contacts`,ue={id:"new",title:"",phone:"",email:""},ee=class r{http=s(l);contactsCache=new Map;getAll(){return this.contactsCache.size?o(Array.from(this.contactsCache.values())):this.http.get(g).pipe(i(e=>e.forEach(t=>this.contactsCache.set(t.id,t))))}getById(e){return e==="new"?o(ue):this.contactsCache.has(e)?o(this.contactsCache.get(e)):this.http.get(`${g}/${e}`).pipe(i(t=>this.contactsCache.set(e,t)))}create(e){return this.http.post(g,e).pipe(i(t=>this.insertOrUpdateCache(t)))}update(e,t){return this.http.patch(`${g}/${e}`,t).pipe(i(n=>this.insertOrUpdateCache(n)))}delete(e){return this.http.delete(`${g}/${e}`).pipe(i(()=>this.contactsCache.delete(e)))}insertOrUpdateCache(e){this.contactsCache.set(e.id,e)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})};var te=c.baseUrl,re=class r{transform(e){if(typeof e=="string")return`${te}/files/product/${e}`;let t=e[0];return t?`${te}/files/product/${t}`:(console.log("Mostrando por defecto"),"assets/images/default-image.jpg")}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=F({name:"productImage",type:r,pure:!0})};export{re as a,W as b,O as c,Ue as d,X as e,Y as f,Z as g,ee as h};
